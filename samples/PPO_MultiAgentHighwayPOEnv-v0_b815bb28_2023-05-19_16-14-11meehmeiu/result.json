{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19968, "num_steps_sampled": 4000, "sample_time_ms": 21198.689, "load_time_ms": 73.998, "grad_time_ms": 3259.255, "update_time_ms": 667.398, "learner": {"avProbe": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 59949076.0, "policy_loss": -0.0008264470379799604, "vf_loss": 59949076.0, "vf_explained_var": 1.8128217561752535e-05, "kl": 0.000565165129955858, "entropy": 1.4173308610916138, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 4000, "episodes_total": 0, "training_iteration": 1, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-14-47", "timestamp": 1684527287, "time_this_iter_s": 25.29116725921631, "time_total_s": 25.29116725921631, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25.29116725921631, "timesteps_since_restore": 4000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.964864864864865, "ram_util_percent": 18.93513513513514}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39936, "num_steps_sampled": 8000, "sample_time_ms": 23781.906, "load_time_ms": 41.244, "grad_time_ms": 3213.534, "update_time_ms": 338.24, "learner": {"avProbe": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 145764384.0, "policy_loss": -0.00022389586956705898, "vf_loss": 145764384.0, "vf_explained_var": 2.0283536287024617e-05, "kl": 1.8707156414166093e-05, "entropy": 1.4156922101974487, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 8000, "episodes_total": 0, "training_iteration": 2, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-15-17", "timestamp": 1684527317, "time_this_iter_s": 29.579331159591675, "time_total_s": 54.87049841880798, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7598>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 54.87049841880798, "timesteps_since_restore": 8000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.74761904761905, "ram_util_percent": 19.180952380952384}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59904, "num_steps_sampled": 12000, "sample_time_ms": 28292.481, "load_time_ms": 29.948, "grad_time_ms": 3126.862, "update_time_ms": 228.937, "learner": {"avProbe": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 398592832.0, "policy_loss": -0.0003426892508286983, "vf_loss": 398592832.0, "vf_explained_var": -4.715644536190666e-06, "kl": 0.00023199222050607204, "entropy": 1.4023187160491943, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 12000, "episodes_total": 0, "training_iteration": 3, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-15-57", "timestamp": 1684527357, "time_this_iter_s": 40.31339693069458, "time_total_s": 95.18389534950256, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 95.18389534950256, "timesteps_since_restore": 12000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.30689655172414, "ram_util_percent": 19.412068965517243}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79616, "num_steps_sampled": 16000, "sample_time_ms": 32675.819, "load_time_ms": 24.588, "grad_time_ms": 3065.579, "update_time_ms": 173.825, "learner": {"avProbe": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 305170048.0, "policy_loss": -4.6713787014596164e-05, "vf_loss": 305170048.0, "vf_explained_var": 1.4465350432146806e-05, "kl": 4.099452326045139e-06, "entropy": 1.3971607685089111, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 16000, "episodes_total": 0, "training_iteration": 4, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-16-46", "timestamp": 1684527406, "time_this_iter_s": 48.748021841049194, "time_total_s": 143.93191719055176, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 143.93191719055176, "timesteps_since_restore": 16000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.34202898550724, "ram_util_percent": 19.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1108502.411477957, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1590631.0813494048, "episode_len_mean": 1000.0, "episodes_this_iter": 20, "policy_reward_min": {"avProbe": -879425.3226441088}, "policy_reward_max": {"avProbe": -92475.77169946973}, "policy_reward_mean": {"avProbe": -318126.2162698811}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 171.33259437420034, "mean_processing_ms": 4.638877936771937, "mean_inference_ms": 1.1689210509682273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 96128, "num_steps_sampled": 20000, "sample_time_ms": 37380.335, "load_time_ms": 20.729, "grad_time_ms": 2938.331, "update_time_ms": 140.167, "learner": {"avProbe": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 172318496.0, "policy_loss": -2.3552902348455973e-05, "vf_loss": 172318496.0, "vf_explained_var": 1.246984629688086e-05, "kl": 9.519122977508232e-05, "entropy": 1.4041637182235718, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 20000, "episodes_total": 20, "training_iteration": 5, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-17-44", "timestamp": 1684527464, "time_this_iter_s": 58.66744112968445, "time_total_s": 202.5993583202362, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 202.5993583202362, "timesteps_since_restore": 20000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.680952380952384, "ram_util_percent": 19.463095238095246}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1108502.411477957, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1590631.0813494048, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -879425.3226441088}, "policy_reward_max": {"avProbe": -92475.77169946973}, "policy_reward_mean": {"avProbe": -318126.2162698811}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 171.33259437420034, "mean_processing_ms": 4.638877936771937, "mean_inference_ms": 1.1689210509682273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 116096, "num_steps_sampled": 24000, "sample_time_ms": 33509.718, "load_time_ms": 18.486, "grad_time_ms": 2966.799, "update_time_ms": 117.684, "learner": {"avProbe": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 66331492.0, "policy_loss": -0.0013973034219816327, "vf_loss": 66331492.0, "vf_explained_var": 0.0001598420785740018, "kl": 0.0013930908171460032, "entropy": 1.399674415588379, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 24000, "episodes_total": 20, "training_iteration": 6, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-18-02", "timestamp": 1684527482, "time_this_iter_s": 17.30397915840149, "time_total_s": 219.9033374786377, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 219.9033374786377, "timesteps_since_restore": 24000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.38, "ram_util_percent": 19.516}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1108502.411477957, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1590631.0813494048, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -879425.3226441088}, "policy_reward_max": {"avProbe": -92475.77169946973}, "policy_reward_mean": {"avProbe": -318126.2162698811}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 171.33259437420034, "mean_processing_ms": 4.638877936771937, "mean_inference_ms": 1.1689210509682273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 136064, "num_steps_sampled": 28000, "sample_time_ms": 32466.475, "load_time_ms": 17.094, "grad_time_ms": 3030.504, "update_time_ms": 102.148, "learner": {"avProbe": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 199418656.0, "policy_loss": 7.759416621411219e-05, "vf_loss": 199418656.0, "vf_explained_var": 7.719374843873084e-05, "kl": 2.9245456971693784e-05, "entropy": 1.3969073295593262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 28000, "episodes_total": 20, "training_iteration": 7, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-18-31", "timestamp": 1684527511, "time_this_iter_s": 29.662055492401123, "time_total_s": 249.56539297103882, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 249.56539297103882, "timesteps_since_restore": 28000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.030952380952385, "ram_util_percent": 19.602380952380955}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1108502.411477957, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1590631.0813494048, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -879425.3226441088}, "policy_reward_max": {"avProbe": -92475.77169946973}, "policy_reward_mean": {"avProbe": -318126.2162698811}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 171.33259437420034, "mean_processing_ms": 4.638877936771937, "mean_inference_ms": 1.1689210509682273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 156032, "num_steps_sampled": 32000, "sample_time_ms": 32949.013, "load_time_ms": 15.858, "grad_time_ms": 3035.986, "update_time_ms": 90.109, "learner": {"avProbe": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 376229408.0, "policy_loss": -0.0003052942338399589, "vf_loss": 376229408.0, "vf_explained_var": -3.406634732527891e-06, "kl": 0.000969584914855659, "entropy": 1.3675720691680908, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 32000, "episodes_total": 20, "training_iteration": 8, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-19-11", "timestamp": 1684527551, "time_this_iter_s": 39.43863010406494, "time_total_s": 289.00402307510376, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7598>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 289.00402307510376, "timesteps_since_restore": 32000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.62321428571429, "ram_util_percent": 16.998214285714283}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1108502.411477957, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1590631.0813494048, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -879425.3226441088}, "policy_reward_max": {"avProbe": -92475.77169946973}, "policy_reward_mean": {"avProbe": -318126.2162698811}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 171.33259437420034, "mean_processing_ms": 4.638877936771937, "mean_inference_ms": 1.1689210509682273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 174976, "num_steps_sampled": 36000, "sample_time_ms": 34326.731, "load_time_ms": 14.803, "grad_time_ms": 3011.828, "update_time_ms": 80.818, "learner": {"avProbe": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 351085376.0, "policy_loss": 0.0001615202781977132, "vf_loss": 351085376.0, "vf_explained_var": 3.8006015529390424e-05, "kl": 8.846710261423141e-05, "entropy": 1.3669192790985107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 36000, "episodes_total": 20, "training_iteration": 9, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-19-59", "timestamp": 1684527599, "time_this_iter_s": 48.21398997306824, "time_total_s": 337.218013048172, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 337.218013048172, "timesteps_since_restore": 36000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.35217391304347, "ram_util_percent": 16.568115942028978}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1087719.132888852, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1533905.8547788835, "episode_len_mean": 1000.0, "episodes_this_iter": 20, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19681.60715164653}, "policy_reward_mean": {"avProbe": -306781.17095577676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 170.1096454907087, "mean_processing_ms": 4.648596643252607, "mean_inference_ms": 1.1345255702427326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 185728, "num_steps_sampled": 40000, "sample_time_ms": 36410.07, "load_time_ms": 13.926, "grad_time_ms": 2889.461, "update_time_ms": 73.631, "learner": {"avProbe": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 105337128.0, "policy_loss": -0.0015661035431548953, "vf_loss": 105337128.0, "vf_explained_var": 5.7410627050558105e-05, "kl": 0.0006429512868635356, "entropy": 1.345410704612732, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 40000, "episodes_total": 40, "training_iteration": 10, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-20-56", "timestamp": 1684527656, "time_this_iter_s": 56.99100875854492, "time_total_s": 394.2090218067169, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 394.2090218067169, "timesteps_since_restore": 40000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.07901234567901, "ram_util_percent": 16.65555555555556}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -1087719.132888852, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1533905.8547788835, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19681.60715164653}, "policy_reward_mean": {"avProbe": -306781.1709557768}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 170.10964549070866, "mean_processing_ms": 4.648596643252607, "mean_inference_ms": 1.1345255702427326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 205696, "num_steps_sampled": 44000, "sample_time_ms": 35728.935, "load_time_ms": 7.442, "grad_time_ms": 2866.125, "update_time_ms": 7.603, "learner": {"avProbe": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 44025900.0, "policy_loss": -0.001952950726263225, "vf_loss": 44025900.0, "vf_explained_var": 0.0005358060006983578, "kl": 0.0029932528268545866, "entropy": 1.325524091720581, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 44000, "episodes_total": 40, "training_iteration": 11, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-21-14", "timestamp": 1684527674, "time_this_iter_s": 17.45500159263611, "time_total_s": 411.664023399353, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 411.664023399353, "timesteps_since_restore": 44000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.328, "ram_util_percent": 16.808}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -602794.2752686357, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1511195.8162542433, "episode_len_mean": 984.9512195121952, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19681.60715164653}, "policy_reward_mean": {"avProbe": -302239.1632508487}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 169.8160569400407, "mean_processing_ms": 4.673487525918622, "mean_inference_ms": 1.135005362475647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 225664, "num_steps_sampled": 48000, "sample_time_ms": 35910.135, "load_time_ms": 7.465, "grad_time_ms": 2866.412, "update_time_ms": 7.328, "learner": {"avProbe": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 162945440.0, "policy_loss": -0.0007794040720909834, "vf_loss": 162945440.0, "vf_explained_var": 0.00012920300650876015, "kl": 0.0005802774103358388, "entropy": 1.3447219133377075, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 48000, "episodes_total": 41, "training_iteration": 12, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-21-45", "timestamp": 1684527705, "time_this_iter_s": 31.393844604492188, "time_total_s": 443.0578680038452, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 443.0578680038452, "timesteps_since_restore": 48000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.94444444444444, "ram_util_percent": 16.891111111111105}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -602794.2752686357, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1511195.8162542435, "episode_len_mean": 984.9512195121952, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19681.60715164653}, "policy_reward_mean": {"avProbe": -302239.1632508487}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 169.81605694004068, "mean_processing_ms": 4.673487525918622, "mean_inference_ms": 1.135005362475647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 245632, "num_steps_sampled": 52000, "sample_time_ms": 35934.1, "load_time_ms": 7.311, "grad_time_ms": 2874.471, "update_time_ms": 7.224, "learner": {"avProbe": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 285715424.0, "policy_loss": -0.000596705183852464, "vf_loss": 285715424.0, "vf_explained_var": 3.0023929866729304e-05, "kl": 0.0005374156171455979, "entropy": 1.3624576330184937, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 52000, "episodes_total": 41, "training_iteration": 13, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-22-26", "timestamp": 1684527746, "time_this_iter_s": 40.632858991622925, "time_total_s": 483.69072699546814, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 483.69072699546814, "timesteps_since_restore": 52000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.63620689655172, "ram_util_percent": 16.900000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -602794.2752686357, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1511195.8162542435, "episode_len_mean": 984.9512195121952, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19681.60715164653}, "policy_reward_mean": {"avProbe": -302239.1632508487}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 169.81605694004068, "mean_processing_ms": 4.673487525918622, "mean_inference_ms": 1.135005362475647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 260864, "num_steps_sampled": 56000, "sample_time_ms": 35964.619, "load_time_ms": 6.978, "grad_time_ms": 2842.206, "update_time_ms": 6.89, "learner": {"avProbe": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 121353632.0, "policy_loss": 0.00010706869215937331, "vf_loss": 121353632.0, "vf_explained_var": 0.00010133440810022876, "kl": 4.729802822112106e-05, "entropy": 1.365728497505188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 56000, "episodes_total": 41, "training_iteration": 14, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-23-14", "timestamp": 1684527794, "time_this_iter_s": 48.73095202445984, "time_total_s": 532.421679019928, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7598>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 532.421679019928, "timesteps_since_restore": 56000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.83, "ram_util_percent": 17.05857142857143}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -552466.3482263021, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1362434.9557858915, "episode_len_mean": 989.7166666666667, "episodes_this_iter": 19, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.050603137857}, "policy_reward_mean": {"avProbe": -272486.99115717836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 169.2418918628665, "mean_processing_ms": 4.6646529261992695, "mean_inference_ms": 1.0987647270162813}, "off_policy_estimator": {}, "info": {"num_steps_trained": 262784, "num_steps_sampled": 60006, "sample_time_ms": 35681.651, "load_time_ms": 6.679, "grad_time_ms": 2628.319, "update_time_ms": 7.209, "learner": {"avProbe": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 69653720.0, "policy_loss": 0.006835632491856813, "vf_loss": 69653720.0, "vf_explained_var": 0.00012883344606962055, "kl": 1.224012430611765e-05, "entropy": 1.3674780130386353, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4006, "done": false, "timesteps_total": 60006, "episodes_total": 60, "training_iteration": 15, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-24-08", "timestamp": 1684527848, "time_this_iter_s": 53.70000720024109, "time_total_s": 586.1216862201691, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 586.1216862201691, "timesteps_since_restore": 60006, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.84605263157894, "ram_util_percent": 17.00263157894737}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -552466.3482263021, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1362434.9557858917, "episode_len_mean": 989.7166666666667, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.050603137857}, "policy_reward_mean": {"avProbe": -272486.99115717836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 169.24189186286648, "mean_processing_ms": 4.664652926199269, "mean_inference_ms": 1.098764727016281}, "off_policy_estimator": {}, "info": {"num_steps_trained": 282368, "num_steps_sampled": 64006, "sample_time_ms": 38358.481, "load_time_ms": 6.498, "grad_time_ms": 2619.437, "update_time_ms": 7.622, "learner": {"avProbe": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 52988196.0, "policy_loss": -0.0011284527136012912, "vf_loss": 52988200.0, "vf_explained_var": 0.0006196798640303314, "kl": 0.0011021662503480911, "entropy": 1.3563705682754517, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 64006, "episodes_total": 60, "training_iteration": 16, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-24-52", "timestamp": 1684527892, "time_this_iter_s": 43.98534870147705, "time_total_s": 630.1070349216461, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 630.1070349216461, "timesteps_since_restore": 64006, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.893650793650792, "ram_util_percent": 16.946031746031753}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -552466.3482263021, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1351259.0320588453, "episode_len_mean": 989.8852459016393, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -270251.80641176907}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 169.06276029118916, "mean_processing_ms": 4.673253118185219, "mean_inference_ms": 1.098342711458161}, "off_policy_estimator": {}, "info": {"num_steps_trained": 301440, "num_steps_sampled": 68006, "sample_time_ms": 40177.238, "load_time_ms": 6.233, "grad_time_ms": 2572.966, "update_time_ms": 7.704, "learner": {"avProbe": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 190252896.0, "policy_loss": 5.408021479524905e-06, "vf_loss": 190252896.0, "vf_explained_var": 0.00013604499690700322, "kl": 3.968721648561768e-05, "entropy": 1.3594400882720947, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 68006, "episodes_total": 61, "training_iteration": 17, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-25-40", "timestamp": 1684527940, "time_this_iter_s": 47.386468172073364, "time_total_s": 677.4935030937195, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 677.4935030937195, "timesteps_since_restore": 68006, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.580882352941174, "ram_util_percent": 16.901470588235302}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1335404.5519660136, "episode_len_mean": 980.6290322580645, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -267080.9103932028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.8101613394307, "mean_processing_ms": 4.679018933824501, "mean_inference_ms": 1.0968525300156904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 321408, "num_steps_sampled": 72006, "sample_time_ms": 40222.932, "load_time_ms": 6.164, "grad_time_ms": 2590.349, "update_time_ms": 7.922, "learner": {"avProbe": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 245387504.0, "policy_loss": -0.0004936617333441973, "vf_loss": 245387504.0, "vf_explained_var": 3.730448224814609e-05, "kl": 4.341469320934266e-05, "entropy": 1.366077184677124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 72006, "episodes_total": 62, "training_iteration": 18, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-26-20", "timestamp": 1684527980, "time_this_iter_s": 40.0814106464386, "time_total_s": 717.5749137401581, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 717.5749137401581, "timesteps_since_restore": 72006, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.743859649122804, "ram_util_percent": 16.900000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1335404.5519660139, "episode_len_mean": 980.6290322580645, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -267080.9103932028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.8101613394307, "mean_processing_ms": 4.679018933824501, "mean_inference_ms": 1.0968525300156904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 336128, "num_steps_sampled": 76006, "sample_time_ms": 40166.462, "load_time_ms": 5.91, "grad_time_ms": 2550.747, "update_time_ms": 7.901, "learner": {"avProbe": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 145996784.0, "policy_loss": 0.00012873148079961538, "vf_loss": 145996784.0, "vf_explained_var": 8.332055585924536e-05, "kl": 0.0002958505356218666, "entropy": 1.3806408643722534, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 76006, "episodes_total": 62, "training_iteration": 19, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-27-07", "timestamp": 1684528027, "time_this_iter_s": 47.24751830101013, "time_total_s": 764.8224320411682, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 764.8224320411682, "timesteps_since_restore": 76006, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.03823529411765, "ram_util_percent": 16.957352941176477}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1270938.8027246546, "episode_len_mean": 984.9875, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -254187.760544931}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.36981095308494, "mean_processing_ms": 4.665532069104479, "mean_inference_ms": 1.0699777080528334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 338688, "num_steps_sampled": 80011, "sample_time_ms": 39884.083, "load_time_ms": 5.614, "grad_time_ms": 2412.987, "update_time_ms": 8.004, "learner": {"avProbe": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 170026336.0, "policy_loss": 0.001049474230967462, "vf_loss": 170026336.0, "vf_explained_var": 4.197657108306885e-05, "kl": 5.274803697830066e-05, "entropy": 1.390471339225769, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4005, "done": false, "timesteps_total": 80011, "episodes_total": 80, "training_iteration": 20, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-28-00", "timestamp": 1684528080, "time_this_iter_s": 52.777406454086304, "time_total_s": 817.5998384952545, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7598>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 817.5998384952545, "timesteps_since_restore": 80011, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.796, "ram_util_percent": 16.902666666666672}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1270938.8027246546, "episode_len_mean": 984.9875, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -254187.760544931}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.36981095308494, "mean_processing_ms": 4.665532069104479, "mean_inference_ms": 1.0699777080528334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 358016, "num_steps_sampled": 84011, "sample_time_ms": 42485.51, "load_time_ms": 5.618, "grad_time_ms": 2448.177, "update_time_ms": 7.788, "learner": {"avProbe": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 30457082.0, "policy_loss": -0.000990239786915481, "vf_loss": 30457082.0, "vf_explained_var": 0.0010939484927803278, "kl": 0.0008957665995694697, "entropy": 1.381786584854126, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 84011, "episodes_total": 80, "training_iteration": 21, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-28-44", "timestamp": 1684528124, "time_this_iter_s": 43.813591718673706, "time_total_s": 861.4134302139282, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff353d3dae8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 861.4134302139282, "timesteps_since_restore": 84011, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.633870967741938, "ram_util_percent": 16.900000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1268458.5789399496, "episode_len_mean": 985.1728395061729, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -253691.71578799005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.24108386309402, "mean_processing_ms": 4.669385928046162, "mean_inference_ms": 1.069257010432554}, "off_policy_estimator": {}, "info": {"num_steps_trained": 376064, "num_steps_sampled": 88011, "sample_time_ms": 44127.8, "load_time_ms": 5.429, "grad_time_ms": 2413.79, "update_time_ms": 8.049, "learner": {"avProbe": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 99704864.0, "policy_loss": -0.0002406055136816576, "vf_loss": 99704864.0, "vf_explained_var": 0.00015871194773353636, "kl": 0.0008119679987430573, "entropy": 1.3587898015975952, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 88011, "episodes_total": 81, "training_iteration": 22, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-29-31", "timestamp": 1684528171, "time_this_iter_s": 47.47602939605713, "time_total_s": 908.8894596099854, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 908.8894596099854, "timesteps_since_restore": 88011, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.516176470588235, "ram_util_percent": 16.900000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1260401.8503559427, "episode_len_mean": 985.3536585365854, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -252080.37007118855}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.07081647631858, "mean_processing_ms": 4.672428049900359, "mean_inference_ms": 1.0681000287011857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 395904, "num_steps_sampled": 92011, "sample_time_ms": 43962.795, "load_time_ms": 5.733, "grad_time_ms": 2438.166, "update_time_ms": 7.948, "learner": {"avProbe": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 159969120.0, "policy_loss": -0.0005936916568316519, "vf_loss": 159969120.0, "vf_explained_var": 3.0491813959088176e-05, "kl": 0.0014447823632508516, "entropy": 1.3243563175201416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 92011, "episodes_total": 82, "training_iteration": 23, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-30-10", "timestamp": 1684528210, "time_this_iter_s": 39.23057436943054, "time_total_s": 948.1200339794159, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 948.1200339794159, "timesteps_since_restore": 92011, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 38.17678571428571, "ram_util_percent": 16.900000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1260401.8503559425, "episode_len_mean": 985.3536585365854, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -252080.37007118855}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 168.0708164763186, "mean_processing_ms": 4.672428049900359, "mean_inference_ms": 1.0681000287011857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 409472, "num_steps_sampled": 96011, "sample_time_ms": 43850.081, "load_time_ms": 5.944, "grad_time_ms": 2400.67, "update_time_ms": 7.97, "learner": {"avProbe": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 61563476.0, "policy_loss": -0.0007946297409944236, "vf_loss": 61563476.0, "vf_explained_var": 8.384461398236454e-05, "kl": 6.317650695564225e-05, "entropy": 1.3194446563720703, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 96011, "episodes_total": 82, "training_iteration": 24, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-30-58", "timestamp": 1684528258, "time_this_iter_s": 47.22602295875549, "time_total_s": 995.3460569381714, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 995.3460569381714, "timesteps_since_restore": 96011, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 39.1970588235294, "ram_util_percent": 16.900000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1177848.1553315509, "episode_len_mean": 987.99, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -235569.63106631022}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 167.66400671839307, "mean_processing_ms": 4.660822478201497, "mean_inference_ms": 1.0457939163969072}, "off_policy_estimator": {}, "info": {"num_steps_trained": 412160, "num_steps_sampled": 100019, "sample_time_ms": 43726.816, "load_time_ms": 5.997, "grad_time_ms": 2415.084, "update_time_ms": 7.667, "learner": {"avProbe": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 116904792.0, "policy_loss": -0.0031262363772839308, "vf_loss": 116904792.0, "vf_explained_var": -1.1557624020497315e-05, "kl": 9.362171113025397e-05, "entropy": 1.3236911296844482, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4008, "done": false, "timesteps_total": 100019, "episodes_total": 100, "training_iteration": 25, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-31-50", "timestamp": 1684528310, "time_this_iter_s": 52.59995937347412, "time_total_s": 1047.9460163116455, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1047.9460163116455, "timesteps_since_restore": 100019, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 40.346666666666664, "ram_util_percent": 16.878666666666668}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1177848.1553315509, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -235569.63106631022}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 167.66400671839313, "mean_processing_ms": 4.660822478201497, "mean_inference_ms": 1.0457939163969072}, "off_policy_estimator": {}, "info": {"num_steps_trained": 431232, "num_steps_sampled": 104019, "sample_time_ms": 43650.554, "load_time_ms": 6.291, "grad_time_ms": 2443.88, "update_time_ms": 7.509, "learner": {"avProbe": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 30150552.0, "policy_loss": 0.0006868081400170922, "vf_loss": 30150552.0, "vf_explained_var": 0.0012896473053842783, "kl": 0.0007148252334445715, "entropy": 1.3069536685943604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 104019, "episodes_total": 100, "training_iteration": 26, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-32-34", "timestamp": 1684528354, "time_this_iter_s": 43.50997853279114, "time_total_s": 1091.4559948444366, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1091.4559948444366, "timesteps_since_restore": 104019, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.669354838709676, "ram_util_percent": 16.900000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1153074.407943845, "episode_len_mean": 987.99, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -230614.88158876906}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 167.409325283443, "mean_processing_ms": 4.666758230874205, "mean_inference_ms": 1.0424042792275343}, "off_policy_estimator": {}, "info": {"num_steps_trained": 449280, "num_steps_sampled": 108035, "sample_time_ms": 44204.304, "load_time_ms": 6.207, "grad_time_ms": 2468.207, "update_time_ms": 7.131, "learner": {"avProbe": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 107766488.0, "policy_loss": -0.00021434992959257215, "vf_loss": 107766488.0, "vf_explained_var": 8.290498954011127e-05, "kl": 0.0006998917669989169, "entropy": 1.284478783607483, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4016, "done": false, "timesteps_total": 108035, "episodes_total": 102, "training_iteration": 27, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-33-27", "timestamp": 1684528407, "time_this_iter_s": 53.159937620162964, "time_total_s": 1144.6159324645996, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1144.6159324645996, "timesteps_since_restore": 108035, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.59736842105263, "ram_util_percent": 16.900000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1153074.407943845, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -230614.8815887691}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 167.409325283443, "mean_processing_ms": 4.666758230874204, "mean_inference_ms": 1.0424042792275343}, "off_policy_estimator": {}, "info": {"num_steps_trained": 469248, "num_steps_sampled": 112035, "sample_time_ms": 44133.373, "load_time_ms": 6.492, "grad_time_ms": 2459.188, "update_time_ms": 7.225, "learner": {"avProbe": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 233023856.0, "policy_loss": -0.0006146511877886951, "vf_loss": 233023888.0, "vf_explained_var": 2.1830201148986816e-05, "kl": 0.000629316724371165, "entropy": 1.3043713569641113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 112035, "episodes_total": 102, "training_iteration": 28, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-34-06", "timestamp": 1684528446, "time_this_iter_s": 39.28319263458252, "time_total_s": 1183.8991250991821, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1183.8991250991821, "timesteps_since_restore": 112035, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 37.978571428571435, "ram_util_percent": 16.900000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -2185251.7481666417, "episode_reward_mean": -1153074.407943845, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19682.596294885443}, "policy_reward_mean": {"avProbe": -230614.8815887691}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 167.409325283443, "mean_processing_ms": 4.666758230874204, "mean_inference_ms": 1.0424042792275343}, "off_policy_estimator": {}, "info": {"num_steps_trained": 481024, "num_steps_sampled": 116035, "sample_time_ms": 44144.699, "load_time_ms": 6.901, "grad_time_ms": 2401.946, "update_time_ms": 7.169, "learner": {"avProbe": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 81346864.0, "policy_loss": -0.0004046894609928131, "vf_loss": 81346864.0, "vf_explained_var": 4.8557052650721744e-05, "kl": 0.000307075388263911, "entropy": 1.3127410411834717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 116035, "episodes_total": 102, "training_iteration": 29, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-34-53", "timestamp": 1684528493, "time_this_iter_s": 46.784345388412476, "time_total_s": 1230.6834704875946, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1230.6834704875946, "timesteps_since_restore": 116035, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 39.87272727272727, "ram_util_percent": 16.900000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1948867.7833517103, "episode_reward_mean": -1028898.9203361445, "episode_len_mean": 987.99, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -205779.78406722896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 166.26258799853622, "mean_processing_ms": 4.65866014848979, "mean_inference_ms": 0.9962955891902913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 483328, "num_steps_sampled": 120035, "sample_time_ms": 43986.818, "load_time_ms": 6.836, "grad_time_ms": 2396.951, "update_time_ms": 6.896, "learner": {"avProbe": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 86404216.0, "policy_loss": 0.002601173473522067, "vf_loss": 86404216.0, "vf_explained_var": 7.073747110553086e-05, "kl": 3.389701305422932e-05, "entropy": 1.3205183744430542, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 120035, "episodes_total": 120, "training_iteration": 30, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-35-44", "timestamp": 1684528544, "time_this_iter_s": 51.14789533615112, "time_total_s": 1281.8313658237457, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1281.8313658237457, "timesteps_since_restore": 120035, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 41.27397260273972, "ram_util_percent": 16.88219178082192}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1948867.7833517103, "episode_reward_mean": -1028898.9203361445, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -983036.0758188926}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -205779.78406722896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 166.26258799853622, "mean_processing_ms": 4.65866014848979, "mean_inference_ms": 0.9962955891902913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 502144, "num_steps_sampled": 124035, "sample_time_ms": 43867.513, "load_time_ms": 6.717, "grad_time_ms": 2340.583, "update_time_ms": 7.102, "learner": {"avProbe": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 30138678.0, "policy_loss": -0.0008345570531673729, "vf_loss": 30138678.0, "vf_explained_var": 0.0015396568924188614, "kl": 0.001582894823513925, "entropy": 1.2976707220077515, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 124035, "episodes_total": 120, "training_iteration": 31, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-36-27", "timestamp": 1684528587, "time_this_iter_s": 42.06411123275757, "time_total_s": 1323.8954770565033, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1323.8954770565033, "timesteps_since_restore": 124035, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.83666666666667, "ram_util_percent": 16.9}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1948867.7833517103, "episode_reward_mean": -1015293.5741717543, "episode_len_mean": 987.99, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -968579.1704350248}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -203058.71483435086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 166.04800811640257, "mean_processing_ms": 4.662071829362993, "mean_inference_ms": 0.9940757905195163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 520192, "num_steps_sampled": 128035, "sample_time_ms": 44076.299, "load_time_ms": 6.763, "grad_time_ms": 2354.795, "update_time_ms": 6.782, "learner": {"avProbe": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 127182168.0, "policy_loss": -0.0005547245964407921, "vf_loss": 127182168.0, "vf_explained_var": 5.629341831081547e-05, "kl": 0.00091960234567523, "entropy": 1.2648131847381592, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 128035, "episodes_total": 122, "training_iteration": 32, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-37-16", "timestamp": 1684528636, "time_this_iter_s": 49.70449948310852, "time_total_s": 1373.5999765396118, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1373.5999765396118, "timesteps_since_restore": 128035, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.677464788732397, "ram_util_percent": 16.90000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1948867.7833517103, "episode_reward_mean": -1015293.5741717543, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -968579.1704350248}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -203058.71483435086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 166.0480081164025, "mean_processing_ms": 4.662071829362992, "mean_inference_ms": 0.9940757905195164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 540160, "num_steps_sampled": 132035, "sample_time_ms": 44080.136, "load_time_ms": 6.66, "grad_time_ms": 2367.547, "update_time_ms": 6.461, "learner": {"avProbe": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 238176288.0, "policy_loss": -0.0001828292297432199, "vf_loss": 238176288.0, "vf_explained_var": 1.7507336451672018e-05, "kl": 0.0003262415120843798, "entropy": 1.2776883840560913, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 132035, "episodes_total": 122, "training_iteration": 33, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-37-56", "timestamp": 1684528676, "time_this_iter_s": 39.394766092300415, "time_total_s": 1412.9947426319122, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1412.9947426319122, "timesteps_since_restore": 132035, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.873684210526314, "ram_util_percent": 16.910526315789475}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1948867.7833517103, "episode_reward_mean": -1015293.5741717543, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -968579.1704350248}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -203058.71483435086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 166.0480081164025, "mean_processing_ms": 4.662071829362992, "mean_inference_ms": 0.9940757905195164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 551040, "num_steps_sampled": 136035, "sample_time_ms": 44182.135, "load_time_ms": 6.588, "grad_time_ms": 2327.776, "update_time_ms": 6.468, "learner": {"avProbe": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 59918952.0, "policy_loss": 0.00040158297633752227, "vf_loss": 59918952.0, "vf_explained_var": 4.5949571358505636e-05, "kl": 0.00020052536274306476, "entropy": 1.2632575035095215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 136035, "episodes_total": 122, "training_iteration": 34, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-38-44", "timestamp": 1684528724, "time_this_iter_s": 47.8492317199707, "time_total_s": 1460.843974351883, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1460.843974351883, "timesteps_since_restore": 136035, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 39.779411764705884, "ram_util_percent": 17.016176470588235}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -896569.939477666, "episode_len_mean": 987.99, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -179313.9878955332}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 165.25465521949513, "mean_processing_ms": 4.649767055428216, "mean_inference_ms": 0.95592499301857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 553088, "num_steps_sampled": 140035, "sample_time_ms": 44092.15, "load_time_ms": 6.683, "grad_time_ms": 2315.529, "update_time_ms": 6.439, "learner": {"avProbe": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 197915440.0, "policy_loss": 0.00017419131472706795, "vf_loss": 197915440.0, "vf_explained_var": 2.637133002281189e-05, "kl": 3.531778929755092e-05, "entropy": 1.2594337463378906, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 140035, "episodes_total": 140, "training_iteration": 35, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-39-35", "timestamp": 1684528775, "time_this_iter_s": 51.58472990989685, "time_total_s": 1512.4287042617798, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1512.4287042617798, "timesteps_since_restore": 140035, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 42.20684931506849, "ram_util_percent": 16.982191780821914}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -896569.939477666, "episode_len_mean": 987.99, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -179313.98789553324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 165.25465521949513, "mean_processing_ms": 4.649767055428215, "mean_inference_ms": 0.9559249930185696}, "off_policy_estimator": {}, "info": {"num_steps_trained": 571904, "num_steps_sampled": 144035, "sample_time_ms": 44006.257, "load_time_ms": 6.441, "grad_time_ms": 2286.45, "update_time_ms": 6.26, "learner": {"avProbe": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 21551306.0, "policy_loss": -0.00022800789156462997, "vf_loss": 21551306.0, "vf_explained_var": 0.002097513759508729, "kl": 0.0004389278474263847, "entropy": 1.2563263177871704, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 144035, "episodes_total": 140, "training_iteration": 36, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-40-18", "timestamp": 1684528818, "time_this_iter_s": 42.36161828041077, "time_total_s": 1554.7903225421906, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1554.7903225421906, "timesteps_since_restore": 144035, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 20.363934426229505, "ram_util_percent": 17.091803278688523}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -887906.7760591964, "episode_len_mean": 994.16, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -177581.3552118393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 165.1232274902869, "mean_processing_ms": 4.641467140954354, "mean_inference_ms": 0.9528381035852278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 589952, "num_steps_sampled": 148035, "sample_time_ms": 43630.307, "load_time_ms": 6.582, "grad_time_ms": 2237.15, "update_time_ms": 6.313, "learner": {"avProbe": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 79990712.0, "policy_loss": -0.0010736944386735559, "vf_loss": 79990712.0, "vf_explained_var": 7.106310658855364e-05, "kl": 6.639127968810499e-05, "entropy": 1.2572087049484253, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 148035, "episodes_total": 142, "training_iteration": 37, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-41-07", "timestamp": 1684528867, "time_this_iter_s": 48.91031622886658, "time_total_s": 1603.7006387710571, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1603.7006387710571, "timesteps_since_restore": 148035, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.05, "ram_util_percent": 17.034285714285716}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -887906.7760591964, "episode_len_mean": 994.16, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -177581.3552118393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 165.12322749028684, "mean_processing_ms": 4.641467140954354, "mean_inference_ms": 0.9528381035852281}, "off_policy_estimator": {}, "info": {"num_steps_trained": 609920, "num_steps_sampled": 152035, "sample_time_ms": 43683.11, "load_time_ms": 6.55, "grad_time_ms": 2217.586, "update_time_ms": 5.979, "learner": {"avProbe": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 166992560.0, "policy_loss": 7.288893539225683e-05, "vf_loss": 166992560.0, "vf_explained_var": 2.2001755496603437e-05, "kl": 2.429359665256925e-05, "entropy": 1.2531883716583252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 152035, "episodes_total": 142, "training_iteration": 38, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-41-46", "timestamp": 1684528906, "time_this_iter_s": 39.60693573951721, "time_total_s": 1643.3075745105743, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1643.3075745105743, "timesteps_since_restore": 152035, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 40.61071428571428, "ram_util_percent": 17.110714285714288}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -887906.7760591964, "episode_len_mean": 994.16, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19683.060272352093}, "policy_reward_mean": {"avProbe": -177581.3552118393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 165.12322749028684, "mean_processing_ms": 4.641467140954354, "mean_inference_ms": 0.9528381035852281}, "off_policy_estimator": {}, "info": {"num_steps_trained": 621056, "num_steps_sampled": 156035, "sample_time_ms": 43718.307, "load_time_ms": 6.437, "grad_time_ms": 2196.752, "update_time_ms": 5.96, "learner": {"avProbe": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 61442620.0, "policy_loss": -0.0007423313218168914, "vf_loss": 61442620.0, "vf_explained_var": 3.6190296668792143e-05, "kl": 0.0006942434702068567, "entropy": 1.2353934049606323, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 156035, "episodes_total": 142, "training_iteration": 39, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-42-33", "timestamp": 1684528953, "time_this_iter_s": 46.9334352016449, "time_total_s": 1690.2410097122192, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1690.2410097122192, "timesteps_since_restore": 156035, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 42.13880597014926, "ram_util_percent": 17.156716417910452}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -836010.761465641, "episode_len_mean": 994.16, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -167202.15229312825}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.4822524498146, "mean_processing_ms": 4.628853883002499, "mean_inference_ms": 0.9269546119583413}, "off_policy_estimator": {}, "info": {"num_steps_trained": 623104, "num_steps_sampled": 160035, "sample_time_ms": 43788.99, "load_time_ms": 6.46, "grad_time_ms": 2192.163, "update_time_ms": 6.068, "learner": {"avProbe": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 312297216.0, "policy_loss": -0.003979281056672335, "vf_loss": 312297216.0, "vf_explained_var": 9.201467037200928e-06, "kl": 7.392407860606909e-05, "entropy": 1.2298998832702637, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 160035, "episodes_total": 160, "training_iteration": 40, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-43-25", "timestamp": 1684529005, "time_this_iter_s": 51.81603002548218, "time_total_s": 1742.0570397377014, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7510>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1742.0570397377014, "timesteps_since_restore": 160035, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 41.498648648648654, "ram_util_percent": 17.139189189189185}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -368281.26630329585, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -836010.7614656406, "episode_len_mean": 994.16, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -167202.15229312825}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.48225244981467, "mean_processing_ms": 4.628853883002499, "mean_inference_ms": 0.9269546119583412}, "off_policy_estimator": {}, "info": {"num_steps_trained": 641920, "num_steps_sampled": 164035, "sample_time_ms": 43819.758, "load_time_ms": 6.422, "grad_time_ms": 2190.046, "update_time_ms": 6.303, "learner": {"avProbe": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 16144280.0, "policy_loss": 0.0007307456689886749, "vf_loss": 16144280.0, "vf_explained_var": 0.0028154347091913223, "kl": 0.0003388307522982359, "entropy": 1.2372403144836426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 164035, "episodes_total": 160, "training_iteration": 41, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-44-07", "timestamp": 1684529047, "time_this_iter_s": 42.35680150985718, "time_total_s": 1784.4138412475586, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1784.4138412475586, "timesteps_since_restore": 164035, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.45409836065574, "ram_util_percent": 17.016393442622952}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -844295.9441143489, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -168859.1888228699}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.50411600394457, "mean_processing_ms": 4.618519715955522, "mean_inference_ms": 0.9239674552569046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 659968, "num_steps_sampled": 168035, "sample_time_ms": 43813.847, "load_time_ms": 6.201, "grad_time_ms": 2161.281, "update_time_ms": 6.288, "learner": {"avProbe": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 65948280.0, "policy_loss": -0.001521983416751027, "vf_loss": 65948280.0, "vf_explained_var": 4.764609184348956e-05, "kl": 0.002465434605255723, "entropy": 1.219567060470581, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 168035, "episodes_total": 162, "training_iteration": 42, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-44-57", "timestamp": 1684529097, "time_this_iter_s": 49.34876561164856, "time_total_s": 1833.7626068592072, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af72f0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1833.7626068592072, "timesteps_since_restore": 168035, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.087142857142858, "ram_util_percent": 17.0}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -844295.9441143492, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -168859.1888228699}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.50411600394457, "mean_processing_ms": 4.618519715955522, "mean_inference_ms": 0.9239674552569045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 679936, "num_steps_sampled": 172035, "sample_time_ms": 43769.712, "load_time_ms": 5.937, "grad_time_ms": 2134.671, "update_time_ms": 6.345, "learner": {"avProbe": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 281583456.0, "policy_loss": -0.0009435426909476519, "vf_loss": 281583456.0, "vf_explained_var": 1.3032020433456637e-05, "kl": 0.0013186809374019504, "entropy": 1.2507543563842773, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 172035, "episodes_total": 162, "training_iteration": 43, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-45-35", "timestamp": 1684529135, "time_this_iter_s": 38.67384696006775, "time_total_s": 1872.436453819275, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1872.436453819275, "timesteps_since_restore": 172035, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 38.52909090909092, "ram_util_percent": 17.0}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1891371.663532543, "episode_reward_mean": -844295.9441143492, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -942825.5191559256}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -168859.1888228699}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.50411600394457, "mean_processing_ms": 4.618519715955522, "mean_inference_ms": 0.9239674552569045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 690176, "num_steps_sampled": 176035, "sample_time_ms": 43524.068, "load_time_ms": 5.734, "grad_time_ms": 2118.93, "update_time_ms": 6.339, "learner": {"avProbe": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 40880544.0, "policy_loss": -0.0014941279077902436, "vf_loss": 40880548.0, "vf_explained_var": 2.9249489671201445e-05, "kl": 0.00010130896407645196, "entropy": 1.2509348392486572, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 176035, "episodes_total": 162, "training_iteration": 44, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-46-21", "timestamp": 1684529181, "time_this_iter_s": 45.232959508895874, "time_total_s": 1917.6694133281708, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1917.6694133281708, "timesteps_since_restore": 176035, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 40.32769230769231, "ram_util_percent": 17.06923076923077}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -791228.6834238155, "episode_len_mean": 1000.0, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -799636.6611173582}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -158245.73668476316}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.98702346980562, "mean_processing_ms": 4.611921620520266, "mean_inference_ms": 0.9037734101855971}, "off_policy_estimator": {}, "info": {"num_steps_trained": 692224, "num_steps_sampled": 180035, "sample_time_ms": 43445.727, "load_time_ms": 5.557, "grad_time_ms": 2118.117, "update_time_ms": 6.758, "learner": {"avProbe": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 88502624.0, "policy_loss": 0.0026543010026216507, "vf_loss": 88502624.0, "vf_explained_var": 2.208724617958069e-05, "kl": 8.338861516676843e-05, "entropy": 1.250050663948059, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 180035, "episodes_total": 180, "training_iteration": 45, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-47-12", "timestamp": 1684529232, "time_this_iter_s": 50.79507279396057, "time_total_s": 1968.4644861221313, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1968.4644861221313, "timesteps_since_restore": 180035, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 41.57083333333334, "ram_util_percent": 17.068055555555556}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -791228.6834238154, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -799636.6611173582}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -158245.73668476313}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.98702346980556, "mean_processing_ms": 4.611921620520266, "mean_inference_ms": 0.9037734101855972}, "off_policy_estimator": {}, "info": {"num_steps_trained": 710912, "num_steps_sampled": 184035, "sample_time_ms": 43501.611, "load_time_ms": 5.796, "grad_time_ms": 2109.344, "update_time_ms": 6.872, "learner": {"avProbe": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 24371982.0, "policy_loss": 8.321175846504048e-05, "vf_loss": 24371984.0, "vf_explained_var": 0.002004611073061824, "kl": 0.00022565096151083708, "entropy": 1.2403484582901, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 184035, "episodes_total": 180, "training_iteration": 46, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-47-54", "timestamp": 1684529274, "time_this_iter_s": 42.83880400657654, "time_total_s": 2011.3032901287079, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af72f0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2011.3032901287079, "timesteps_since_restore": 184035, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 20.538709677419355, "ram_util_percent": 17.074193548387097}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -787231.9867723505, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -799636.6611173582}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -157446.39735447016}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.0023780781751, "mean_processing_ms": 4.604128759916284, "mean_inference_ms": 0.9014079455827998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 728960, "num_steps_sampled": 188035, "sample_time_ms": 43620.465, "load_time_ms": 6.179, "grad_time_ms": 2117.658, "update_time_ms": 7.116, "learner": {"avProbe": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 99811872.0, "policy_loss": -0.00035778997698798776, "vf_loss": 99811872.0, "vf_explained_var": 3.265911800554022e-05, "kl": 0.0014154412783682346, "entropy": 1.2118628025054932, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 188035, "episodes_total": 182, "training_iteration": 47, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-48-45", "timestamp": 1684529325, "time_this_iter_s": 50.190590143203735, "time_total_s": 2061.4938802719116, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2061.4938802719116, "timesteps_since_restore": 188035, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.387323943661976, "ram_util_percent": 17.31971830985916}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -787231.9867723506, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -799636.6611173582}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -157446.3973544702}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.0023780781751, "mean_processing_ms": 4.604128759916283, "mean_inference_ms": 0.9014079455827998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 748928, "num_steps_sampled": 192035, "sample_time_ms": 43540.129, "load_time_ms": 5.877, "grad_time_ms": 2158.58, "update_time_ms": 7.408, "learner": {"avProbe": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 228416848.0, "policy_loss": -0.0006882691523060203, "vf_loss": 228416848.0, "vf_explained_var": 7.591186204081168e-06, "kl": 0.00027736974880099297, "entropy": 1.202085018157959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 192035, "episodes_total": 182, "training_iteration": 48, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-49-24", "timestamp": 1684529364, "time_this_iter_s": 39.21945238113403, "time_total_s": 2100.7133326530457, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2100.7133326530457, "timesteps_since_restore": 192035, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 38.771428571428565, "ram_util_percent": 17.33214285714286}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -787231.9867723506, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -799636.6611173582}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -157446.3973544702}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.0023780781751, "mean_processing_ms": 4.604128759916283, "mean_inference_ms": 0.9014079455827998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 758912, "num_steps_sampled": 196035, "sample_time_ms": 43469.025, "load_time_ms": 5.577, "grad_time_ms": 2142.21, "update_time_ms": 7.484, "learner": {"avProbe": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 72347536.0, "policy_loss": -0.00015895164688117802, "vf_loss": 72347536.0, "vf_explained_var": 1.0883196409849916e-05, "kl": 5.8573236856318545e-06, "entropy": 1.1989041566848755, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 196035, "episodes_total": 182, "training_iteration": 49, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-50-10", "timestamp": 1684529410, "time_this_iter_s": 46.04903268814087, "time_total_s": 2146.7623653411865, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2146.7623653411865, "timesteps_since_restore": 196035, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 41.804545454545455, "ram_util_percent": 17.233333333333334}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -784680.225061307, "episode_len_mean": 1000.0, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -156936.0450122614}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.63598391157836, "mean_processing_ms": 4.60050339149569, "mean_inference_ms": 0.8850535704647833}, "off_policy_estimator": {}, "info": {"num_steps_trained": 760960, "num_steps_sampled": 200035, "sample_time_ms": 43381.413, "load_time_ms": 5.701, "grad_time_ms": 2142.49, "update_time_ms": 7.604, "learner": {"avProbe": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 181264576.0, "policy_loss": 0.0027532950043678284, "vf_loss": 181264576.0, "vf_explained_var": 8.203089237213135e-06, "kl": 4.346546484157443e-05, "entropy": 1.2056705951690674, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 200035, "episodes_total": 200, "training_iteration": 50, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-51-01", "timestamp": 1684529461, "time_this_iter_s": 50.942546129226685, "time_total_s": 2197.704911470413, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af72f0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2197.704911470413, "timesteps_since_restore": 200035, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 41.83698630136987, "ram_util_percent": 17.21917808219178}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -784680.2250613066, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -156936.0450122614}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.63598391157836, "mean_processing_ms": 4.60050339149569, "mean_inference_ms": 0.8850535704647833}, "off_policy_estimator": {}, "info": {"num_steps_trained": 779648, "num_steps_sampled": 204035, "sample_time_ms": 43347.194, "load_time_ms": 5.81, "grad_time_ms": 2138.964, "update_time_ms": 7.336, "learner": {"avProbe": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 20394668.0, "policy_loss": -0.001792375580407679, "vf_loss": 20394668.0, "vf_explained_var": 0.0023320093750953674, "kl": 0.0020842216908931732, "entropy": 1.1870790719985962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 204035, "episodes_total": 200, "training_iteration": 51, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-51-43", "timestamp": 1684529503, "time_this_iter_s": 41.974979877471924, "time_total_s": 2239.679891347885, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2239.679891347885, "timesteps_since_restore": 204035, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 19.54, "ram_util_percent": 17.1}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -783082.0823522708, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -156616.41647045422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.61992633341978, "mean_processing_ms": 4.593541907051255, "mean_inference_ms": 0.8831760512951854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 797696, "num_steps_sampled": 208035, "sample_time_ms": 43451.855, "load_time_ms": 6.156, "grad_time_ms": 2162.301, "update_time_ms": 7.532, "learner": {"avProbe": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 84716216.0, "policy_loss": -0.0012006453471258283, "vf_loss": 84716216.0, "vf_explained_var": 2.0652374587371014e-05, "kl": 0.0008435354102402925, "entropy": 1.1668285131454468, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 208035, "episodes_total": 202, "training_iteration": 52, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-52-34", "timestamp": 1684529554, "time_this_iter_s": 50.63503408432007, "time_total_s": 2290.314925432205, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2290.314925432205, "timesteps_since_restore": 208035, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 26.977777777777778, "ram_util_percent": 17.22361111111111}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -783082.0823522706, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -156616.41647045422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.61992633341978, "mean_processing_ms": 4.593541907051255, "mean_inference_ms": 0.8831760512951854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 817664, "num_steps_sampled": 212035, "sample_time_ms": 43555.538, "load_time_ms": 6.547, "grad_time_ms": 2175.548, "update_time_ms": 7.935, "learner": {"avProbe": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 198304768.0, "policy_loss": -0.00033989205257967114, "vf_loss": 198304768.0, "vf_explained_var": 8.589946446591057e-06, "kl": 0.00036909047048538923, "entropy": 1.1497164964675903, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 212035, "episodes_total": 202, "training_iteration": 53, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-53-14", "timestamp": 1684529594, "time_this_iter_s": 39.84946608543396, "time_total_s": 2330.164391517639, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2330.164391517639, "timesteps_since_restore": 212035, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 41.37017543859648, "ram_util_percent": 17.380701754385964}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -385797.00967624946, "episode_reward_min": -1326646.79488403, "episode_reward_mean": -783082.0823522706, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -156616.41647045422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.61992633341978, "mean_processing_ms": 4.593541907051255, "mean_inference_ms": 0.8831760512951854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 827264, "num_steps_sampled": 216035, "sample_time_ms": 43669.895, "load_time_ms": 6.758, "grad_time_ms": 2154.393, "update_time_ms": 8.537, "learner": {"avProbe": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 65663312.0, "policy_loss": -0.0009724660776555538, "vf_loss": 65663312.0, "vf_explained_var": 7.843176717869937e-06, "kl": 0.0010955737670883536, "entropy": 1.1341552734375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 216035, "episodes_total": 202, "training_iteration": 54, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-54-00", "timestamp": 1684529640, "time_this_iter_s": 46.163113832473755, "time_total_s": 2376.327505350113, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af72f0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2376.327505350113, "timesteps_since_restore": 216035, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 42.7939393939394, "ram_util_percent": 17.46969696969697}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -291437.02870821685, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -751348.8585144378, "episode_len_mean": 1000.0, "episodes_this_iter": 18, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -150269.7717028876}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.38255603349225, "mean_processing_ms": 4.590283563605528, "mean_inference_ms": 0.8699077495975237}, "off_policy_estimator": {}, "info": {"num_steps_trained": 829312, "num_steps_sampled": 220035, "sample_time_ms": 43789.936, "load_time_ms": 6.912, "grad_time_ms": 2154.517, "update_time_ms": 8.294, "learner": {"avProbe": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 227465120.0, "policy_loss": 0.0009545730426907539, "vf_loss": 227465120.0, "vf_explained_var": 4.7050416469573975e-06, "kl": 5.059901741333306e-05, "entropy": 1.1366660594940186, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 220035, "episodes_total": 220, "training_iteration": 55, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-54-52", "timestamp": 1684529692, "time_this_iter_s": 51.991947174072266, "time_total_s": 2428.319452524185, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2428.319452524185, "timesteps_since_restore": 220035, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 42.505405405405405, "ram_util_percent": 17.544594594594592}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -291437.02870821685, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -751348.8585144382, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -150269.7717028876}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.38255603349222, "mean_processing_ms": 4.590283563605528, "mean_inference_ms": 0.8699077495975237}, "off_policy_estimator": {}, "info": {"num_steps_trained": 848512, "num_steps_sampled": 224035, "sample_time_ms": 43947.818, "load_time_ms": 6.98, "grad_time_ms": 2145.685, "update_time_ms": 8.133, "learner": {"avProbe": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 15852517.0, "policy_loss": -0.001116476021707058, "vf_loss": 15852517.0, "vf_explained_var": 0.002620796440169215, "kl": 0.0015147080412134528, "entropy": 1.1063069105148315, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 224035, "episodes_total": 220, "training_iteration": 56, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-55-36", "timestamp": 1684529736, "time_this_iter_s": 44.3260338306427, "time_total_s": 2472.645486354828, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2472.645486354828, "timesteps_since_restore": 224035, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 22.30476190476191, "ram_util_percent": 17.788888888888884}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -743643.5665732392, "episode_len_mean": 992.91, "episodes_this_iter": 3, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -148728.7133146478}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.33598680496786, "mean_processing_ms": 4.588168840890667, "mean_inference_ms": 0.86856746735603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 866560, "num_steps_sampled": 228035, "sample_time_ms": 43893.111, "load_time_ms": 6.63, "grad_time_ms": 2135.038, "update_time_ms": 8.136, "learner": {"avProbe": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 73681144.0, "policy_loss": -0.00019366689957678318, "vf_loss": 73681144.0, "vf_explained_var": 2.351170769543387e-05, "kl": 0.0005442652618512511, "entropy": 1.116122841835022, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 228035, "episodes_total": 223, "training_iteration": 57, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-56-26", "timestamp": 1684529786, "time_this_iter_s": 49.5373215675354, "time_total_s": 2522.1828079223633, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2522.1828079223633, "timesteps_since_restore": 228035, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.828169014084512, "ram_util_percent": 17.522535211267606}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -743643.5665732389, "episode_len_mean": 992.91, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -148728.71331464782}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.33598680496786, "mean_processing_ms": 4.588168840890667, "mean_inference_ms": 0.8685674673560299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 886528, "num_steps_sampled": 232035, "sample_time_ms": 43933.896, "load_time_ms": 6.753, "grad_time_ms": 2118.416, "update_time_ms": 8.238, "learner": {"avProbe": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 176855552.0, "policy_loss": -0.00015256305050570518, "vf_loss": 176855552.0, "vf_explained_var": 3.307178849354386e-05, "kl": 0.00026287874788977206, "entropy": 1.0974129438400269, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 232035, "episodes_total": 223, "training_iteration": 58, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-57-05", "timestamp": 1684529825, "time_this_iter_s": 39.45297193527222, "time_total_s": 2561.6357798576355, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af72f0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2561.6357798576355, "timesteps_since_restore": 232035, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 38.44285714285714, "ram_util_percent": 17.53035714285714}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -743643.5665732389, "episode_len_mean": 992.91, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -148728.71331464782}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.33598680496786, "mean_processing_ms": 4.588168840890667, "mean_inference_ms": 0.8685674673560299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 896512, "num_steps_sampled": 236035, "sample_time_ms": 43875.049, "load_time_ms": 6.83, "grad_time_ms": 2136.649, "update_time_ms": 8.29, "learner": {"avProbe": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 44156056.0, "policy_loss": -0.0008165917242877185, "vf_loss": 44156056.0, "vf_explained_var": 9.541327926854137e-06, "kl": 0.0007461301283910871, "entropy": 1.1118128299713135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 236035, "episodes_total": 223, "training_iteration": 59, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-57-51", "timestamp": 1684529871, "time_this_iter_s": 45.64910864830017, "time_total_s": 2607.2848885059357, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2607.2848885059357, "timesteps_since_restore": 236035, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 40.36, "ram_util_percent": 17.56923076923077}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -711551.1938354048, "episode_len_mean": 992.91, "episodes_this_iter": 17, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -142310.238767081}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.1652034143781, "mean_processing_ms": 4.582486719001869, "mean_inference_ms": 0.8578829611350111}, "off_policy_estimator": {}, "info": {"num_steps_trained": 899328, "num_steps_sampled": 240035, "sample_time_ms": 43920.41, "load_time_ms": 6.732, "grad_time_ms": 2145.603, "update_time_ms": 8.23, "learner": {"avProbe": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 171432032.0, "policy_loss": 0.0029208024498075247, "vf_loss": 171432032.0, "vf_explained_var": 8.176673873094842e-06, "kl": 0.0001508612185716629, "entropy": 1.1044188737869263, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 240035, "episodes_total": 240, "training_iteration": 60, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-58-42", "timestamp": 1684529922, "time_this_iter_s": 51.48355007171631, "time_total_s": 2658.768438577652, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af71e0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2658.768438577652, "timesteps_since_restore": 240035, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 40.31351351351351, "ram_util_percent": 17.394594594594597}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -711431.7233315867, "episode_len_mean": 992.91, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -142286.3446663174}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.21301419458956, "mean_processing_ms": 4.583993805934864, "mean_inference_ms": 0.8573565911406886}, "off_policy_estimator": {}, "info": {"num_steps_trained": 916992, "num_steps_sampled": 244126, "sample_time_ms": 46173.727, "load_time_ms": 6.402, "grad_time_ms": 2129.975, "update_time_ms": 8.315, "learner": {"avProbe": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 15987013.0, "policy_loss": -0.0006413472583517432, "vf_loss": 15987013.0, "vf_explained_var": 0.003017652314156294, "kl": 0.00020477079669944942, "entropy": 1.1225932836532593, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4091, "done": false, "timesteps_total": 244126, "episodes_total": 241, "training_iteration": 61, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_16-59-47", "timestamp": 1684529987, "time_this_iter_s": 64.3446877002716, "time_total_s": 2723.1131262779236, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2723.1131262779236, "timesteps_since_restore": 244126, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 14.765217391304349, "ram_util_percent": 17.400000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -707916.5988044888, "episode_len_mean": 992.91, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -141583.31976089778}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.12877096315495, "mean_processing_ms": 4.581712505916356, "mean_inference_ms": 0.856788726392125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 935040, "num_steps_sampled": 248126, "sample_time_ms": 46042.815, "load_time_ms": 6.308, "grad_time_ms": 2105.245, "update_time_ms": 8.19, "learner": {"avProbe": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 67782600.0, "policy_loss": 0.00013731219223700464, "vf_loss": 67782600.0, "vf_explained_var": 2.7662050342769362e-05, "kl": 0.00026671795058064163, "entropy": 1.102435827255249, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 248126, "episodes_total": 243, "training_iteration": 62, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-00-36", "timestamp": 1684530036, "time_this_iter_s": 49.06766128540039, "time_total_s": 2772.180787563324, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2772.180787563324, "timesteps_since_restore": 248126, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 25.40714285714286, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -707916.5988044887, "episode_len_mean": 992.91, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -141583.31976089778}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.12877096315498, "mean_processing_ms": 4.581712505916356, "mean_inference_ms": 0.856788726392125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 955008, "num_steps_sampled": 252126, "sample_time_ms": 45973.484, "load_time_ms": 6.329, "grad_time_ms": 2086.449, "update_time_ms": 8.029, "learner": {"avProbe": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 225301136.0, "policy_loss": -0.0002092619688482955, "vf_loss": 225301136.0, "vf_explained_var": 2.4272463633678854e-05, "kl": 0.0013751945225521922, "entropy": 1.069972038269043, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 252126, "episodes_total": 243, "training_iteration": 63, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-01-15", "timestamp": 1684530075, "time_this_iter_s": 38.973164558410645, "time_total_s": 2811.1539521217346, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2811.1539521217346, "timesteps_since_restore": 252126, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.84181818181818, "ram_util_percent": 17.4}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -707916.5988044887, "episode_len_mean": 992.91, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19755.428158723942}, "policy_reward_mean": {"avProbe": -141583.31976089778}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.12877096315498, "mean_processing_ms": 4.581712505916356, "mean_inference_ms": 0.856788726392125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 965120, "num_steps_sampled": 256126, "sample_time_ms": 45899.75, "load_time_ms": 6.183, "grad_time_ms": 2095.404, "update_time_ms": 7.676, "learner": {"avProbe": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 90437696.0, "policy_loss": -0.0002089144691126421, "vf_loss": 90437696.0, "vf_explained_var": 4.095367330592126e-06, "kl": 5.9979065554216504e-05, "entropy": 1.0736241340637207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 256126, "episodes_total": 243, "training_iteration": 64, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-02-00", "timestamp": 1684530120, "time_this_iter_s": 45.51656532287598, "time_total_s": 2856.6705174446106, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2856.6705174446106, "timesteps_since_restore": 256126, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 39.65692307692307, "ram_util_percent": 17.44153846153846}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -705429.5910010794, "episode_len_mean": 992.91, "episodes_this_iter": 17, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -141085.91820021594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.94336905627145, "mean_processing_ms": 4.577051749425845, "mean_inference_ms": 0.8473430738836918}, "off_policy_estimator": {}, "info": {"num_steps_trained": 967552, "num_steps_sampled": 260126, "sample_time_ms": 45823.602, "load_time_ms": 6.098, "grad_time_ms": 2101.77, "update_time_ms": 7.664, "learner": {"avProbe": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 219519360.0, "policy_loss": -0.0002941281418316066, "vf_loss": 219519360.0, "vf_explained_var": 5.979286925139604e-06, "kl": 0.000202873648959212, "entropy": 1.0736764669418335, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 260126, "episodes_total": 260, "training_iteration": 65, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-02-52", "timestamp": 1684530172, "time_this_iter_s": 51.285186529159546, "time_total_s": 2907.95570397377, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2907.95570397377, "timesteps_since_restore": 260126, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 40.5013698630137, "ram_util_percent": 17.465753424657535}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -703148.5270995114, "episode_len_mean": 992.91, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -140629.7054199023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.98741681103388, "mean_processing_ms": 4.578533017727401, "mean_inference_ms": 0.8468134897651544}, "off_policy_estimator": {}, "info": {"num_steps_trained": 985216, "num_steps_sampled": 264126, "sample_time_ms": 46114.566, "load_time_ms": 5.991, "grad_time_ms": 2086.91, "update_time_ms": 8.081, "learner": {"avProbe": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 12044791.0, "policy_loss": -0.0004381537437438965, "vf_loss": 12044791.0, "vf_explained_var": 0.0037503878120332956, "kl": 0.0004727185005322099, "entropy": 1.1021894216537476, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 264126, "episodes_total": 261, "training_iteration": 66, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-03-39", "timestamp": 1684530219, "time_this_iter_s": 47.08510994911194, "time_total_s": 2955.040813922882, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2955.040813922882, "timesteps_since_restore": 264126, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.66617647058823, "ram_util_percent": 17.400000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -700368.0137127605, "episode_len_mean": 992.91, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -140073.60274255218}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.9025822603809, "mean_processing_ms": 4.576292982074219, "mean_inference_ms": 0.8464244371713405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1003264, "num_steps_sampled": 268126, "sample_time_ms": 46050.934, "load_time_ms": 5.832, "grad_time_ms": 2105.7, "update_time_ms": 7.71, "learner": {"avProbe": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 48069416.0, "policy_loss": -0.0001324440527241677, "vf_loss": 48069416.0, "vf_explained_var": 4.431415072758682e-05, "kl": 0.00018325512064620852, "entropy": 1.1118665933609009, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 268126, "episodes_total": 263, "training_iteration": 67, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-04-28", "timestamp": 1684530268, "time_this_iter_s": 49.06924033164978, "time_total_s": 3004.110054254532, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3004.110054254532, "timesteps_since_restore": 268126, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 25.704285714285714, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -700368.0137127604, "episode_len_mean": 992.91, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -140073.60274255212}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.90258226038088, "mean_processing_ms": 4.576292982074219, "mean_inference_ms": 0.8464244371713407}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1023232, "num_steps_sampled": 272126, "sample_time_ms": 45956.615, "load_time_ms": 6.063, "grad_time_ms": 2123.042, "update_time_ms": 7.311, "learner": {"avProbe": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 161073920.0, "policy_loss": 9.587516979081556e-05, "vf_loss": 161073920.0, "vf_explained_var": 7.910568092484027e-05, "kl": 0.0008243860211223364, "entropy": 1.1363275051116943, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 272126, "episodes_total": 263, "training_iteration": 68, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-05-07", "timestamp": 1684530307, "time_this_iter_s": 38.68883919715881, "time_total_s": 3042.7988934516907, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3042.7988934516907, "timesteps_since_restore": 272126, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 37.85454545454545, "ram_util_percent": 17.42181818181818}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -700368.0137127604, "episode_len_mean": 992.91, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -140073.60274255212}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.90258226038088, "mean_processing_ms": 4.576292982074219, "mean_inference_ms": 0.8464244371713407}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1033472, "num_steps_sampled": 276126, "sample_time_ms": 45909.858, "load_time_ms": 6.208, "grad_time_ms": 2108.939, "update_time_ms": 7.169, "learner": {"avProbe": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 47830044.0, "policy_loss": -0.0013748698402196169, "vf_loss": 47830048.0, "vf_explained_var": 6.622821274504531e-06, "kl": 0.001883742748759687, "entropy": 1.115551233291626, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 276126, "episodes_total": 263, "training_iteration": 69, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-05-52", "timestamp": 1684530352, "time_this_iter_s": 45.03165245056152, "time_total_s": 3087.830545902252, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3087.830545902252, "timesteps_since_restore": 276126, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 40.34218750000001, "ram_util_percent": 17.490625}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -103518.20167809652, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -671064.6685019463, "episode_len_mean": 992.28, "episodes_this_iter": 17, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -134212.9337003893}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.74901862002392, "mean_processing_ms": 4.5706021375409795, "mean_inference_ms": 0.8385615823942127}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1036672, "num_steps_sampled": 280126, "sample_time_ms": 45884.199, "load_time_ms": 6.206, "grad_time_ms": 2116.09, "update_time_ms": 7.037, "learner": {"avProbe": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 114319688.0, "policy_loss": -5.092352512292564e-05, "vf_loss": 114319688.0, "vf_explained_var": 9.143352508544922e-05, "kl": 0.00014223137986846268, "entropy": 1.1184914112091064, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 280126, "episodes_total": 280, "training_iteration": 70, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-06-43", "timestamp": 1684530403, "time_this_iter_s": 51.29542636871338, "time_total_s": 3139.1259722709656, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3139.1259722709656, "timesteps_since_restore": 280126, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 40.26575342465753, "ram_util_percent": 17.46986301369863}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -665480.856014527, "episode_len_mean": 983.02, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -133096.17120290545}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.83978280774852, "mean_processing_ms": 4.574425439360553, "mean_inference_ms": 0.8377279554082382}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1054208, "num_steps_sampled": 284126, "sample_time_ms": 44279.167, "load_time_ms": 6.21, "grad_time_ms": 2136.942, "update_time_ms": 7.127, "learner": {"avProbe": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 30444962.0, "policy_loss": -0.0010861293412745, "vf_loss": 30444962.0, "vf_explained_var": 0.0020737508311867714, "kl": 0.0004836787993554026, "entropy": 1.1060131788253784, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 284126, "episodes_total": 282, "training_iteration": 71, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-07-32", "timestamp": 1684530452, "time_this_iter_s": 48.505314111709595, "time_total_s": 3187.631286382675, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3187.631286382675, "timesteps_since_restore": 284126, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 18.288405797101454, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -661088.894234299, "episode_len_mean": 983.02, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -132217.77884685982}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.6892332260183, "mean_processing_ms": 4.571983280866325, "mean_inference_ms": 0.8380605963388406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1072256, "num_steps_sampled": 288126, "sample_time_ms": 44212.067, "load_time_ms": 6.263, "grad_time_ms": 2139.816, "update_time_ms": 7.352, "learner": {"avProbe": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 55647608.0, "policy_loss": 0.0004137716314289719, "vf_loss": 55647608.0, "vf_explained_var": 0.00010758173448266461, "kl": 6.0001744714099914e-05, "entropy": 1.092862606048584, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 288126, "episodes_total": 284, "training_iteration": 72, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-08-20", "timestamp": 1684530500, "time_this_iter_s": 48.431551933288574, "time_total_s": 3236.0628383159637, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3236.0628383159637, "timesteps_since_restore": 288126, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.310000000000002, "ram_util_percent": 17.414285714285725}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -661088.8942342988, "episode_len_mean": 983.02, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -132217.77884685982}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.68923322601833, "mean_processing_ms": 4.571983280866325, "mean_inference_ms": 0.8380605963388406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1092224, "num_steps_sampled": 292126, "sample_time_ms": 44356.244, "load_time_ms": 6.286, "grad_time_ms": 2175.504, "update_time_ms": 7.433, "learner": {"avProbe": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 145779392.0, "policy_loss": -0.000936510565225035, "vf_loss": 145779392.0, "vf_explained_var": 5.859365774085745e-05, "kl": 0.0019655136857181787, "entropy": 1.0738650560379028, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 292126, "episodes_total": 284, "training_iteration": 73, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-09-01", "timestamp": 1684530541, "time_this_iter_s": 40.776379346847534, "time_total_s": 3276.8392176628113, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3276.8392176628113, "timesteps_since_restore": 292126, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 35.97241379310345, "ram_util_percent": 17.45344827586207}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1463465.668737636, "episode_reward_mean": -661088.8942342988, "episode_len_mean": 983.02, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -851403.100942042}, "policy_reward_max": {"avProbe": 19681.107172090087}, "policy_reward_mean": {"avProbe": -132217.77884685982}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.68923322601833, "mean_processing_ms": 4.571983280866325, "mean_inference_ms": 0.8380605963388406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1102720, "num_steps_sampled": 296126, "sample_time_ms": 44465.687, "load_time_ms": 6.368, "grad_time_ms": 2181.442, "update_time_ms": 7.621, "learner": {"avProbe": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 55615700.0, "policy_loss": -0.00033126422204077244, "vf_loss": 55615700.0, "vf_explained_var": 3.241256854380481e-05, "kl": 0.00020434764155652374, "entropy": 1.0866416692733765, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 296126, "episodes_total": 284, "training_iteration": 74, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-09-48", "timestamp": 1684530588, "time_this_iter_s": 46.67125105857849, "time_total_s": 3323.5104687213898, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3323.5104687213898, "timesteps_since_restore": 296126, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 39.28484848484849, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -629871.9002582983, "episode_len_mean": 983.02, "episodes_this_iter": 17, "policy_reward_min": {"avProbe": -847615.2685874435}, "policy_reward_max": {"avProbe": 19679.311830519928}, "policy_reward_mean": {"avProbe": -125974.38005165967}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.6106112691813, "mean_processing_ms": 4.567339859529616, "mean_inference_ms": 0.8312906738855037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1105664, "num_steps_sampled": 300200, "sample_time_ms": 45750.446, "load_time_ms": 6.395, "grad_time_ms": 2189.483, "update_time_ms": 7.759, "learner": {"avProbe": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 23559454.0, "policy_loss": -0.0005654318374581635, "vf_loss": 23559454.0, "vf_explained_var": 0.0006241124356165528, "kl": 0.00024241373466793448, "entropy": 1.098039984703064, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4074, "done": false, "timesteps_total": 300200, "episodes_total": 301, "training_iteration": 75, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-10-52", "timestamp": 1684530652, "time_this_iter_s": 64.22174024581909, "time_total_s": 3387.732208967209, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3387.732208967209, "timesteps_since_restore": 300200, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 33.23478260869565, "ram_util_percent": 17.459782608695658}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -630264.5746911861, "episode_len_mean": 983.02, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -847615.2685874435}, "policy_reward_max": {"avProbe": 19679.311830519928}, "policy_reward_mean": {"avProbe": -126052.91493823723}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.64379107886506, "mean_processing_ms": 4.568969339087817, "mean_inference_ms": 0.8307608491576441}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1123328, "num_steps_sampled": 304200, "sample_time_ms": 45843.279, "load_time_ms": 6.208, "grad_time_ms": 2182.457, "update_time_ms": 7.454, "learner": {"avProbe": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 27128654.0, "policy_loss": -0.0011001626262441278, "vf_loss": 27128654.0, "vf_explained_var": 0.003634187625721097, "kl": 0.00010359632869949564, "entropy": 1.1058729887008667, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 304200, "episodes_total": 302, "training_iteration": 76, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-11-40", "timestamp": 1684530700, "time_this_iter_s": 47.93416500091553, "time_total_s": 3435.6663739681244, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3435.6663739681244, "timesteps_since_restore": 304200, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.69411764705882, "ram_util_percent": 17.400000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -628466.8830548817, "episode_len_mean": 983.02, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -847615.2685874435}, "policy_reward_max": {"avProbe": 19679.311830519928}, "policy_reward_mean": {"avProbe": -125693.37661097637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.49299063519976, "mean_processing_ms": 4.565954513852318, "mean_inference_ms": 0.831115075812992}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1141376, "num_steps_sampled": 308200, "sample_time_ms": 45839.488, "load_time_ms": 6.342, "grad_time_ms": 2163.153, "update_time_ms": 7.424, "learner": {"avProbe": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 97171352.0, "policy_loss": -0.0008795553003437817, "vf_loss": 97171352.0, "vf_explained_var": 0.000509617617353797, "kl": 0.0006737440708093345, "entropy": 1.0874297618865967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 308200, "episodes_total": 304, "training_iteration": 77, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-12-29", "timestamp": 1684530749, "time_this_iter_s": 48.851162910461426, "time_total_s": 3484.517536878586, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3484.517536878586, "timesteps_since_restore": 308200, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 25.654285714285713, "ram_util_percent": 17.44428571428572}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -628466.8830548816, "episode_len_mean": 983.02, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -847615.2685874435}, "policy_reward_max": {"avProbe": 19679.311830519928}, "policy_reward_mean": {"avProbe": -125693.37661097637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.49299063519976, "mean_processing_ms": 4.565954513852318, "mean_inference_ms": 0.8311150758129919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1161344, "num_steps_sampled": 312200, "sample_time_ms": 46087.387, "load_time_ms": 6.017, "grad_time_ms": 2117.852, "update_time_ms": 7.951, "learner": {"avProbe": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 172392608.0, "policy_loss": -0.0006433756207115948, "vf_loss": 172392608.0, "vf_explained_var": 0.00010193425987381488, "kl": 0.0013768868520855904, "entropy": 1.1097283363342285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 312200, "episodes_total": 304, "training_iteration": 78, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-13-09", "timestamp": 1684530789, "time_this_iter_s": 40.70648980140686, "time_total_s": 3525.2240266799927, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3525.2240266799927, "timesteps_since_restore": 312200, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 36.30000000000001, "ram_util_percent": 17.49137931034483}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -628466.8830548816, "episode_len_mean": 983.02, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -847615.2685874435}, "policy_reward_max": {"avProbe": 19679.311830519928}, "policy_reward_mean": {"avProbe": -125693.37661097637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.49299063519976, "mean_processing_ms": 4.565954513852318, "mean_inference_ms": 0.8311150758129919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1171072, "num_steps_sampled": 316200, "sample_time_ms": 46212.465, "load_time_ms": 5.821, "grad_time_ms": 2109.299, "update_time_ms": 7.911, "learner": {"avProbe": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 123738304.0, "policy_loss": 0.00016941639478318393, "vf_loss": 123738304.0, "vf_explained_var": 6.340052095765714e-06, "kl": 0.00024615321308374405, "entropy": 1.1076948642730713, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 316200, "episodes_total": 304, "training_iteration": 79, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-13-56", "timestamp": 1684530836, "time_this_iter_s": 46.2091908454895, "time_total_s": 3571.433217525482, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3571.433217525482, "timesteps_since_restore": 316200, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 39.4030303030303, "ram_util_percent": 17.45}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -619847.6185017406, "episode_len_mean": 983.02, "episodes_this_iter": 17, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19679.38410511384}, "policy_reward_mean": {"avProbe": -123969.52370034817}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.39853612286856, "mean_processing_ms": 4.560818355215597, "mean_inference_ms": 0.8252934596203985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1173888, "num_steps_sampled": 320200, "sample_time_ms": 46361.261, "load_time_ms": 6.124, "grad_time_ms": 2103.016, "update_time_ms": 7.934, "learner": {"avProbe": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 139531536.0, "policy_loss": 0.0008243537158705294, "vf_loss": 139531536.0, "vf_explained_var": 0.0001282583543797955, "kl": 9.669943210610654e-06, "entropy": 1.1065386533737183, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 320200, "episodes_total": 321, "training_iteration": 80, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-14-48", "timestamp": 1684530888, "time_this_iter_s": 52.72116422653198, "time_total_s": 3624.154381752014, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af72f0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3624.154381752014, "timesteps_since_restore": 320200, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 39.48533333333334, "ram_util_percent": 17.175999999999995}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -624942.7574418096, "episode_len_mean": 990.11, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19679.38410511384}, "policy_reward_mean": {"avProbe": -124988.55148836196}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.38889188700512, "mean_processing_ms": 4.558546952079751, "mean_inference_ms": 0.8249887908619384}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1191552, "num_steps_sampled": 324200, "sample_time_ms": 46317.822, "load_time_ms": 6.21, "grad_time_ms": 2085.941, "update_time_ms": 8.034, "learner": {"avProbe": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 15869355.0, "policy_loss": -0.00020775748998858035, "vf_loss": 15869355.0, "vf_explained_var": 0.005162680987268686, "kl": 0.0006012733792886138, "entropy": 1.0894687175750732, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 324200, "episodes_total": 322, "training_iteration": 81, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-15-36", "timestamp": 1684530936, "time_this_iter_s": 47.9033477306366, "time_total_s": 3672.0577294826508, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3672.0577294826508, "timesteps_since_restore": 324200, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.594202898550726, "ram_util_percent": 17.155072463768114}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -626478.9766282757, "episode_len_mean": 990.11, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19679.38410511384}, "policy_reward_mean": {"avProbe": -125295.79532565516}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.30218966878778, "mean_processing_ms": 4.555816259023877, "mean_inference_ms": 0.8247932146176501}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1209600, "num_steps_sampled": 328200, "sample_time_ms": 46395.419, "load_time_ms": 6.214, "grad_time_ms": 2092.433, "update_time_ms": 8.235, "learner": {"avProbe": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 79328336.0, "policy_loss": -6.737354124197736e-05, "vf_loss": 79328336.0, "vf_explained_var": 0.0004944902611896396, "kl": 0.0012024252209812403, "entropy": 1.1192870140075684, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 328200, "episodes_total": 324, "training_iteration": 82, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-16-26", "timestamp": 1684530986, "time_this_iter_s": 49.278560638427734, "time_total_s": 3721.3362901210785, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7158>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3721.3362901210785, "timesteps_since_restore": 328200, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.44857142857143, "ram_util_percent": 17.19285714285715}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -626478.9766282757, "episode_len_mean": 990.11, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19679.38410511384}, "policy_reward_mean": {"avProbe": -125295.79532565517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.30218966878778, "mean_processing_ms": 4.555816259023877, "mean_inference_ms": 0.82479321461765}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1229568, "num_steps_sampled": 332200, "sample_time_ms": 46455.507, "load_time_ms": 5.87, "grad_time_ms": 2052.131, "update_time_ms": 8.319, "learner": {"avProbe": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 247215840.0, "policy_loss": -0.00028757943073287606, "vf_loss": 247215840.0, "vf_explained_var": 9.602690261090174e-05, "kl": 0.0017514684004709125, "entropy": 1.1433528661727905, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 332200, "episodes_total": 324, "training_iteration": 83, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-17-07", "timestamp": 1684531027, "time_this_iter_s": 40.966614961624146, "time_total_s": 3762.3029050827026, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3762.3029050827026, "timesteps_since_restore": 332200, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 35.58305084745763, "ram_util_percent": 17.200000000000003}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -626478.9766282757, "episode_len_mean": 990.11, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19679.38410511384}, "policy_reward_mean": {"avProbe": -125295.79532565517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.30218966878778, "mean_processing_ms": 4.555816259023877, "mean_inference_ms": 0.82479321461765}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1238784, "num_steps_sampled": 336200, "sample_time_ms": 46307.243, "load_time_ms": 5.785, "grad_time_ms": 2032.476, "update_time_ms": 7.995, "learner": {"avProbe": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 47246732.0, "policy_loss": -0.0011976273963227868, "vf_loss": 47246732.0, "vf_explained_var": 1.0348856449127197e-05, "kl": 0.00040069836541078985, "entropy": 1.1568020582199097, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 336200, "episodes_total": 324, "training_iteration": 84, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-17-52", "timestamp": 1684531072, "time_this_iter_s": 44.99451446533203, "time_total_s": 3807.2974195480347, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3807.2974195480347, "timesteps_since_restore": 336200, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 40.326562499999994, "ram_util_percent": 17.2}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -635034.0475616812, "episode_len_mean": 990.11, "episodes_this_iter": 17, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19682.00952566825}, "policy_reward_mean": {"avProbe": -127006.80951233629}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.17843906696658, "mean_processing_ms": 4.549257264335628, "mean_inference_ms": 0.8198728202020966}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1241472, "num_steps_sampled": 340200, "sample_time_ms": 45126.472, "load_time_ms": 5.832, "grad_time_ms": 2027.958, "update_time_ms": 7.776, "learner": {"avProbe": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 28712198.0, "policy_loss": -0.00012283453543204814, "vf_loss": 28712202.0, "vf_explained_var": 0.0005642942269332707, "kl": 0.00026303273625671864, "entropy": 1.157012701034546, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 340200, "episodes_total": 341, "training_iteration": 85, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-18-44", "timestamp": 1684531124, "time_this_iter_s": 52.36663842201233, "time_total_s": 3859.664057970047, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3859.664057970047, "timesteps_since_restore": 340200, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 42.184000000000005, "ram_util_percent": 17.32}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -632873.1990339573, "episode_len_mean": 990.11, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19682.00952566825}, "policy_reward_mean": {"avProbe": -126574.63980679149}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.2168106240204, "mean_processing_ms": 4.550745213154785, "mean_inference_ms": 0.8196014452444337}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1259264, "num_steps_sampled": 344200, "sample_time_ms": 45116.861, "load_time_ms": 6.055, "grad_time_ms": 2065.026, "update_time_ms": 7.871, "learner": {"avProbe": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 12814570.0, "policy_loss": -0.0006797686801292002, "vf_loss": 12814570.0, "vf_explained_var": 0.006546942051500082, "kl": 0.0009254043688997626, "entropy": 1.141452431678772, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 344200, "episodes_total": 342, "training_iteration": 86, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-19-32", "timestamp": 1684531172, "time_this_iter_s": 48.216830015182495, "time_total_s": 3907.8808879852295, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7158>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3907.8808879852295, "timesteps_since_restore": 344200, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 18.623529411764704, "ram_util_percent": 17.200000000000003}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -619062.2403341123, "episode_len_mean": 977.4, "episodes_this_iter": 4, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123812.4480668225}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.11312581206067, "mean_processing_ms": 4.549796717715262, "mean_inference_ms": 0.8193760432718044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1277312, "num_steps_sampled": 348200, "sample_time_ms": 45182.11, "load_time_ms": 6.147, "grad_time_ms": 2080.178, "update_time_ms": 8.154, "learner": {"avProbe": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 62692736.0, "policy_loss": 0.0004303908790461719, "vf_loss": 62692736.0, "vf_explained_var": 0.0006491651874966919, "kl": 0.00025526792160235345, "entropy": 1.1397337913513184, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 348200, "episodes_total": 346, "training_iteration": 87, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-20-22", "timestamp": 1684531222, "time_this_iter_s": 49.66018009185791, "time_total_s": 3957.5410680770874, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3957.5410680770874, "timesteps_since_restore": 348200, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 26.470422535211263, "ram_util_percent": 17.360563380281697}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -619062.2403341124, "episode_len_mean": 977.4, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123812.44806682252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.11312581206064, "mean_processing_ms": 4.549796717715262, "mean_inference_ms": 0.8193760432718042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1297280, "num_steps_sampled": 352200, "sample_time_ms": 45123.07, "load_time_ms": 6.349, "grad_time_ms": 2094.843, "update_time_ms": 7.959, "learner": {"avProbe": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 138497200.0, "policy_loss": -0.00092728016898036, "vf_loss": 138497200.0, "vf_explained_var": 0.00035164906876161695, "kl": 0.0015142071060836315, "entropy": 1.1088567972183228, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 352200, "episodes_total": 346, "training_iteration": 88, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-21-02", "timestamp": 1684531262, "time_this_iter_s": 40.26138758659363, "time_total_s": 3997.802455663681, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3997.802455663681, "timesteps_since_restore": 352200, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 34.337931034482764, "ram_util_percent": 17.379310344827584}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -619062.2403341124, "episode_len_mean": 977.4, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123812.44806682252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.11312581206064, "mean_processing_ms": 4.549796717715262, "mean_inference_ms": 0.8193760432718042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1307904, "num_steps_sampled": 356200, "sample_time_ms": 44971.124, "load_time_ms": 6.429, "grad_time_ms": 2110.673, "update_time_ms": 8.26, "learner": {"avProbe": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 51479988.0, "policy_loss": -0.0009180470951832831, "vf_loss": 51479988.0, "vf_explained_var": 1.1777303370763548e-05, "kl": 0.0006890172371640801, "entropy": 1.080458641052246, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 356200, "episodes_total": 346, "training_iteration": 89, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-21-47", "timestamp": 1684531307, "time_this_iter_s": 44.84249687194824, "time_total_s": 4042.6449525356293, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4042.6449525356293, "timesteps_since_restore": 356200, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 39.35, "ram_util_percent": 17.3046875}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -602804.2771566785, "episode_len_mean": 977.4, "episodes_this_iter": 15, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -120560.85543133573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.0000185033509, "mean_processing_ms": 4.544688197868363, "mean_inference_ms": 0.8153674972282394}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1312640, "num_steps_sampled": 360200, "sample_time_ms": 44744.023, "load_time_ms": 6.172, "grad_time_ms": 2140.324, "update_time_ms": 8.074, "learner": {"avProbe": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 165224896.0, "policy_loss": 0.000694333401042968, "vf_loss": 165224896.0, "vf_explained_var": 0.00012538723240140826, "kl": 6.927178765181452e-05, "entropy": 1.0719664096832275, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 360200, "episodes_total": 361, "training_iteration": 90, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-22-38", "timestamp": 1684531358, "time_this_iter_s": 50.745527505874634, "time_total_s": 4093.390480041504, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4093.390480041504, "timesteps_since_restore": 360200, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 39.9375, "ram_util_percent": 17.28472222222222}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -602120.9640915494, "episode_len_mean": 977.4, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -120424.19281830988}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.0403369513739, "mean_processing_ms": 4.546187164184679, "mean_inference_ms": 0.8151659075176744}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1328768, "num_steps_sampled": 364200, "sample_time_ms": 44797.769, "load_time_ms": 6.258, "grad_time_ms": 2117.101, "update_time_ms": 7.695, "learner": {"avProbe": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 13767041.0, "policy_loss": 0.0002952264912892133, "vf_loss": 13767042.0, "vf_explained_var": 0.006271613761782646, "kl": 0.00019476341549307108, "entropy": 1.0885822772979736, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 364200, "episodes_total": 362, "training_iteration": 91, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-23-26", "timestamp": 1684531406, "time_this_iter_s": 48.206337451934814, "time_total_s": 4141.596817493439, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4141.596817493439, "timesteps_since_restore": 364200, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 21.402898550724636, "ram_util_percent": 17.315942028985507}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -606361.0106003837, "episode_len_mean": 977.4, "episodes_this_iter": 4, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -121272.20212007675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.9369015349322, "mean_processing_ms": 4.544864026671595, "mean_inference_ms": 0.8149957158410236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1345152, "num_steps_sampled": 368200, "sample_time_ms": 44915.443, "load_time_ms": 6.11, "grad_time_ms": 2083.031, "update_time_ms": 7.436, "learner": {"avProbe": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 63443280.0, "policy_loss": 0.00037148501724004745, "vf_loss": 63443280.0, "vf_explained_var": 0.0003127255477011204, "kl": 0.00033677631290629506, "entropy": 1.0823829174041748, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 368200, "episodes_total": 366, "training_iteration": 92, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-24-16", "timestamp": 1684531456, "time_this_iter_s": 50.109375, "time_total_s": 4191.706192493439, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4191.706192493439, "timesteps_since_restore": 368200, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 27.633802816901408, "ram_util_percent": 17.36197183098592}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -606428.4240080643, "episode_len_mean": 972.21, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -121285.68480161286}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.8792816399649, "mean_processing_ms": 4.5452619217085495, "mean_inference_ms": 0.8147450918340335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1365120, "num_steps_sampled": 372200, "sample_time_ms": 44886.945, "load_time_ms": 6.412, "grad_time_ms": 2076.293, "update_time_ms": 7.304, "learner": {"avProbe": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 156630064.0, "policy_loss": 5.427614087238908e-05, "vf_loss": 156630064.0, "vf_explained_var": 0.00034230260644108057, "kl": 0.00012898801651317626, "entropy": 1.082881212234497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 372200, "episodes_total": 367, "training_iteration": 93, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-24-57", "timestamp": 1684531497, "time_this_iter_s": 40.61945295333862, "time_total_s": 4232.325645446777, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4232.325645446777, "timesteps_since_restore": 372200, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 35.25344827586207, "ram_util_percent": 17.444827586206895}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -606428.4240080643, "episode_len_mean": 972.21, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -121285.68480161286}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.8792816399649, "mean_processing_ms": 4.5452619217085495, "mean_inference_ms": 0.8147450918340335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1376256, "num_steps_sampled": 376200, "sample_time_ms": 44870.82, "load_time_ms": 6.453, "grad_time_ms": 2106.944, "update_time_ms": 7.191, "learner": {"avProbe": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 40011416.0, "policy_loss": -0.0005180412554182112, "vf_loss": 40011416.0, "vf_explained_var": 0.00010021801426773891, "kl": 0.0006784279248677194, "entropy": 1.0597418546676636, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 376200, "episodes_total": 367, "training_iteration": 94, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-25-42", "timestamp": 1684531542, "time_this_iter_s": 45.14033770561218, "time_total_s": 4277.4659831523895, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4277.4659831523895, "timesteps_since_restore": 376200, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 39.053846153846145, "ram_util_percent": 17.495384615384612}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -26688.47756919742, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -604903.7211958092, "episode_len_mean": 971.24, "episodes_this_iter": 14, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -120980.74423916185}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.80753001423952, "mean_processing_ms": 4.540982370518275, "mean_inference_ms": 0.8114352647994264}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1382784, "num_steps_sampled": 380200, "sample_time_ms": 44653.059, "load_time_ms": 6.468, "grad_time_ms": 2163.676, "update_time_ms": 7.575, "learner": {"avProbe": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 275305952.0, "policy_loss": -0.000220659319893457, "vf_loss": 275305952.0, "vf_explained_var": 9.406898607267067e-05, "kl": 0.0006643478409387171, "entropy": 1.0395069122314453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 380200, "episodes_total": 381, "training_iteration": 95, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-26-33", "timestamp": 1684531593, "time_this_iter_s": 50.7580931186676, "time_total_s": 4328.224076271057, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4328.224076271057, "timesteps_since_restore": 380200, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 38.72638888888889, "ram_util_percent": 17.46527777777778}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -609453.0005665862, "episode_len_mean": 980.5, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -121890.60011331722}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.78416319600237, "mean_processing_ms": 4.538526115173116, "mean_inference_ms": 0.8110245419070591}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1398656, "num_steps_sampled": 384200, "sample_time_ms": 44760.781, "load_time_ms": 6.229, "grad_time_ms": 2099.241, "update_time_ms": 7.413, "learner": {"avProbe": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 9788883.0, "policy_loss": 0.0006545401993207633, "vf_loss": 9788883.0, "vf_explained_var": 0.008015597239136696, "kl": 0.00026399156195111573, "entropy": 1.050532341003418, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 384200, "episodes_total": 382, "training_iteration": 96, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-27-22", "timestamp": 1684531642, "time_this_iter_s": 48.64304232597351, "time_total_s": 4376.867118597031, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4376.867118597031, "timesteps_since_restore": 384200, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 22.631428571428568, "ram_util_percent": 17.299999999999997}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -615437.2932091928, "episode_len_mean": 980.5, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123087.45864183854}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.7110249163687, "mean_processing_ms": 4.53904626878092, "mean_inference_ms": 0.8110073866612895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1414016, "num_steps_sampled": 388281, "sample_time_ms": 46331.49, "load_time_ms": 5.999, "grad_time_ms": 2076.612, "update_time_ms": 7.222, "learner": {"avProbe": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 90858192.0, "policy_loss": -0.0021319910883903503, "vf_loss": 90858192.0, "vf_explained_var": 0.0005014469497837126, "kl": 0.0015230424469336867, "entropy": 1.0108226537704468, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4081, "done": false, "timesteps_total": 388281, "episodes_total": 387, "training_iteration": 97, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-28-27", "timestamp": 1684531707, "time_this_iter_s": 65.13188886642456, "time_total_s": 4441.999007463455, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4441.999007463455, "timesteps_since_restore": 388281, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 27.562365591397842, "ram_util_percent": 17.565591397849463}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -615437.2932091926, "episode_len_mean": 980.5, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123087.45864183854}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.71102491636873, "mean_processing_ms": 4.53904626878092, "mean_inference_ms": 0.8110073866612892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1433728, "num_steps_sampled": 392281, "sample_time_ms": 48577.008, "load_time_ms": 5.993, "grad_time_ms": 2065.269, "update_time_ms": 6.973, "learner": {"avProbe": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 174576944.0, "policy_loss": 6.710708839818835e-05, "vf_loss": 174576944.0, "vf_explained_var": 0.00039849072345532477, "kl": 0.00030221830820664763, "entropy": 1.0212689638137817, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 392281, "episodes_total": 387, "training_iteration": 98, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-29-30", "timestamp": 1684531770, "time_this_iter_s": 62.60257816314697, "time_total_s": 4504.601585626602, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4504.601585626602, "timesteps_since_restore": 392281, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 81.74269662921348, "ram_util_percent": 24.975280898876402}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1745900.4219749456, "episode_reward_mean": -615437.2932091926, "episode_len_mean": 980.5, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123087.45864183854}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.71102491636873, "mean_processing_ms": 4.53904626878092, "mean_inference_ms": 0.8110073866612892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1444352, "num_steps_sampled": 396281, "sample_time_ms": 51470.128, "load_time_ms": 6.016, "grad_time_ms": 2054.242, "update_time_ms": 6.904, "learner": {"avProbe": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 83127224.0, "policy_loss": -0.0002694171271286905, "vf_loss": 83127224.0, "vf_explained_var": 9.459185093874112e-06, "kl": 9.301283716922626e-05, "entropy": 1.0147241353988647, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 396281, "episodes_total": 387, "training_iteration": 99, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-30-43", "timestamp": 1684531843, "time_this_iter_s": 73.65761756896973, "time_total_s": 4578.259203195572, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4578.259203195572, "timesteps_since_restore": 396281, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 93.03523809523809, "ram_util_percent": 26.66761904761904}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -616702.418404442, "episode_len_mean": 980.5, "episodes_this_iter": 14, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123340.48368088844}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.11848185693367, "mean_processing_ms": 4.546609606150754, "mean_inference_ms": 0.808502281417443}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1450880, "num_steps_sampled": 400281, "sample_time_ms": 54853.101, "load_time_ms": 6.015, "grad_time_ms": 2086.602, "update_time_ms": 6.876, "learner": {"avProbe": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 222471648.0, "policy_loss": -0.0005876021459698677, "vf_loss": 222471648.0, "vf_explained_var": 0.000259163323789835, "kl": 2.642144863784779e-05, "entropy": 1.0170743465423584, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 400281, "episodes_total": 401, "training_iteration": 100, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-32-08", "timestamp": 1684531928, "time_this_iter_s": 84.90342378616333, "time_total_s": 4663.162626981735, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7378>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4663.162626981735, "timesteps_since_restore": 400281, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 93.10909090909091, "ram_util_percent": 26.70826446280991}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -619250.4889132199, "episode_len_mean": 980.5, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123850.09778264404}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.15212169059274, "mean_processing_ms": 4.545676251151895, "mean_inference_ms": 0.8084856516179738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1466368, "num_steps_sampled": 404281, "sample_time_ms": 57062.299, "load_time_ms": 6.089, "grad_time_ms": 2083.074, "update_time_ms": 7.175, "learner": {"avProbe": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 12710288.0, "policy_loss": 2.0956389562343247e-05, "vf_loss": 12710288.0, "vf_explained_var": 0.00718893064185977, "kl": 0.0007623871206305921, "entropy": 1.0146777629852295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 404281, "episodes_total": 402, "training_iteration": 101, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-33-18", "timestamp": 1684531998, "time_this_iter_s": 70.26513981819153, "time_total_s": 4733.427766799927, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4733.427766799927, "timesteps_since_restore": 404281, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 81.96799999999999, "ram_util_percent": 26.717}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -629289.9358735974, "episode_len_mean": 980.5, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -125857.98717471953}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.2818775151021, "mean_processing_ms": 4.5465475050846145, "mean_inference_ms": 0.8094751553908074}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1481728, "num_steps_sampled": 408281, "sample_time_ms": 58913.291, "load_time_ms": 6.261, "grad_time_ms": 2125.037, "update_time_ms": 7.1, "learner": {"avProbe": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 67300424.0, "policy_loss": -0.001489740563556552, "vf_loss": 67300424.0, "vf_explained_var": 0.00037536423769779503, "kl": 0.0015180202899500728, "entropy": 1.0445964336395264, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 408281, "episodes_total": 407, "training_iteration": 102, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-34-28", "timestamp": 1684532068, "time_this_iter_s": 69.03572249412537, "time_total_s": 4802.463489294052, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af70d0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4802.463489294052, "timesteps_since_restore": 408281, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 73.32323232323232, "ram_util_percent": 24.344444444444445}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -629289.9358735975, "episode_len_mean": 980.5, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -894174.9573906538}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -125857.98717471953}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.2818775151021, "mean_processing_ms": 4.546547505084614, "mean_inference_ms": 0.8094751553908073}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1501312, "num_steps_sampled": 412281, "sample_time_ms": 59214.779, "load_time_ms": 6.244, "grad_time_ms": 2162.234, "update_time_ms": 7.017, "learner": {"avProbe": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 154853936.0, "policy_loss": 3.479937367956154e-05, "vf_loss": 154853936.0, "vf_explained_var": 0.00045244910870678723, "kl": 0.00030265605892054737, "entropy": 1.0256626605987549, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 412281, "episodes_total": 407, "training_iteration": 103, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-35-12", "timestamp": 1684532112, "time_this_iter_s": 44.00047779083252, "time_total_s": 4846.463967084885, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4846.463967084885, "timesteps_since_restore": 412281, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 30.787301587301588, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -621501.7771189297, "episode_len_mean": 980.5, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -877852.5112790285}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -124300.35542378595}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.295182216331, "mean_processing_ms": 4.548439111642502, "mean_inference_ms": 0.8093315949162028}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1511680, "num_steps_sampled": 416321, "sample_time_ms": 60526.745, "load_time_ms": 6.17, "grad_time_ms": 2173.077, "update_time_ms": 7.263, "learner": {"avProbe": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 54936688.0, "policy_loss": -0.0004674438969232142, "vf_loss": 54936688.0, "vf_explained_var": 1.1662642464216333e-05, "kl": 0.0010240939445793629, "entropy": 1.009953498840332, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4040, "done": false, "timesteps_total": 416321, "episodes_total": 408, "training_iteration": 104, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-36-10", "timestamp": 1684532170, "time_this_iter_s": 58.36898612976074, "time_total_s": 4904.832953214645, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7158>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4904.832953214645, "timesteps_since_restore": 416321, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 30.307228915662645, "ram_util_percent": 17.400000000000006}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -620259.8234003948, "episode_len_mean": 980.5, "episodes_this_iter": 13, "policy_reward_min": {"avProbe": -877852.5112790285}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -124051.96468007898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.8024564139627, "mean_processing_ms": 4.554461045451186, "mean_inference_ms": 0.8085201524296786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1518336, "num_steps_sampled": 420321, "sample_time_ms": 60530.505, "load_time_ms": 6.344, "grad_time_ms": 2185.735, "update_time_ms": 7.105, "learner": {"avProbe": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 159114608.0, "policy_loss": -0.0021647231187671423, "vf_loss": 159114608.0, "vf_explained_var": 0.00038134821807034314, "kl": 0.0009180344641208649, "entropy": 0.9831383228302002, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 420321, "episodes_total": 421, "training_iteration": 105, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-37-01", "timestamp": 1684532221, "time_this_iter_s": 50.92824697494507, "time_total_s": 4955.76120018959, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4955.76120018959, "timesteps_since_restore": 420321, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 37.086301369863016, "ram_util_percent": 17.38219178082192}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -619484.1382131107, "episode_len_mean": 980.5, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -877852.5112790285}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -123896.8276426222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.8405193158702, "mean_processing_ms": 4.553720284791547, "mean_inference_ms": 0.808618912173895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1533824, "num_steps_sampled": 424321, "sample_time_ms": 60761.847, "load_time_ms": 6.27, "grad_time_ms": 2201.644, "update_time_ms": 7.107, "learner": {"avProbe": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 36794292.0, "policy_loss": -0.00046156643657013774, "vf_loss": 36794292.0, "vf_explained_var": 0.003173905424773693, "kl": 0.0008577628759667277, "entropy": 0.9745193719863892, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 424321, "episodes_total": 422, "training_iteration": 106, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-37-52", "timestamp": 1684532272, "time_this_iter_s": 51.11555862426758, "time_total_s": 5006.876758813858, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5006.876758813858, "timesteps_since_restore": 424321, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 21.18767123287671, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -620481.8316087187, "episode_len_mean": 980.5, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -877852.5112790285}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -124096.3663217438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.95743994227757, "mean_processing_ms": 4.554521388854627, "mean_inference_ms": 0.8096399085154989}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1549184, "num_steps_sampled": 428321, "sample_time_ms": 59265.485, "load_time_ms": 6.445, "grad_time_ms": 2195.813, "update_time_ms": 7.124, "learner": {"avProbe": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 89647840.0, "policy_loss": 0.00044364630593918264, "vf_loss": 89647840.0, "vf_explained_var": 0.00021929839567746967, "kl": 0.0004626125155482441, "entropy": 0.9482535123825073, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 428321, "episodes_total": 427, "training_iteration": 107, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-38-42", "timestamp": 1684532322, "time_this_iter_s": 50.11223006248474, "time_total_s": 5056.988988876343, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5056.988988876343, "timesteps_since_restore": 428321, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 27.69577464788733, "ram_util_percent": 17.385915492957757}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -620481.8316087187, "episode_len_mean": 980.5, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -877852.5112790285}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -124096.36632174382}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.95743994227752, "mean_processing_ms": 4.554521388854627, "mean_inference_ms": 0.8096399085154988}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1568512, "num_steps_sampled": 432321, "sample_time_ms": 57520.723, "load_time_ms": 6.843, "grad_time_ms": 2216.199, "update_time_ms": 7.342, "learner": {"avProbe": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 181606752.0, "policy_loss": 0.0007597981602884829, "vf_loss": 181606752.0, "vf_explained_var": 0.0003860951983369887, "kl": 0.0004544946423266083, "entropy": 0.960055947303772, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 432321, "episodes_total": 427, "training_iteration": 108, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-39-28", "timestamp": 1684532368, "time_this_iter_s": 45.37176251411438, "time_total_s": 5102.360751390457, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af70d0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5102.360751390457, "timesteps_since_restore": 432321, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 29.986153846153847, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1421528.143318507, "episode_reward_mean": -625129.9956379825, "episode_len_mean": 980.5, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -877852.5112790285}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -125025.99912759656}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.96938190637343, "mean_processing_ms": 4.556106907217983, "mean_inference_ms": 0.8095515505191239}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1579136, "num_steps_sampled": 436321, "sample_time_ms": 55209.971, "load_time_ms": 6.912, "grad_time_ms": 2241.116, "update_time_ms": 7.635, "learner": {"avProbe": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 27986120.0, "policy_loss": -9.972790576284751e-05, "vf_loss": 27986120.0, "vf_explained_var": 0.000127237246488221, "kl": 0.00026909232838079333, "entropy": 0.9732187986373901, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 436321, "episodes_total": 428, "training_iteration": 109, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-40-18", "timestamp": 1684532418, "time_this_iter_s": 50.81373310089111, "time_total_s": 5153.174484491348, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5153.174484491348, "timesteps_since_restore": 436321, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 34.329166666666666, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -612641.4725568184, "episode_len_mean": 980.5, "episodes_this_iter": 13, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -122528.29451136371}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.44689123166935, "mean_processing_ms": 4.560998490352573, "mean_inference_ms": 0.808886318603093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1586048, "num_steps_sampled": 440321, "sample_time_ms": 52017.689, "load_time_ms": 6.963, "grad_time_ms": 2250.776, "update_time_ms": 7.888, "learner": {"avProbe": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 174278640.0, "policy_loss": -0.0027151633985340595, "vf_loss": 174278640.0, "vf_explained_var": 0.0003422818845137954, "kl": 0.0008081153500825167, "entropy": 0.995255708694458, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 440321, "episodes_total": 441, "training_iteration": 110, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-41-12", "timestamp": 1684532472, "time_this_iter_s": 53.077484369277954, "time_total_s": 5206.251968860626, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5206.251968860626, "timesteps_since_restore": 440321, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 36.065789473684205, "ram_util_percent": 17.386842105263167}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -196614.0511657267, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -610591.1498720979, "episode_len_mean": 980.5, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19725.512049587735}, "policy_reward_mean": {"avProbe": -122118.2299744196}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.48652451821445, "mean_processing_ms": 4.560371940916622, "mean_inference_ms": 0.8090569947847063}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1601664, "num_steps_sampled": 444321, "sample_time_ms": 49984.884, "load_time_ms": 6.751, "grad_time_ms": 2269.871, "update_time_ms": 8.395, "learner": {"avProbe": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 13062664.0, "policy_loss": -0.00035832609864883125, "vf_loss": 13062664.0, "vf_explained_var": 0.007691926322877407, "kl": 0.00010189864406129345, "entropy": 1.0100581645965576, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 444321, "episodes_total": 442, "training_iteration": 111, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-42-02", "timestamp": 1684532522, "time_this_iter_s": 50.13902544975281, "time_total_s": 5256.390994310379, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5256.390994310379, "timesteps_since_restore": 444321, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 21.580555555555556, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -297362.32404979394, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -620647.6161137526, "episode_len_mean": 993.21, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19679.943752325733}, "policy_reward_mean": {"avProbe": -124129.52322275056}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.61039247997155, "mean_processing_ms": 4.558150349966712, "mean_inference_ms": 0.8096311328295045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1617024, "num_steps_sampled": 448321, "sample_time_ms": 48070.239, "load_time_ms": 6.615, "grad_time_ms": 2246.102, "update_time_ms": 8.512, "learner": {"avProbe": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 69132904.0, "policy_loss": -0.0006905600312165916, "vf_loss": 69132904.0, "vf_explained_var": 0.0007116352790035307, "kl": 0.001721179229207337, "entropy": 0.9821740388870239, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 448321, "episodes_total": 447, "training_iteration": 112, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-42-51", "timestamp": 1684532571, "time_this_iter_s": 49.6510488986969, "time_total_s": 5306.042043209076, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af70d0>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5306.042043209076, "timesteps_since_restore": 448321, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 27.750704225352116, "ram_util_percent": 17.39295774647889}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -297362.32404979394, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -620647.6161137527, "episode_len_mean": 993.21, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19679.943752325733}, "policy_reward_mean": {"avProbe": -124129.52322275056}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.61039247997155, "mean_processing_ms": 4.558150349966711, "mean_inference_ms": 0.8096311328295046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1636352, "num_steps_sampled": 452321, "sample_time_ms": 48160.791, "load_time_ms": 6.716, "grad_time_ms": 2236.279, "update_time_ms": 8.464, "learner": {"avProbe": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 104278888.0, "policy_loss": -0.0009314950439147651, "vf_loss": 104278888.0, "vf_explained_var": 0.0007229482871480286, "kl": 0.0016702563734725118, "entropy": 0.9689614176750183, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 452321, "episodes_total": 447, "training_iteration": 113, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-43-36", "timestamp": 1684532616, "time_this_iter_s": 44.81665563583374, "time_total_s": 5350.85869884491, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5350.85869884491, "timesteps_since_restore": 452321, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 30.428125, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -297362.32404979394, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -620655.0897623581, "episode_len_mean": 993.21, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19679.943752325733}, "policy_reward_mean": {"avProbe": -124131.01795247162}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.62212479115598, "mean_processing_ms": 4.559261906394512, "mean_inference_ms": 0.8100749582952416}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1647360, "num_steps_sampled": 456321, "sample_time_ms": 47373.593, "load_time_ms": 6.543, "grad_time_ms": 2237.003, "update_time_ms": 8.609, "learner": {"avProbe": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 96517840.0, "policy_loss": -0.002678060671314597, "vf_loss": 96517840.0, "vf_explained_var": 2.334284181415569e-05, "kl": 0.0035177567042410374, "entropy": 0.9847230911254883, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 456321, "episodes_total": 448, "training_iteration": 114, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-44-27", "timestamp": 1684532667, "time_this_iter_s": 50.49985384941101, "time_total_s": 5401.358552694321, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5401.358552694321, "timesteps_since_restore": 456321, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 34.27638888888888, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -280003.19175294635, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -618061.8087150664, "episode_len_mean": 993.21, "episodes_this_iter": 13, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123612.36174301329}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.09407690125477, "mean_processing_ms": 4.564127079868236, "mean_inference_ms": 0.8094026898356974}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1654016, "num_steps_sampled": 460321, "sample_time_ms": 47431.516, "load_time_ms": 6.42, "grad_time_ms": 2238.042, "update_time_ms": 8.463, "learner": {"avProbe": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 150194016.0, "policy_loss": -0.0022475251462310553, "vf_loss": 150194016.0, "vf_explained_var": 0.00037423922913149, "kl": 0.0003141540219075978, "entropy": 1.00203537940979, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 460321, "episodes_total": 461, "training_iteration": 115, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-45-18", "timestamp": 1684532718, "time_this_iter_s": 51.509825468063354, "time_total_s": 5452.868378162384, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5452.868378162384, "timesteps_since_restore": 460321, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 37.37260273972603, "ram_util_percent": 17.390410958904113}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -280003.19175294635, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -621573.7938072016, "episode_len_mean": 993.21, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -124314.75876144035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.13355195853714, "mean_processing_ms": 4.563600075441399, "mean_inference_ms": 0.8095690989207768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1669376, "num_steps_sampled": 464321, "sample_time_ms": 47330.929, "load_time_ms": 6.621, "grad_time_ms": 2237.282, "update_time_ms": 8.879, "learner": {"avProbe": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 12047870.0, "policy_loss": -0.000996227259747684, "vf_loss": 12047870.0, "vf_explained_var": 0.008674845099449158, "kl": 0.000438726507127285, "entropy": 1.001690149307251, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 464321, "episodes_total": 462, "training_iteration": 116, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-46-08", "timestamp": 1684532768, "time_this_iter_s": 50.10588335990906, "time_total_s": 5502.974261522293, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5502.974261522293, "timesteps_since_restore": 464321, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 21.424999999999997, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -280003.19175294635, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -616953.4892468249, "episode_len_mean": 998.4, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123390.69784936497}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.2907230297564, "mean_processing_ms": 4.560711582369102, "mean_inference_ms": 0.809547074212051}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1684736, "num_steps_sampled": 468321, "sample_time_ms": 47242.267, "load_time_ms": 6.257, "grad_time_ms": 2233.205, "update_time_ms": 8.821, "learner": {"avProbe": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 66753124.0, "policy_loss": 0.0010392696131020784, "vf_loss": 66753124.0, "vf_explained_var": 0.000814467144664377, "kl": 0.00024499784922227263, "entropy": 0.9907791018486023, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 468321, "episodes_total": 467, "training_iteration": 117, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-46-58", "timestamp": 1684532818, "time_this_iter_s": 49.189812660217285, "time_total_s": 5552.16407418251, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5552.16407418251, "timesteps_since_restore": 468321, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 28.12571428571429, "ram_util_percent": 17.398571428571437}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -280003.19175294635, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -616953.4892468246, "episode_len_mean": 998.4, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123390.69784936497}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.29072302975638, "mean_processing_ms": 4.560711582369102, "mean_inference_ms": 0.8095470742120509}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1704064, "num_steps_sampled": 472321, "sample_time_ms": 47096.6, "load_time_ms": 5.826, "grad_time_ms": 2276.809, "update_time_ms": 8.896, "learner": {"avProbe": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 136522496.0, "policy_loss": -0.0014966931194067001, "vf_loss": 136522496.0, "vf_explained_var": 0.0005282440106384456, "kl": 0.0029032921884208918, "entropy": 0.9338091015815735, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 472321, "episodes_total": 467, "training_iteration": 118, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-47-42", "timestamp": 1684532862, "time_this_iter_s": 44.343204975128174, "time_total_s": 5596.507279157639, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5596.507279157639, "timesteps_since_restore": 472321, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 30.89365079365079, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -280003.19175294635, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -618469.8988802173, "episode_len_mean": 998.4, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123693.97977604347}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.30905377556687, "mean_processing_ms": 4.562176029345174, "mean_inference_ms": 0.8101747150102322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1714816, "num_steps_sampled": 476321, "sample_time_ms": 47071.922, "load_time_ms": 5.659, "grad_time_ms": 2284.004, "update_time_ms": 8.643, "learner": {"avProbe": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 59928960.0, "policy_loss": -0.002789607970044017, "vf_loss": 59928960.0, "vf_explained_var": 2.8468313757912256e-05, "kl": 0.0017441672971472144, "entropy": 0.9423762559890747, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 476321, "episodes_total": 468, "training_iteration": 119, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-48-33", "timestamp": 1684532913, "time_this_iter_s": 50.637208700180054, "time_total_s": 5647.144487857819, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5647.144487857819, "timesteps_since_restore": 476321, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 34.170833333333334, "ram_util_percent": 17.400000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -614862.4934165612, "episode_len_mean": 1000.0, "episodes_this_iter": 13, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -122972.49868331227}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.74365573608497, "mean_processing_ms": 4.566604144730196, "mean_inference_ms": 0.809843241636236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1721472, "num_steps_sampled": 480321, "sample_time_ms": 46894.317, "load_time_ms": 5.665, "grad_time_ms": 2280.789, "update_time_ms": 8.684, "learner": {"avProbe": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 146419216.0, "policy_loss": -0.001238847034983337, "vf_loss": 146419216.0, "vf_explained_var": 0.00044278227142058313, "kl": 0.0003967797674704343, "entropy": 0.9246267676353455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 480321, "episodes_total": 481, "training_iteration": 120, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-49-24", "timestamp": 1684532964, "time_this_iter_s": 51.27334976196289, "time_total_s": 5698.4178376197815, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7048>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5698.4178376197815, "timesteps_since_restore": 480321, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 36.6027027027027, "ram_util_percent": 17.387837837837843}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -616562.631625247, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123312.52632504943}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.78214689436615, "mean_processing_ms": 4.566204946622432, "mean_inference_ms": 0.8100124116989985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1737344, "num_steps_sampled": 484321, "sample_time_ms": 46847.621, "load_time_ms": 5.64, "grad_time_ms": 2298.189, "update_time_ms": 8.013, "learner": {"avProbe": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 12289110.0, "policy_loss": -0.0003521112084854394, "vf_loss": 12289111.0, "vf_explained_var": 0.00907343253493309, "kl": 0.0018185122171416879, "entropy": 0.9100050330162048, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 484321, "episodes_total": 482, "training_iteration": 121, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-50-14", "timestamp": 1684533014, "time_this_iter_s": 49.83833694458008, "time_total_s": 5748.256174564362, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5748.256174564362, "timesteps_since_restore": 484321, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 21.8943661971831, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -616649.1625964746, "episode_len_mean": 1000.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123329.83251929494}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.9257832296131, "mean_processing_ms": 4.563243435522563, "mean_inference_ms": 0.8100750056485932}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1752704, "num_steps_sampled": 488321, "sample_time_ms": 46852.052, "load_time_ms": 5.714, "grad_time_ms": 2303.159, "update_time_ms": 8.04, "learner": {"avProbe": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 53114440.0, "policy_loss": -0.0012455289252102375, "vf_loss": 53114440.0, "vf_explained_var": 0.0012036055559292436, "kl": 0.00023979652905836701, "entropy": 0.9178293943405151, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 488321, "episodes_total": 487, "training_iteration": 122, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-51-04", "timestamp": 1684533064, "time_this_iter_s": 49.75345730781555, "time_total_s": 5798.009631872177, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5798.009631872177, "timesteps_since_restore": 488321, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 27.812676056338027, "ram_util_percent": 17.398591549295784}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -616649.1625964746, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123329.83251929494}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.9257832296131, "mean_processing_ms": 4.563243435522563, "mean_inference_ms": 0.8100750056485932}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1772032, "num_steps_sampled": 492321, "sample_time_ms": 46841.653, "load_time_ms": 5.261, "grad_time_ms": 2293.77, "update_time_ms": 8.344, "learner": {"avProbe": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 193520320.0, "policy_loss": -0.0011341773206368089, "vf_loss": 193520320.0, "vf_explained_var": 0.0005173726822249591, "kl": 0.00019083758525084704, "entropy": 0.9141203165054321, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 492321, "episodes_total": 487, "training_iteration": 123, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-51-48", "timestamp": 1684533108, "time_this_iter_s": 44.60505247116089, "time_total_s": 5842.614684343338, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5842.614684343338, "timesteps_since_restore": 492321, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.450793650793646, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -612396.607870262, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -122479.32157405242}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.9056250311436, "mean_processing_ms": 4.563668657482107, "mean_inference_ms": 0.8106565350654981}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1782528, "num_steps_sampled": 496321, "sample_time_ms": 46742.65, "load_time_ms": 5.507, "grad_time_ms": 2309.275, "update_time_ms": 8.187, "learner": {"avProbe": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 71889184.0, "policy_loss": 0.00023579742992296815, "vf_loss": 71889184.0, "vf_explained_var": 0.00021799743990413845, "kl": 0.00011320566409267485, "entropy": 0.9027577042579651, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 496321, "episodes_total": 488, "training_iteration": 124, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-52-38", "timestamp": 1684533158, "time_this_iter_s": 49.670063734054565, "time_total_s": 5892.284748077393, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5892.284748077393, "timesteps_since_restore": 496321, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 34.625352112676055, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -617427.1814436264, "episode_len_mean": 1000.0, "episodes_this_iter": 13, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123485.4362887253}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.8588405628867, "mean_processing_ms": 4.555299206006633, "mean_inference_ms": 0.8093882842836557}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1789312, "num_steps_sampled": 500321, "sample_time_ms": 46725.02, "load_time_ms": 5.476, "grad_time_ms": 2316.653, "update_time_ms": 8.197, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 229318224.0, "policy_loss": -0.0005707343807443976, "vf_loss": 229318224.0, "vf_explained_var": 0.0003167492104694247, "kl": 0.00025550101418048143, "entropy": 0.9176042079925537, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 500321, "episodes_total": 501, "training_iteration": 125, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-53-30", "timestamp": 1684533210, "time_this_iter_s": 51.40926218032837, "time_total_s": 5943.694010257721, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5943.694010257721, "timesteps_since_restore": 500321, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 36.89324324324325, "ram_util_percent": 17.390540540540545}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -615774.6018645442, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -789960.7369092399}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -123154.92037290888}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.85691087824193, "mean_processing_ms": 4.5543558371640005, "mean_inference_ms": 0.8094098550389917}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1805184, "num_steps_sampled": 504321, "sample_time_ms": 46685.393, "load_time_ms": 5.388, "grad_time_ms": 2347.266, "update_time_ms": 7.706, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 21121644.0, "policy_loss": -0.00029554939828813076, "vf_loss": 21121644.0, "vf_explained_var": 0.005799077916890383, "kl": 8.213832188630477e-05, "entropy": 0.9224064946174622, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 504321, "episodes_total": 502, "training_iteration": 126, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-54-20", "timestamp": 1684533260, "time_this_iter_s": 50.0118510723114, "time_total_s": 5993.705861330032, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5993.705861330032, "timesteps_since_restore": 504321, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 21.99577464788732, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -613356.0875210718, "episode_len_mean": 1000.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -122671.21750421436}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.7962357194471, "mean_processing_ms": 4.551028406575536, "mean_inference_ms": 0.808684520993357}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1820672, "num_steps_sampled": 508321, "sample_time_ms": 46903.831, "load_time_ms": 5.54, "grad_time_ms": 2376.08, "update_time_ms": 8.162, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 82162152.0, "policy_loss": -0.0005678379093296826, "vf_loss": 82162152.0, "vf_explained_var": 0.0006498359725810587, "kl": 0.0012282835086807609, "entropy": 0.9036197066307068, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 508321, "episodes_total": 507, "training_iteration": 127, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-55-11", "timestamp": 1684533311, "time_this_iter_s": 51.65547013282776, "time_total_s": 6045.36133146286, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6045.36133146286, "timesteps_since_restore": 508321, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 27.22162162162162, "ram_util_percent": 17.440540540540542}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -610451.9300772669, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -122090.3860154534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.7861310766748, "mean_processing_ms": 4.5497030901474185, "mean_inference_ms": 0.8080034091564927}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1840128, "num_steps_sampled": 512321, "sample_time_ms": 47011.932, "load_time_ms": 5.508, "grad_time_ms": 2364.064, "update_time_ms": 8.215, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 137224576.0, "policy_loss": 4.008255564258434e-05, "vf_loss": 137224576.0, "vf_explained_var": 0.0007727507036179304, "kl": 9.982290066545829e-05, "entropy": 0.8913486003875732, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 512321, "episodes_total": 508, "training_iteration": 128, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-55-57", "timestamp": 1684533357, "time_this_iter_s": 45.30819129943848, "time_total_s": 6090.669522762299, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6090.669522762299, "timesteps_since_restore": 512321, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 30.0453125, "ram_util_percent": 17.4046875}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -609639.9102359219, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -121927.98204718439}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.75704985319473, "mean_processing_ms": 4.550015807733876, "mean_inference_ms": 0.8085193571449197}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1851264, "num_steps_sampled": 516321, "sample_time_ms": 46963.163, "load_time_ms": 5.725, "grad_time_ms": 2378.282, "update_time_ms": 8.177, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 67068692.0, "policy_loss": 0.0002642919134814292, "vf_loss": 67068692.0, "vf_explained_var": 0.0004553116741590202, "kl": 0.0005937109235674143, "entropy": 0.8976980447769165, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 516321, "episodes_total": 509, "training_iteration": 129, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-56-47", "timestamp": 1684533407, "time_this_iter_s": 50.28304982185364, "time_total_s": 6140.952572584152, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6140.952572584152, "timesteps_since_restore": 516321, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 33.19444444444444, "ram_util_percent": 17.48888888888889}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -611312.685542356, "episode_len_mean": 995.28, "episodes_this_iter": 12, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -122262.53710847121}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.5821259830944, "mean_processing_ms": 4.543333022215705, "mean_inference_ms": 0.8067108346951656}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1858944, "num_steps_sampled": 520321, "sample_time_ms": 46947.021, "load_time_ms": 5.899, "grad_time_ms": 2397.704, "update_time_ms": 8.153, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 137703248.0, "policy_loss": -0.002048953203484416, "vf_loss": 137703248.0, "vf_explained_var": 0.0005652487161569297, "kl": 0.0004959529615007341, "entropy": 0.8773554563522339, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 520321, "episodes_total": 521, "training_iteration": 130, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-57-38", "timestamp": 1684533458, "time_this_iter_s": 51.30347013473511, "time_total_s": 6192.256042718887, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6192.256042718887, "timesteps_since_restore": 520321, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 36.323287671232876, "ram_util_percent": 17.460273972602746}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -610718.5571016982, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -122143.71142033966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.57527434310535, "mean_processing_ms": 4.542440073680344, "mean_inference_ms": 0.8066322655871901}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1874176, "num_steps_sampled": 524321, "sample_time_ms": 46862.466, "load_time_ms": 5.871, "grad_time_ms": 2380.733, "update_time_ms": 8.438, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 37922680.0, "policy_loss": -0.0006997205782681704, "vf_loss": 37922680.0, "vf_explained_var": 0.003668702905997634, "kl": 0.0007461668574251235, "entropy": 0.9056978225708008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 524321, "episodes_total": 522, "training_iteration": 131, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-58-27", "timestamp": 1684533507, "time_this_iter_s": 48.813528537750244, "time_total_s": 6241.069571256638, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6241.069571256638, "timesteps_since_restore": 524321, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 23.184285714285718, "ram_util_percent": 17.40000000000001}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1386165.0018535282, "episode_reward_mean": -609048.341587702, "episode_len_mean": 995.28, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -121809.66831754042}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.52132934682558, "mean_processing_ms": 4.5392443348123495, "mean_inference_ms": 0.8059791672359619}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1888640, "num_steps_sampled": 528321, "sample_time_ms": 46864.026, "load_time_ms": 5.622, "grad_time_ms": 2350.992, "update_time_ms": 8.348, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 72294584.0, "policy_loss": -0.0011720391921699047, "vf_loss": 72294584.0, "vf_explained_var": 0.0008028676966205239, "kl": 0.0005764514789916575, "entropy": 0.9094536304473877, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 528321, "episodes_total": 527, "training_iteration": 132, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_17-59-17", "timestamp": 1684533557, "time_this_iter_s": 49.46774220466614, "time_total_s": 6290.537313461304, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6290.537313461304, "timesteps_since_restore": 528321, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 28.39154929577464, "ram_util_percent": 17.436619718309867}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -604913.4730947481, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -120982.69461894965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.51111152989168, "mean_processing_ms": 4.538194242632846, "mean_inference_ms": 0.8053033062531934}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1907328, "num_steps_sampled": 532321, "sample_time_ms": 46771.638, "load_time_ms": 5.768, "grad_time_ms": 2361.143, "update_time_ms": 8.181, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 140147712.0, "policy_loss": -0.0008049613679759204, "vf_loss": 140147712.0, "vf_explained_var": 0.000683764461427927, "kl": 0.001920346519909799, "entropy": 0.9397122263908386, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 532321, "episodes_total": 528, "training_iteration": 133, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-00-00", "timestamp": 1684533600, "time_this_iter_s": 43.793625593185425, "time_total_s": 6334.330939054489, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6334.330939054489, "timesteps_since_restore": 532321, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 31.175806451612903, "ram_util_percent": 17.45}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -605456.2237602014, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19680.33531369625}, "policy_reward_mean": {"avProbe": -121091.2447520403}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.4819408784746, "mean_processing_ms": 4.538441831165896, "mean_inference_ms": 0.8058215660120935}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1918592, "num_steps_sampled": 536321, "sample_time_ms": 46785.224, "load_time_ms": 5.701, "grad_time_ms": 2355.361, "update_time_ms": 8.281, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 40319040.0, "policy_loss": 0.0005832277238368988, "vf_loss": 40319040.0, "vf_explained_var": 0.0005197741556912661, "kl": 0.0002484829456079751, "entropy": 0.9337645173072815, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 536321, "episodes_total": 529, "training_iteration": 134, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-00-50", "timestamp": 1684533650, "time_this_iter_s": 49.747896671295166, "time_total_s": 6384.078835725784, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6384.078835725784, "timesteps_since_restore": 536321, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 33.31549295774648, "ram_util_percent": 17.497183098591552}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -600502.113242806, "episode_len_mean": 995.28, "episodes_this_iter": 12, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120100.42264856125}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.31498973319682, "mean_processing_ms": 4.532319039758071, "mean_inference_ms": 0.8042104758145752}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1926272, "num_steps_sampled": 540321, "sample_time_ms": 46721.864, "load_time_ms": 5.778, "grad_time_ms": 2364.954, "update_time_ms": 8.29, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 136558496.0, "policy_loss": -0.000488429213874042, "vf_loss": 136558496.0, "vf_explained_var": 0.0005385944969020784, "kl": 0.000397663185140118, "entropy": 0.9132965207099915, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 540321, "episodes_total": 541, "training_iteration": 135, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-01-41", "timestamp": 1684533701, "time_this_iter_s": 50.87457585334778, "time_total_s": 6434.953411579132, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6434.953411579132, "timesteps_since_restore": 540321, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 36.5068493150685, "ram_util_percent": 17.479452054794525}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -601550.6404533465, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120310.12809066931}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.30810329811447, "mean_processing_ms": 4.531518131311878, "mean_inference_ms": 0.8040965837643738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1941376, "num_steps_sampled": 544321, "sample_time_ms": 46825.385, "load_time_ms": 5.748, "grad_time_ms": 2333.437, "update_time_ms": 8.277, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13566937.0, "policy_loss": -0.0009396116365678608, "vf_loss": 13566937.0, "vf_explained_var": 0.008755993098020554, "kl": 0.0014109339099377394, "entropy": 0.884533166885376, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 544321, "episodes_total": 542, "training_iteration": 136, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-02-32", "timestamp": 1684533752, "time_this_iter_s": 50.73262619972229, "time_total_s": 6485.686037778854, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6485.686037778854, "timesteps_since_restore": 544321, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 22.445833333333333, "ram_util_percent": 17.47638888888889}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -603797.4152173582, "episode_len_mean": 995.28, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120759.48304347161}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.25891876513157, "mean_processing_ms": 4.528525901120256, "mean_inference_ms": 0.8034691814822488}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1955840, "num_steps_sampled": 548321, "sample_time_ms": 46852.924, "load_time_ms": 5.771, "grad_time_ms": 2289.132, "update_time_ms": 8.187, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 63856552.0, "policy_loss": -0.0009020913857966661, "vf_loss": 63856552.0, "vf_explained_var": 0.0011049777967855334, "kl": 0.00034455928835086524, "entropy": 0.8915172815322876, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 548321, "episodes_total": 547, "training_iteration": 137, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-03-23", "timestamp": 1684533803, "time_this_iter_s": 51.489609718322754, "time_total_s": 6537.175647497177, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6537.175647497177, "timesteps_since_restore": 548321, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 27.50945945945946, "ram_util_percent": 17.483783783783785}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -601755.5237021354, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120351.1047404271}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.2488509951121, "mean_processing_ms": 4.527617098960246, "mean_inference_ms": 0.8028071164173847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1974528, "num_steps_sampled": 552321, "sample_time_ms": 46810.796, "load_time_ms": 5.715, "grad_time_ms": 2249.995, "update_time_ms": 8.103, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 183460576.0, "policy_loss": -0.0006753483903594315, "vf_loss": 183460576.0, "vf_explained_var": 0.0006561822374351323, "kl": 0.001621224102564156, "entropy": 0.8986314535140991, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 552321, "episodes_total": 548, "training_iteration": 138, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-04-08", "timestamp": 1684533848, "time_this_iter_s": 44.49927115440369, "time_total_s": 6581.674918651581, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6581.674918651581, "timesteps_since_restore": 552321, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 30.831746031746032, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -603846.4438053479, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120769.28876106959}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.22047546503654, "mean_processing_ms": 4.5277724304217575, "mean_inference_ms": 0.8033308683376963}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1985664, "num_steps_sampled": 556321, "sample_time_ms": 46914.591, "load_time_ms": 5.704, "grad_time_ms": 2243.06, "update_time_ms": 8.275, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 60033300.0, "policy_loss": -0.0007161390385590494, "vf_loss": 60033300.0, "vf_explained_var": 0.0005085447919555008, "kl": 0.0007310907240025699, "entropy": 0.8956950306892395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 556321, "episodes_total": 549, "training_iteration": 139, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-04-59", "timestamp": 1684533899, "time_this_iter_s": 51.256906032562256, "time_total_s": 6632.931824684143, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6632.931824684143, "timesteps_since_restore": 556321, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 32.66849315068493, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -607230.5799505957, "episode_len_mean": 995.28, "episodes_this_iter": 12, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -121446.11599011917}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.06205287182908, "mean_processing_ms": 4.521840699423813, "mean_inference_ms": 0.8017281332528988}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1993344, "num_steps_sampled": 560321, "sample_time_ms": 46849.507, "load_time_ms": 5.548, "grad_time_ms": 2237.769, "update_time_ms": 8.369, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 113932144.0, "policy_loss": 0.0004795143904630095, "vf_loss": 113932144.0, "vf_explained_var": 0.0006047834758646786, "kl": 2.4693117666174658e-05, "entropy": 0.8982053995132446, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 560321, "episodes_total": 561, "training_iteration": 140, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-05-50", "timestamp": 1684533950, "time_this_iter_s": 50.595723390579224, "time_total_s": 6683.527548074722, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7620>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6683.527548074722, "timesteps_since_restore": 560321, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 36.449999999999996, "ram_util_percent": 17.481944444444448}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -606172.3984184591, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -121234.47968369182}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.05443036370693, "mean_processing_ms": 4.521104043113552, "mean_inference_ms": 0.8016187429235326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2008704, "num_steps_sampled": 564321, "sample_time_ms": 46872.352, "load_time_ms": 5.679, "grad_time_ms": 2248.097, "update_time_ms": 8.12, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 21168280.0, "policy_loss": -0.0013027397217229009, "vf_loss": 21168280.0, "vf_explained_var": 0.0064958324655890465, "kl": 0.0014571405481547117, "entropy": 0.8778941035270691, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 564321, "episodes_total": 562, "training_iteration": 141, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-06-39", "timestamp": 1684533999, "time_this_iter_s": 49.146464824676514, "time_total_s": 6732.674012899399, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6732.674012899399, "timesteps_since_restore": 564321, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 22.85211267605634, "ram_util_percent": 17.488732394366203}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -606543.0778816602, "episode_len_mean": 995.28, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -121308.61557633203}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 164.0069948248236, "mean_processing_ms": 4.518225662087709, "mean_inference_ms": 0.8010683981251319}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2023168, "num_steps_sampled": 568321, "sample_time_ms": 46912.076, "load_time_ms": 5.81, "grad_time_ms": 2259.261, "update_time_ms": 8.072, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 84568816.0, "policy_loss": -0.00042221054900437593, "vf_loss": 84568816.0, "vf_explained_var": 0.0007464890950359404, "kl": 0.0008383007370866835, "entropy": 0.8471716046333313, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 568321, "episodes_total": 567, "training_iteration": 142, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-07-29", "timestamp": 1684534049, "time_this_iter_s": 49.97292876243591, "time_total_s": 6782.646941661835, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6782.646941661835, "timesteps_since_restore": 568321, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 28.521126760563384, "ram_util_percent": 17.490140845070425}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -604275.2286024819, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120855.04572049639}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.99762444485984, "mean_processing_ms": 4.51745717023555, "mean_inference_ms": 0.80042093783286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2041856, "num_steps_sampled": 572321, "sample_time_ms": 46990.053, "load_time_ms": 5.935, "grad_time_ms": 2239.482, "update_time_ms": 7.954, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 104381128.0, "policy_loss": -0.0002689854591153562, "vf_loss": 104381128.0, "vf_explained_var": 0.0009830602211877704, "kl": 0.0014003770193085074, "entropy": 0.8072667717933655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 572321, "episodes_total": 568, "training_iteration": 143, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-08-13", "timestamp": 1684534093, "time_this_iter_s": 44.37353515625, "time_total_s": 6827.020476818085, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6827.020476818085, "timesteps_since_restore": 572321, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.815873015873013, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -167287.58594133618, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -604198.3846434291, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120839.67692868585}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.97064100028484, "mean_processing_ms": 4.517501964505455, "mean_inference_ms": 0.8009699891657324}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2053120, "num_steps_sampled": 576321, "sample_time_ms": 47017.845, "load_time_ms": 6.058, "grad_time_ms": 2232.201, "update_time_ms": 7.95, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 48636620.0, "policy_loss": -0.0009018303244374692, "vf_loss": 48636620.0, "vf_explained_var": 0.0007104894029907882, "kl": 0.001532728667370975, "entropy": 0.8331985473632812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 576321, "episodes_total": 569, "training_iteration": 144, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-09-03", "timestamp": 1684534143, "time_this_iter_s": 49.95217323303223, "time_total_s": 6876.972650051117, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6876.972650051117, "timesteps_since_restore": 576321, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 33.106944444444444, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -601979.6026006611, "episode_len_mean": 995.28, "episodes_this_iter": 12, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120395.92052013222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.82405337537423, "mean_processing_ms": 4.511861855125663, "mean_inference_ms": 0.799477408820893}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2060928, "num_steps_sampled": 580321, "sample_time_ms": 47196.176, "load_time_ms": 6.083, "grad_time_ms": 2232.015, "update_time_ms": 8.061, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 134800960.0, "policy_loss": 0.00028010591631755233, "vf_loss": 134800960.0, "vf_explained_var": 0.0002933896903414279, "kl": 0.00010392275726189837, "entropy": 0.8336370587348938, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 580321, "episodes_total": 581, "training_iteration": 145, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-09-56", "timestamp": 1684534196, "time_this_iter_s": 52.65304636955261, "time_total_s": 6929.62569642067, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6929.62569642067, "timesteps_since_restore": 580321, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 35.525333333333336, "ram_util_percent": 17.485333333333333}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -598170.1082685986, "episode_len_mean": 995.28, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -119634.0216537197}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.81759776658183, "mean_processing_ms": 4.511178886917857, "mean_inference_ms": 0.7993963290138447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2076416, "num_steps_sampled": 584321, "sample_time_ms": 47206.39, "load_time_ms": 5.933, "grad_time_ms": 2238.017, "update_time_ms": 8.47, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 31927654.0, "policy_loss": -0.0007144719129428267, "vf_loss": 31927654.0, "vf_explained_var": 0.004311424680054188, "kl": 0.00047533540055155754, "entropy": 0.8241783976554871, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 584321, "episodes_total": 582, "training_iteration": 146, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-10-47", "timestamp": 1684534247, "time_this_iter_s": 50.89595293998718, "time_total_s": 6980.521649360657, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6980.521649360657, "timesteps_since_restore": 584321, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 22.530555555555555, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -594379.9128396201, "episode_len_mean": 993.67, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -118875.982567924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.76355441018862, "mean_processing_ms": 4.5086780790342775, "mean_inference_ms": 0.7989108014787786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2091648, "num_steps_sampled": 588321, "sample_time_ms": 46981.399, "load_time_ms": 6.092, "grad_time_ms": 2258.836, "update_time_ms": 8.447, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 64151380.0, "policy_loss": -0.0006540604517795146, "vf_loss": 64151380.0, "vf_explained_var": 0.0013878390891477466, "kl": 0.0013713104417547584, "entropy": 0.7879816293716431, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 588321, "episodes_total": 587, "training_iteration": 147, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-11-37", "timestamp": 1684534297, "time_this_iter_s": 49.44889521598816, "time_total_s": 7029.970544576645, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7029.970544576645, "timesteps_since_restore": 588321, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 27.440845070422533, "ram_util_percent": 17.495774647887323}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -600505.6777175423, "episode_len_mean": 993.67, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -120101.13554350844}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.7556581876485, "mean_processing_ms": 4.508035534510973, "mean_inference_ms": 0.7982805625173822}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2110720, "num_steps_sampled": 592321, "sample_time_ms": 46924.004, "load_time_ms": 6.19, "grad_time_ms": 2261.218, "update_time_ms": 8.478, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 132519208.0, "policy_loss": -2.5877016014419496e-05, "vf_loss": 132519208.0, "vf_explained_var": 0.0007606600993312895, "kl": 6.530411337735131e-05, "entropy": 0.7780007719993591, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 592321, "episodes_total": 588, "training_iteration": 148, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-12-21", "timestamp": 1684534341, "time_this_iter_s": 43.945921421051025, "time_total_s": 7073.916465997696, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7073.916465997696, "timesteps_since_restore": 592321, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 31.220634920634925, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -598678.5808130656, "episode_len_mean": 993.67, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -119735.7161626131}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.72859913550462, "mean_processing_ms": 4.508000648287423, "mean_inference_ms": 0.7988691352946431}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2121984, "num_steps_sampled": 596321, "sample_time_ms": 46796.505, "load_time_ms": 6.194, "grad_time_ms": 2258.206, "update_time_ms": 8.389, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 65730904.0, "policy_loss": -0.0016681320266798139, "vf_loss": 65730904.0, "vf_explained_var": 0.0004497441404964775, "kl": 0.00026695310953073204, "entropy": 0.7939998507499695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 596321, "episodes_total": 589, "training_iteration": 149, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-13-11", "timestamp": 1684534391, "time_this_iter_s": 49.95330595970154, "time_total_s": 7123.8697719573975, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7123.8697719573975, "timesteps_since_restore": 596321, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 33.99859154929577, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -588586.5060964503, "episode_len_mean": 993.67, "episodes_this_iter": 12, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -117717.30121929002}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.5945109969615, "mean_processing_ms": 4.502775719240871, "mean_inference_ms": 0.7975350336651319}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2129280, "num_steps_sampled": 600321, "sample_time_ms": 46872.356, "load_time_ms": 6.138, "grad_time_ms": 2258.003, "update_time_ms": 8.363, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 95204640.0, "policy_loss": -0.0009152612183243036, "vf_loss": 95204640.0, "vf_explained_var": 0.0007318707648664713, "kl": 0.0009937257273122668, "entropy": 0.7798293232917786, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 600321, "episodes_total": 601, "training_iteration": 150, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-14-02", "timestamp": 1684534442, "time_this_iter_s": 51.35760521888733, "time_total_s": 7175.227377176285, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7175.227377176285, "timesteps_since_restore": 600321, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 36.64246575342466, "ram_util_percent": 17.48904109589041}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1238434.2672229724, "episode_reward_mean": -588797.0543890111, "episode_len_mean": 993.67, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -898377.5550368432}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -117759.41087780222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.57567939057412, "mean_processing_ms": 4.501871449173426, "mean_inference_ms": 0.7974054419767762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2144128, "num_steps_sampled": 604343, "sample_time_ms": 47456.638, "load_time_ms": 6.067, "grad_time_ms": 2231.483, "update_time_ms": 8.346, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 19414782.0, "policy_loss": -0.0014680505264550447, "vf_loss": 19414782.0, "vf_explained_var": 0.006522501818835735, "kl": 0.0004944041138514876, "entropy": 0.7845529913902283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4022, "done": false, "timesteps_total": 604343, "episodes_total": 603, "training_iteration": 151, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-14-57", "timestamp": 1684534497, "time_this_iter_s": 54.72013235092163, "time_total_s": 7229.947509527206, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7229.947509527206, "timesteps_since_restore": 604343, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 21.37564102564103, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -244399.86021485817, "episode_reward_min": -1047463.1909555384, "episode_reward_mean": -584010.4892681763, "episode_len_mean": 993.67, "episodes_this_iter": 4, "policy_reward_min": {"avProbe": -668630.6662990722}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -116802.09785363523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.54022050966017, "mean_processing_ms": 4.50000023946971, "mean_inference_ms": 0.7968663803717725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2159488, "num_steps_sampled": 608343, "sample_time_ms": 47494.165, "load_time_ms": 5.775, "grad_time_ms": 2234.906, "update_time_ms": 8.183, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 119445608.0, "policy_loss": -0.00011562953295651823, "vf_loss": 119445608.0, "vf_explained_var": 0.0009138837340287864, "kl": 0.0006673627649433911, "entropy": 0.7671095132827759, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 608343, "episodes_total": 607, "training_iteration": 152, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-15-47", "timestamp": 1684534547, "time_this_iter_s": 50.37567090988159, "time_total_s": 7280.323180437088, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7280.323180437088, "timesteps_since_restore": 608343, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 26.975, "ram_util_percent": 17.498611111111114}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -266660.584375622, "episode_reward_min": -1047463.1909555384, "episode_reward_mean": -586140.18405181, "episode_len_mean": 998.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -668630.6662990722}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -117228.03681036197}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.52941800963814, "mean_processing_ms": 4.4995533254069295, "mean_inference_ms": 0.7967912433649456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2178304, "num_steps_sampled": 612343, "sample_time_ms": 47466.247, "load_time_ms": 5.545, "grad_time_ms": 2231.988, "update_time_ms": 8.316, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 161531472.0, "policy_loss": -3.054876287933439e-05, "vf_loss": 161531472.0, "vf_explained_var": 0.0006248379359021783, "kl": 0.00037946648080833256, "entropy": 0.7436768412590027, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 612343, "episodes_total": 608, "training_iteration": 153, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-16-31", "timestamp": 1684534591, "time_this_iter_s": 44.05584406852722, "time_total_s": 7324.379024505615, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7324.379024505615, "timesteps_since_restore": 612343, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.392063492063492, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -266660.584375622, "episode_reward_min": -1047463.1909555384, "episode_reward_mean": -584457.9685191284, "episode_len_mean": 998.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -668630.6662990722}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -116891.59370382564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.5183536806124, "mean_processing_ms": 4.498660641112384, "mean_inference_ms": 0.7967068383593572}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2189696, "num_steps_sampled": 616343, "sample_time_ms": 47446.246, "load_time_ms": 5.336, "grad_time_ms": 2238.242, "update_time_ms": 8.344, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 98021424.0, "policy_loss": -0.0012079455191269517, "vf_loss": 98021424.0, "vf_explained_var": 0.0003517263394314796, "kl": 0.00119163584895432, "entropy": 0.7702538371086121, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 616343, "episodes_total": 609, "training_iteration": 154, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-17-21", "timestamp": 1684534641, "time_this_iter_s": 49.81645059585571, "time_total_s": 7374.195475101471, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7374.195475101471, "timesteps_since_restore": 616343, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 33.676056338028175, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1159166.717919365, "episode_reward_mean": -581614.2305160532, "episode_len_mean": 998.39, "episodes_this_iter": 12, "policy_reward_min": {"avProbe": -718767.727292002}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -116322.84610321061}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.39399846435674, "mean_processing_ms": 4.494063145146528, "mean_inference_ms": 0.7955179785739531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2196736, "num_steps_sampled": 620343, "sample_time_ms": 47274.92, "load_time_ms": 5.323, "grad_time_ms": 2230.477, "update_time_ms": 8.498, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 175624864.0, "policy_loss": -0.002238112036138773, "vf_loss": 175624864.0, "vf_explained_var": 0.00048309890553355217, "kl": 0.0006735543720424175, "entropy": 0.7552664875984192, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 620343, "episodes_total": 621, "training_iteration": 155, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-18-12", "timestamp": 1684534692, "time_this_iter_s": 50.86600422859192, "time_total_s": 7425.061479330063, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7425.061479330063, "timesteps_since_restore": 620343, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 36.46849315068493, "ram_util_percent": 17.49178082191781}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1308472.628758342, "episode_reward_mean": -588909.4234772846, "episode_len_mean": 998.39, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -748962.0450073846}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -117781.88469545692}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.3766038843, "mean_processing_ms": 4.493233347931816, "mean_inference_ms": 0.7954259977411069}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2211712, "num_steps_sampled": 624343, "sample_time_ms": 47156.952, "load_time_ms": 5.317, "grad_time_ms": 2216.517, "update_time_ms": 8.255, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 29770480.0, "policy_loss": 0.00017874108743853867, "vf_loss": 29770480.0, "vf_explained_var": 0.005309601314365864, "kl": 0.0001466593676013872, "entropy": 0.7527415156364441, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 624343, "episodes_total": 623, "training_iteration": 156, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-19-02", "timestamp": 1684534742, "time_this_iter_s": 49.57772946357727, "time_total_s": 7474.63920879364, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7474.63920879364, "timesteps_since_restore": 624343, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 23.232857142857146, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1308472.628758342, "episode_reward_mean": -583496.4793438575, "episode_len_mean": 992.39, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -748962.0450073846}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -116699.29586877153}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.33484211695156, "mean_processing_ms": 4.491480351937507, "mean_inference_ms": 0.7951228331666552}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2227072, "num_steps_sampled": 628343, "sample_time_ms": 47161.092, "load_time_ms": 5.312, "grad_time_ms": 2212.035, "update_time_ms": 8.248, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 59661800.0, "policy_loss": 0.00010422890045447275, "vf_loss": 59661800.0, "vf_explained_var": 0.0014706418151035905, "kl": 0.00034372942172922194, "entropy": 0.7510360479354858, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 628343, "episodes_total": 628, "training_iteration": 157, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-19-51", "timestamp": 1684534791, "time_this_iter_s": 49.45174741744995, "time_total_s": 7524.09095621109, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7524.09095621109, "timesteps_since_restore": 628343, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 27.242253521126763, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1308472.628758342, "episode_reward_mean": -583713.8432825301, "episode_len_mean": 992.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -748962.0450073846}, "policy_reward_max": {"avProbe": 19682.513240712742}, "policy_reward_mean": {"avProbe": -116742.76865650603}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.32880433761704, "mean_processing_ms": 4.491056372738786, "mean_inference_ms": 0.7944739447080852}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2245760, "num_steps_sampled": 632343, "sample_time_ms": 47239.708, "load_time_ms": 5.843, "grad_time_ms": 2215.646, "update_time_ms": 7.992, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 149642000.0, "policy_loss": -0.0007060854113660753, "vf_loss": 149642000.0, "vf_explained_var": 0.0007675061351619661, "kl": 0.002079212572425604, "entropy": 0.7652646899223328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 632343, "episodes_total": 629, "training_iteration": 158, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-20-36", "timestamp": 1684534836, "time_this_iter_s": 44.7658269405365, "time_total_s": 7568.856783151627, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7568.856783151627, "timesteps_since_restore": 632343, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 29.821875, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1308472.628758342, "episode_reward_mean": -581909.0801830393, "episode_len_mean": 992.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -748962.0450073846}, "policy_reward_max": {"avProbe": 19682.143530518148}, "policy_reward_mean": {"avProbe": -116381.81603660785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.29707494892205, "mean_processing_ms": 4.490355597678259, "mean_inference_ms": 0.7948491054487977}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2257792, "num_steps_sampled": 636343, "sample_time_ms": 47205.243, "load_time_ms": 5.838, "grad_time_ms": 2232.041, "update_time_ms": 8.139, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 151787280.0, "policy_loss": -0.0008211891981773078, "vf_loss": 151787280.0, "vf_explained_var": 0.0002792325394693762, "kl": 0.0015887223416939378, "entropy": 0.7735104560852051, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 636343, "episodes_total": 630, "training_iteration": 159, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-21-26", "timestamp": 1684534886, "time_this_iter_s": 49.767974615097046, "time_total_s": 7618.624757766724, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7618.624757766724, "timesteps_since_restore": 636343, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 33.20422535211268, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1308472.628758342, "episode_reward_mean": -577371.257635082, "episode_len_mean": 992.39, "episodes_this_iter": 11, "policy_reward_min": {"avProbe": -748962.0450073846}, "policy_reward_max": {"avProbe": 19682.143530518148}, "policy_reward_mean": {"avProbe": -115474.25152701637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.19882819186395, "mean_processing_ms": 4.486517369972024, "mean_inference_ms": 0.7936748037302062}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2265984, "num_steps_sampled": 640343, "sample_time_ms": 47101.437, "load_time_ms": 5.953, "grad_time_ms": 2240.468, "update_time_ms": 7.802, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 115788816.0, "policy_loss": 2.9802322387695312e-06, "vf_loss": 115788816.0, "vf_explained_var": 0.0005843276157975197, "kl": 0.0006640675128437579, "entropy": 0.7568433284759521, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 640343, "episodes_total": 641, "training_iteration": 160, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-22-16", "timestamp": 1684534936, "time_this_iter_s": 50.408036947250366, "time_total_s": 7669.032794713974, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af77b8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7669.032794713974, "timesteps_since_restore": 640343, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 36.49305555555556, "ram_util_percent": 17.493055555555557}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -592669.4944944854, "episode_len_mean": 992.39, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19682.143530518148}, "policy_reward_mean": {"avProbe": -118533.89889889702}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.18050391402016, "mean_processing_ms": 4.485754607859416, "mean_inference_ms": 0.7936134045865547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2280448, "num_steps_sampled": 644343, "sample_time_ms": 46570.31, "load_time_ms": 6.083, "grad_time_ms": 2237.338, "update_time_ms": 7.595, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 18689108.0, "policy_loss": -0.0013423081254586577, "vf_loss": 18689108.0, "vf_explained_var": 0.007198398932814598, "kl": 0.000986889936029911, "entropy": 0.7928683757781982, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 644343, "episodes_total": 643, "training_iteration": 161, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-23-05", "timestamp": 1684534985, "time_this_iter_s": 49.38316011428833, "time_total_s": 7718.415954828262, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7718.415954828262, "timesteps_since_restore": 644343, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 24.378571428571433, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -589783.1704685395, "episode_len_mean": 992.39, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19682.143530518148}, "policy_reward_mean": {"avProbe": -117956.63409370783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.14124376419943, "mean_processing_ms": 4.484114123870028, "mean_inference_ms": 0.7934110238306221}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2294784, "num_steps_sampled": 648343, "sample_time_ms": 46499.184, "load_time_ms": 6.243, "grad_time_ms": 2220.727, "update_time_ms": 7.801, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 62924460.0, "policy_loss": -0.0005332657019607723, "vf_loss": 62924460.0, "vf_explained_var": 0.00150885374750942, "kl": 0.00022749489289708436, "entropy": 0.805553138256073, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 648343, "episodes_total": 648, "training_iteration": 162, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-23-55", "timestamp": 1684535035, "time_this_iter_s": 49.51161336898804, "time_total_s": 7767.92756819725, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7767.92756819725, "timesteps_since_restore": 648343, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 27.93661971830986, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -588435.0627546125, "episode_len_mean": 992.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19682.143530518148}, "policy_reward_mean": {"avProbe": -117687.0125509225}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.13489300627586, "mean_processing_ms": 4.48378917292481, "mean_inference_ms": 0.7927825596036768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2313472, "num_steps_sampled": 652343, "sample_time_ms": 46577.481, "load_time_ms": 6.385, "grad_time_ms": 2225.504, "update_time_ms": 7.839, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 94920208.0, "policy_loss": -2.938019133580383e-05, "vf_loss": 94920208.0, "vf_explained_var": 0.0011599936988204718, "kl": 8.17499021650292e-05, "entropy": 0.8044843077659607, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 652343, "episodes_total": 649, "training_iteration": 163, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-24-40", "timestamp": 1684535080, "time_this_iter_s": 44.89074230194092, "time_total_s": 7812.818310499191, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7812.818310499191, "timesteps_since_restore": 652343, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 29.9125, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -588414.7017093765, "episode_len_mean": 992.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19682.143530518148}, "policy_reward_mean": {"avProbe": -117682.94034187529}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.10456707695985, "mean_processing_ms": 4.483021998632119, "mean_inference_ms": 0.7931686172341075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2325248, "num_steps_sampled": 656343, "sample_time_ms": 46646.672, "load_time_ms": 6.571, "grad_time_ms": 2229.914, "update_time_ms": 7.68, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 62697460.0, "policy_loss": -0.0020735044963657856, "vf_loss": 62697460.0, "vf_explained_var": 0.0006786533049307764, "kl": 0.0013390538515523076, "entropy": 0.8386454582214355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 656343, "episodes_total": 650, "training_iteration": 164, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-25-31", "timestamp": 1684535131, "time_this_iter_s": 50.551695823669434, "time_total_s": 7863.370006322861, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7863.370006322861, "timesteps_since_restore": 656343, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 32.766666666666666, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -578515.7988609392, "episode_len_mean": 992.39, "episodes_this_iter": 11, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115703.1597721878}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 163.01499899368272, "mean_processing_ms": 4.479481204286139, "mean_inference_ms": 0.7921326073058029}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2333312, "num_steps_sampled": 660343, "sample_time_ms": 46672.769, "load_time_ms": 6.701, "grad_time_ms": 2240.805, "update_time_ms": 7.252, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 115203528.0, "policy_loss": -0.0007277451804839075, "vf_loss": 115203528.0, "vf_explained_var": 0.0006271042511798441, "kl": 3.5300930903758854e-05, "entropy": 0.8367524743080139, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 660343, "episodes_total": 661, "training_iteration": 165, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-26-22", "timestamp": 1684535182, "time_this_iter_s": 51.235384941101074, "time_total_s": 7914.605391263962, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7914.605391263962, "timesteps_since_restore": 660343, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 36.291780821917804, "ram_util_percent": 17.502739726027396}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -575466.3214919711, "episode_len_mean": 992.39, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115093.26429839418}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.99838127771244, "mean_processing_ms": 4.47876415728884, "mean_inference_ms": 0.7920629493112301}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2347776, "num_steps_sampled": 664343, "sample_time_ms": 46692.733, "load_time_ms": 6.853, "grad_time_ms": 2240.055, "update_time_ms": 7.4, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 26110084.0, "policy_loss": -0.0010709769558161497, "vf_loss": 26110086.0, "vf_explained_var": 0.0061118947342038155, "kl": 0.0016386789502575994, "entropy": 0.8125731945037842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 664343, "episodes_total": 663, "training_iteration": 166, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-27-12", "timestamp": 1684535232, "time_this_iter_s": 49.76918268203735, "time_total_s": 7964.374573945999, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7964.374573945999, "timesteps_since_restore": 664343, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 24.166197183098593, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -576459.4572745932, "episode_len_mean": 992.39, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115291.89145491854}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.96447578119012, "mean_processing_ms": 4.47721237437835, "mean_inference_ms": 0.7918986326626437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2362112, "num_steps_sampled": 668343, "sample_time_ms": 46777.608, "load_time_ms": 6.699, "grad_time_ms": 2226.909, "update_time_ms": 7.252, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 65384988.0, "policy_loss": 0.0010912424186244607, "vf_loss": 65384988.0, "vf_explained_var": 0.0014465360436588526, "kl": 0.00041569332825019956, "entropy": 0.8034796118736267, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 668343, "episodes_total": 668, "training_iteration": 167, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-28-02", "timestamp": 1684535282, "time_this_iter_s": 50.15861439704895, "time_total_s": 8014.533188343048, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8014.533188343048, "timesteps_since_restore": 668343, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 27.729166666666668, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -574760.5984010871, "episode_len_mean": 992.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -114952.11968021735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.95804754959255, "mean_processing_ms": 4.476990845673747, "mean_inference_ms": 0.791265230744937}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2380672, "num_steps_sampled": 672343, "sample_time_ms": 46728.423, "load_time_ms": 6.198, "grad_time_ms": 2216.387, "update_time_ms": 7.238, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 139026832.0, "policy_loss": -0.0004892682190984488, "vf_loss": 139026832.0, "vf_explained_var": 0.0008634082041680813, "kl": 0.0016066242242231965, "entropy": 0.8302554488182068, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 672343, "episodes_total": 669, "training_iteration": 168, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-28-46", "timestamp": 1684535326, "time_this_iter_s": 44.16785526275635, "time_total_s": 8058.701043605804, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8058.701043605804, "timesteps_since_restore": 672343, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 30.446031746031746, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -575867.8996314078, "episode_len_mean": 992.39, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115173.57992628151}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.92883115540832, "mean_processing_ms": 4.476170407968527, "mean_inference_ms": 0.7916518313401342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2392832, "num_steps_sampled": 676343, "sample_time_ms": 46784.154, "load_time_ms": 6.192, "grad_time_ms": 2210.108, "update_time_ms": 7.135, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 53684456.0, "policy_loss": -0.0005308144027367234, "vf_loss": 53684456.0, "vf_explained_var": 0.0007979738293215632, "kl": 0.00015662268560845405, "entropy": 0.8324756026268005, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 676343, "episodes_total": 670, "training_iteration": 169, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-29-36", "timestamp": 1684535376, "time_this_iter_s": 50.26637864112854, "time_total_s": 8108.967422246933, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8108.967422246933, "timesteps_since_restore": 676343, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 32.83611111111111, "ram_util_percent": 17.575000000000003}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -575661.2588319506, "episode_len_mean": 992.39, "episodes_this_iter": 11, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115132.25176639005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.84540048847705, "mean_processing_ms": 4.47262550674916, "mean_inference_ms": 0.7907982255026509}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2401024, "num_steps_sampled": 680343, "sample_time_ms": 46891.11, "load_time_ms": 6.228, "grad_time_ms": 2208.448, "update_time_ms": 7.406, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 93137760.0, "policy_loss": 7.701665163040161e-05, "vf_loss": 93137760.0, "vf_explained_var": 0.0007722293958067894, "kl": 0.0002686047228053212, "entropy": 0.8330235481262207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 680343, "episodes_total": 681, "training_iteration": 170, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-30-28", "timestamp": 1684535428, "time_this_iter_s": 51.4555082321167, "time_total_s": 8160.42293047905, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8160.42293047905, "timesteps_since_restore": 680343, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 35.97260273972603, "ram_util_percent": 17.57808219178082}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -583604.5712783586, "episode_len_mean": 994.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -116720.91425567167}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.83660512703872, "mean_processing_ms": 4.471762305324387, "mean_inference_ms": 0.7906685474382844}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2415616, "num_steps_sampled": 684343, "sample_time_ms": 46841.544, "load_time_ms": 5.88, "grad_time_ms": 2211.087, "update_time_ms": 7.529, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 25387664.0, "policy_loss": -0.002333207055926323, "vf_loss": 25387664.0, "vf_explained_var": 0.00702324416488409, "kl": 0.001184876193292439, "entropy": 0.8700323104858398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 684343, "episodes_total": 683, "training_iteration": 171, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-31-17", "timestamp": 1684535477, "time_this_iter_s": 48.90604519844055, "time_total_s": 8209.32897567749, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8209.32897567749, "timesteps_since_restore": 684343, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 24.31285714285714, "ram_util_percent": 17.5}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -577524.4913426499, "episode_len_mean": 994.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115504.89826852993}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.80411727964844, "mean_processing_ms": 4.470293643270868, "mean_inference_ms": 0.79049623241044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2429952, "num_steps_sampled": 688343, "sample_time_ms": 46879.976, "load_time_ms": 6.039, "grad_time_ms": 2228.078, "update_time_ms": 7.598, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 95670344.0, "policy_loss": -0.001087879529222846, "vf_loss": 95670344.0, "vf_explained_var": 0.0013871416449546814, "kl": 0.001920517417602241, "entropy": 0.8555231690406799, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 688343, "episodes_total": 688, "training_iteration": 172, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-32-07", "timestamp": 1684535527, "time_this_iter_s": 50.05900692939758, "time_total_s": 8259.387982606888, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8259.387982606888, "timesteps_since_restore": 688343, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 27.93239436619718, "ram_util_percent": 17.523943661971828}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -578443.214926823, "episode_len_mean": 994.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115688.64298536455}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.7984028374545, "mean_processing_ms": 4.470191251059211, "mean_inference_ms": 0.7898372659893701}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2448640, "num_steps_sampled": 692343, "sample_time_ms": 46802.152, "load_time_ms": 6.198, "grad_time_ms": 2230.317, "update_time_ms": 7.328, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 117805560.0, "policy_loss": 8.509828330716118e-05, "vf_loss": 117805560.0, "vf_explained_var": 0.0013280478306114674, "kl": 1.2819594303437043e-05, "entropy": 0.8523266911506653, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 692343, "episodes_total": 689, "training_iteration": 173, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-32-51", "timestamp": 1684535571, "time_this_iter_s": 44.12774682044983, "time_total_s": 8303.515729427338, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8303.515729427338, "timesteps_since_restore": 692343, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 30.247619047619047, "ram_util_percent": 17.530158730158725}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -581168.5989538416, "episode_len_mean": 994.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -116233.71979076827}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.7689260971689, "mean_processing_ms": 4.469351738256489, "mean_inference_ms": 0.7902200260312126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2460288, "num_steps_sampled": 696343, "sample_time_ms": 46725.562, "load_time_ms": 5.907, "grad_time_ms": 2232.235, "update_time_ms": 7.204, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 84654640.0, "policy_loss": 0.000695814611390233, "vf_loss": 84654640.0, "vf_explained_var": 0.0006407453329302371, "kl": 0.00014030734018888324, "entropy": 0.8585801720619202, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 696343, "episodes_total": 690, "training_iteration": 174, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-33-41", "timestamp": 1684535621, "time_this_iter_s": 49.798728942871094, "time_total_s": 8353.314458370209, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8353.314458370209, "timesteps_since_restore": 696343, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 33.257746478873244, "ram_util_percent": 17.595774647887314}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -580463.8310568637, "episode_len_mean": 994.0, "episodes_this_iter": 11, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -116092.7662113727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.68900837729205, "mean_processing_ms": 4.465813580971122, "mean_inference_ms": 0.789373005485813}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2468608, "num_steps_sampled": 700343, "sample_time_ms": 46745.811, "load_time_ms": 5.853, "grad_time_ms": 2252.725, "update_time_ms": 7.599, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 220049936.0, "policy_loss": -0.0013276154641062021, "vf_loss": 220049936.0, "vf_explained_var": 0.00047574867494404316, "kl": 0.000158901049871929, "entropy": 0.8703066110610962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 700343, "episodes_total": 701, "training_iteration": 175, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-34-32", "timestamp": 1684535672, "time_this_iter_s": 51.647159576416016, "time_total_s": 8404.961617946625, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8404.961617946625, "timesteps_since_restore": 700343, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 35.74864864864865, "ram_util_percent": 17.58243243243243}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -587851.6450772324, "episode_len_mean": 994.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -117570.32901544643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.67544424128948, "mean_processing_ms": 4.464808270309246, "mean_inference_ms": 0.7892804731211258}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2483072, "num_steps_sampled": 704343, "sample_time_ms": 46755.969, "load_time_ms": 5.736, "grad_time_ms": 2250.01, "update_time_ms": 7.54, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 33540816.0, "policy_loss": -0.0010078924242407084, "vf_loss": 33540816.0, "vf_explained_var": 0.0050945281982421875, "kl": 0.002456399379298091, "entropy": 0.859920859336853, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 704343, "episodes_total": 703, "training_iteration": 176, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-35-22", "timestamp": 1684535722, "time_this_iter_s": 49.84226608276367, "time_total_s": 8454.803884029388, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8454.803884029388, "timesteps_since_restore": 704343, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 24.104225352112678, "ram_util_percent": 17.553521126760565}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -593999.5126927287, "episode_len_mean": 994.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -118799.90253854569}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.64590215480956, "mean_processing_ms": 4.463386277780106, "mean_inference_ms": 0.7892253042527345}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2497536, "num_steps_sampled": 708343, "sample_time_ms": 46765.598, "load_time_ms": 5.662, "grad_time_ms": 2248.432, "update_time_ms": 7.696, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 84786352.0, "policy_loss": -4.257685213815421e-05, "vf_loss": 84786352.0, "vf_explained_var": 0.001161420252174139, "kl": 8.319084736285731e-05, "entropy": 0.8630611896514893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 708343, "episodes_total": 708, "training_iteration": 177, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-36-13", "timestamp": 1684535773, "time_this_iter_s": 50.2459180355072, "time_total_s": 8505.049802064896, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8505.049802064896, "timesteps_since_restore": 708343, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.719444444444445, "ram_util_percent": 17.573611111111106}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -595383.6618241011, "episode_len_mean": 994.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -119076.73236482019}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.64032720403398, "mean_processing_ms": 4.463355926164191, "mean_inference_ms": 0.7885933801150357}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2516096, "num_steps_sampled": 712343, "sample_time_ms": 46753.26, "load_time_ms": 5.303, "grad_time_ms": 2249.386, "update_time_ms": 7.813, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 144564416.0, "policy_loss": -9.029969805851579e-05, "vf_loss": 144564416.0, "vf_explained_var": 0.0008854158804751933, "kl": 0.0004102405800949782, "entropy": 0.8690852522850037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 712343, "episodes_total": 709, "training_iteration": 178, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-36-57", "timestamp": 1684535817, "time_this_iter_s": 44.05833911895752, "time_total_s": 8549.108141183853, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8549.108141183853, "timesteps_since_restore": 712343, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 30.18571428571429, "ram_util_percent": 17.58571428571428}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -228584.15714602981, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -596089.704807403, "episode_len_mean": 994.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -758132.5927509177}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -119217.94096148059}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.61102518428646, "mean_processing_ms": 4.462467453186127, "mean_inference_ms": 0.7889677305684674}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2528384, "num_steps_sampled": 716343, "sample_time_ms": 46694.489, "load_time_ms": 5.117, "grad_time_ms": 2258.591, "update_time_ms": 7.492, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 48566848.0, "policy_loss": -0.0001890746207209304, "vf_loss": 48566848.0, "vf_explained_var": 0.0008231935207732022, "kl": 0.00010638381354510784, "entropy": 0.8585798144340515, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 716343, "episodes_total": 710, "training_iteration": 179, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-37-46", "timestamp": 1684535866, "time_this_iter_s": 49.7666552066803, "time_total_s": 8598.874796390533, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8598.874796390533, "timesteps_since_restore": 716343, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 33.3225352112676, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -271121.0438911884, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -593360.5783052582, "episode_len_mean": 994.0, "episodes_this_iter": 11, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -118672.11566105159}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.53612828720156, "mean_processing_ms": 4.459033766155059, "mean_inference_ms": 0.788201945221369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2536448, "num_steps_sampled": 720343, "sample_time_ms": 46708.18, "load_time_ms": 4.858, "grad_time_ms": 2259.786, "update_time_ms": 7.345, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 107517424.0, "policy_loss": 0.0005789946299046278, "vf_loss": 107517424.0, "vf_explained_var": 0.0008138891425915062, "kl": 0.0001754354452714324, "entropy": 0.8457618355751038, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 720343, "episodes_total": 721, "training_iteration": 180, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-38-38", "timestamp": 1684535918, "time_this_iter_s": 51.603310346603394, "time_total_s": 8650.478106737137, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7488>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8650.478106737137, "timesteps_since_restore": 720343, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 35.76486486486487, "ram_util_percent": 17.58243243243243}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -271121.0438911884, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -582571.3087277813, "episode_len_mean": 994.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -116514.26174555617}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.52347167907993, "mean_processing_ms": 4.458077130223294, "mean_inference_ms": 0.7881009491014122}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2551040, "num_steps_sampled": 724343, "sample_time_ms": 46707.565, "load_time_ms": 4.888, "grad_time_ms": 2277.173, "update_time_ms": 7.405, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 37591996.0, "policy_loss": 0.00017171030049212277, "vf_loss": 37591996.0, "vf_explained_var": 0.0048120031133294106, "kl": 0.00039826412103138864, "entropy": 0.8569279909133911, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 724343, "episodes_total": 723, "training_iteration": 181, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-39-27", "timestamp": 1684535967, "time_this_iter_s": 49.077553272247314, "time_total_s": 8699.555660009384, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8699.555660009384, "timesteps_since_restore": 724343, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 24.421428571428567, "ram_util_percent": 17.58714285714285}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -342628.5264143318, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -584499.0029683468, "episode_len_mean": 1000.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -116899.80059366928}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.49396712822036, "mean_processing_ms": 4.456221563935291, "mean_inference_ms": 0.7878017932579914}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2565504, "num_steps_sampled": 728343, "sample_time_ms": 46762.464, "load_time_ms": 4.894, "grad_time_ms": 2271.295, "update_time_ms": 7.239, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 93495256.0, "policy_loss": 5.572968439082615e-05, "vf_loss": 93495256.0, "vf_explained_var": 0.0011361531214788556, "kl": 0.00014690349053125829, "entropy": 0.8511055707931519, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 728343, "episodes_total": 728, "training_iteration": 182, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-40-18", "timestamp": 1684536018, "time_this_iter_s": 50.551247119903564, "time_total_s": 8750.106907129288, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7950>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8750.106907129288, "timesteps_since_restore": 728343, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 27.558333333333334, "ram_util_percent": 17.58888888888889}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -342628.5264143318, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -584439.4350651576, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -116887.88701303145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.48466641342466, "mean_processing_ms": 4.455841531235532, "mean_inference_ms": 0.787758127875684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2584064, "num_steps_sampled": 732343, "sample_time_ms": 46768.148, "load_time_ms": 4.918, "grad_time_ms": 2265.196, "update_time_ms": 7.229, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 151489744.0, "policy_loss": -0.001333143562078476, "vf_loss": 151489744.0, "vf_explained_var": 0.0009126350632868707, "kl": 0.0008515071240253747, "entropy": 0.8361233472824097, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 732343, "episodes_total": 729, "training_iteration": 183, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-41-02", "timestamp": 1684536062, "time_this_iter_s": 44.13900017738342, "time_total_s": 8794.245907306671, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8794.245907306671, "timesteps_since_restore": 732343, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 30.1984126984127, "ram_util_percent": 17.596825396825388}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -342628.5264143318, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -586781.5705296543, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -117356.31410593081}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.47615194242132, "mean_processing_ms": 4.455155474859277, "mean_inference_ms": 0.7876161598569017}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595840, "num_steps_sampled": 736343, "sample_time_ms": 46718.448, "load_time_ms": 5.261, "grad_time_ms": 2275.547, "update_time_ms": 7.545, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 72078712.0, "policy_loss": 0.0009706229902803898, "vf_loss": 72078712.0, "vf_explained_var": 0.0008120355196297169, "kl": 0.00046255774213932455, "entropy": 0.8161819577217102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 736343, "episodes_total": 730, "training_iteration": 184, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-41-51", "timestamp": 1684536111, "time_this_iter_s": 49.41143226623535, "time_total_s": 8843.657339572906, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8843.657339572906, "timesteps_since_restore": 736343, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 33.45714285714286, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -342628.5264143318, "episode_reward_min": -1312644.4679810505, "episode_reward_mean": -590226.5832655514, "episode_len_mean": 1000.0, "episodes_this_iter": 11, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -118045.31665311022}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.3997751137677, "mean_processing_ms": 4.451682201603699, "mean_inference_ms": 0.7870559944488756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2604032, "num_steps_sampled": 740343, "sample_time_ms": 46799.706, "load_time_ms": 5.188, "grad_time_ms": 2259.127, "update_time_ms": 7.304, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 102152256.0, "policy_loss": -0.000421975739300251, "vf_loss": 102152256.0, "vf_explained_var": 0.000733228400349617, "kl": 0.0012243122328072786, "entropy": 0.7861987352371216, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 740343, "episodes_total": 741, "training_iteration": 185, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-42-44", "timestamp": 1684536164, "time_this_iter_s": 52.29054808616638, "time_total_s": 8895.947887659073, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8895.947887659073, "timesteps_since_restore": 740343, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.384, "ram_util_percent": 17.58666666666666}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -573827.9767955197, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -114765.59535910391}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.38759119108533, "mean_processing_ms": 4.450775947114136, "mean_inference_ms": 0.7869502565375021}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2618496, "num_steps_sampled": 744343, "sample_time_ms": 46810.111, "load_time_ms": 5.393, "grad_time_ms": 2276.418, "update_time_ms": 7.513, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 19810708.0, "policy_loss": -2.5060637199203484e-05, "vf_loss": 19810708.0, "vf_explained_var": 0.008202395401895046, "kl": 0.00021194166038185358, "entropy": 0.7804967761039734, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 744343, "episodes_total": 743, "training_iteration": 186, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-43-34", "timestamp": 1684536214, "time_this_iter_s": 50.12430787086487, "time_total_s": 8946.072195529938, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7950>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8946.072195529938, "timesteps_since_restore": 744343, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 24.083098591549298, "ram_util_percent": 17.592957746478866}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -576950.8702188222, "episode_len_mean": 1000.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115390.17404376439}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.36139934143358, "mean_processing_ms": 4.4489573076379365, "mean_inference_ms": 0.7866453770047687}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2632832, "num_steps_sampled": 748343, "sample_time_ms": 46985.663, "load_time_ms": 5.63, "grad_time_ms": 2303.681, "update_time_ms": 7.215, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 59350772.0, "policy_loss": -0.0008093323558568954, "vf_loss": 59350772.0, "vf_explained_var": 0.0021429758053272963, "kl": 0.0014713018899783492, "entropy": 0.7512384653091431, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 748343, "episodes_total": 748, "training_iteration": 187, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-44-26", "timestamp": 1684536266, "time_this_iter_s": 52.263391733169556, "time_total_s": 8998.335587263107, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8998.335587263107, "timesteps_since_restore": 748343, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 26.866666666666667, "ram_util_percent": 17.597333333333328}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -577100.4312939674, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -115420.08625879345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.354196940136, "mean_processing_ms": 4.448596068117121, "mean_inference_ms": 0.7866076600931383}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2651392, "num_steps_sampled": 752343, "sample_time_ms": 46920.972, "load_time_ms": 6.005, "grad_time_ms": 2337.748, "update_time_ms": 6.952, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 225102176.0, "policy_loss": 0.00015653700393158942, "vf_loss": 225102176.0, "vf_explained_var": 0.0007468227413482964, "kl": 0.0015277368947863579, "entropy": 0.7496428489685059, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 752343, "episodes_total": 749, "training_iteration": 188, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-45-10", "timestamp": 1684536310, "time_this_iter_s": 43.74424338340759, "time_total_s": 9042.079830646515, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9042.079830646515, "timesteps_since_restore": 752343, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 30.96129032258065, "ram_util_percent": 17.599999999999994}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -574342.5009104867, "episode_len_mean": 998.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19701.565541529097}, "policy_reward_mean": {"avProbe": -114868.50018209731}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.33527076188, "mean_processing_ms": 4.447850742426711, "mean_inference_ms": 0.7865049486217324}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2663296, "num_steps_sampled": 756343, "sample_time_ms": 46883.744, "load_time_ms": 6.166, "grad_time_ms": 2331.149, "update_time_ms": 7.408, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 79068048.0, "policy_loss": -0.0005354602471925318, "vf_loss": 79068048.0, "vf_explained_var": 0.0007264030864462256, "kl": 3.4427401260472834e-05, "entropy": 0.7531993389129639, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 756343, "episodes_total": 751, "training_iteration": 189, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-45-59", "timestamp": 1684536359, "time_this_iter_s": 49.337770223617554, "time_total_s": 9091.417600870132, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9091.417600870132, "timesteps_since_restore": 756343, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 33.170422535211266, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -595703.0077231899, "episode_len_mean": 998.0, "episodes_this_iter": 10, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119140.60154463795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.26647502597717, "mean_processing_ms": 4.444685174925906, "mean_inference_ms": 0.785956200730616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2672384, "num_steps_sampled": 760343, "sample_time_ms": 46866.386, "load_time_ms": 6.374, "grad_time_ms": 2347.352, "update_time_ms": 7.607, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 99541680.0, "policy_loss": -0.0013228595489636064, "vf_loss": 99541680.0, "vf_explained_var": 0.0011829464929178357, "kl": 0.0004708982596639544, "entropy": 0.7561846971511841, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 760343, "episodes_total": 761, "training_iteration": 190, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-46-51", "timestamp": 1684536411, "time_this_iter_s": 51.59500288963318, "time_total_s": 9143.012603759766, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7950>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9143.012603759766, "timesteps_since_restore": 760343, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 34.66575342465753, "ram_util_percent": 17.590410958904105}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -598376.0400750127, "episode_len_mean": 998.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119675.20801500251}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.25438375410556, "mean_processing_ms": 4.4438651965301155, "mean_inference_ms": 0.7858648586198875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2687104, "num_steps_sampled": 764343, "sample_time_ms": 46991.152, "load_time_ms": 6.74, "grad_time_ms": 2327.454, "update_time_ms": 7.75, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 23854814.0, "policy_loss": -0.0006311683100648224, "vf_loss": 23854816.0, "vf_explained_var": 0.00727480836212635, "kl": 0.0008463089470751584, "entropy": 0.7423925399780273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 764343, "episodes_total": 763, "training_iteration": 191, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-47-41", "timestamp": 1684536461, "time_this_iter_s": 50.13720083236694, "time_total_s": 9193.149804592133, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9193.149804592133, "timesteps_since_restore": 764343, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 24.45555555555556, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -598652.5252357214, "episode_len_mean": 998.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119730.50504714427}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.23109916722674, "mean_processing_ms": 4.442069942034739, "mean_inference_ms": 0.7856306021911211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2701440, "num_steps_sampled": 768343, "sample_time_ms": 47063.638, "load_time_ms": 6.583, "grad_time_ms": 2319.453, "update_time_ms": 7.963, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 77330688.0, "policy_loss": -0.000802142487373203, "vf_loss": 77330688.0, "vf_explained_var": 0.0015827055322006345, "kl": 0.0007571348105557263, "entropy": 0.7243875861167908, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 768343, "episodes_total": 768, "training_iteration": 192, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-48-32", "timestamp": 1684536512, "time_this_iter_s": 51.200554847717285, "time_total_s": 9244.35035943985, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9244.35035943985, "timesteps_since_restore": 768343, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 27.86849315068493, "ram_util_percent": 17.595890410958898}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -597768.4360525078, "episode_len_mean": 998.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119553.68721050155}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.2253932870929, "mean_processing_ms": 4.441739403892993, "mean_inference_ms": 0.7856039195178116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2719360, "num_steps_sampled": 772343, "sample_time_ms": 47069.276, "load_time_ms": 6.456, "grad_time_ms": 2311.633, "update_time_ms": 8.205, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 129884424.0, "policy_loss": -0.0024179064203053713, "vf_loss": 129884424.0, "vf_explained_var": 0.0012890773359686136, "kl": 0.003764484077692032, "entropy": 0.6756833791732788, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 772343, "episodes_total": 769, "training_iteration": 193, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-49-17", "timestamp": 1684536557, "time_this_iter_s": 44.11263823509216, "time_total_s": 9288.462997674942, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9288.462997674942, "timesteps_since_restore": 772343, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 30.73174603174603, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -599401.2839088216, "episode_len_mean": 998.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119880.25678176433}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.20670424076638, "mean_processing_ms": 4.441003234894855, "mean_inference_ms": 0.7854655813986032}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2730496, "num_steps_sampled": 776343, "sample_time_ms": 47168.425, "load_time_ms": 6.388, "grad_time_ms": 2289.694, "update_time_ms": 8.113, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 70902840.0, "policy_loss": -0.002117738127708435, "vf_loss": 70902840.0, "vf_explained_var": 0.0008951925556175411, "kl": 0.00305200950242579, "entropy": 0.6410208940505981, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 776343, "episodes_total": 771, "training_iteration": 194, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-50-07", "timestamp": 1684536607, "time_this_iter_s": 50.187084674835205, "time_total_s": 9338.650082349777, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7950>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9338.650082349777, "timesteps_since_restore": 776343, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 33.14444444444444, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -603727.4161229829, "episode_len_mean": 998.0, "episodes_this_iter": 10, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -120745.48322459655}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.13867114176938, "mean_processing_ms": 4.438205093931635, "mean_inference_ms": 0.7848446541184303}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2739840, "num_steps_sampled": 780343, "sample_time_ms": 47025.615, "load_time_ms": 6.431, "grad_time_ms": 2307.674, "update_time_ms": 8.337, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 116359992.0, "policy_loss": -0.00034171194420196116, "vf_loss": 116359992.0, "vf_explained_var": 0.0009799477411434054, "kl": 0.0006616024184040725, "entropy": 0.6342369318008423, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 780343, "episodes_total": 781, "training_iteration": 195, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-50-58", "timestamp": 1684536658, "time_this_iter_s": 51.04412269592285, "time_total_s": 9389.6942050457, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9389.6942050457, "timesteps_since_restore": 780343, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 34.50136986301371, "ram_util_percent": 17.59041095890411}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -599492.9527582123, "episode_len_mean": 998.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119898.59055164242}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.1285684471428, "mean_processing_ms": 4.4374895287918354, "mean_inference_ms": 0.7847604310811533}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2754048, "num_steps_sampled": 784343, "sample_time_ms": 47026.565, "load_time_ms": 6.29, "grad_time_ms": 2290.522, "update_time_ms": 8.074, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 27346562.0, "policy_loss": -0.00237179989926517, "vf_loss": 27346562.0, "vf_explained_var": 0.006240332033485174, "kl": 0.0053877318277955055, "entropy": 0.6510736346244812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 784343, "episodes_total": 783, "training_iteration": 196, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-51-48", "timestamp": 1684536708, "time_this_iter_s": 49.960248708724976, "time_total_s": 9439.654453754425, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9439.654453754425, "timesteps_since_restore": 784343, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 24.62676056338028, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -603102.8817019707, "episode_len_mean": 998.0, "episodes_this_iter": 5, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -120620.5763403941}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.10862861659268, "mean_processing_ms": 4.435778569277366, "mean_inference_ms": 0.7845379200372193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2768512, "num_steps_sampled": 788343, "sample_time_ms": 46859.937, "load_time_ms": 6.16, "grad_time_ms": 2284.668, "update_time_ms": 7.941, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 92018752.0, "policy_loss": -7.170023309299722e-05, "vf_loss": 92018752.0, "vf_explained_var": 0.0014129364863038063, "kl": 0.0002878489613067359, "entropy": 0.629591703414917, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 788343, "episodes_total": 788, "training_iteration": 197, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-52-38", "timestamp": 1684536758, "time_this_iter_s": 50.538217067718506, "time_total_s": 9490.192670822144, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9490.192670822144, "timesteps_since_restore": 788343, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 28.19861111111111, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -273958.5696360158, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -601474.6792051995, "episode_len_mean": 998.0, "episodes_this_iter": 1, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -120294.93584103987}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.103971519532, "mean_processing_ms": 4.435436988689704, "mean_inference_ms": 0.7845286876717462}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2787072, "num_steps_sampled": 792343, "sample_time_ms": 46985.4, "load_time_ms": 5.766, "grad_time_ms": 2254.127, "update_time_ms": 8.116, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 132746288.0, "policy_loss": -0.0005096248351037502, "vf_loss": 132746288.0, "vf_explained_var": 0.00121658097486943, "kl": 0.0020877395290881395, "entropy": 0.6378093957901001, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 792343, "episodes_total": 789, "training_iteration": 198, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-53-23", "timestamp": 1684536803, "time_this_iter_s": 44.69036841392517, "time_total_s": 9534.883039236069, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7950>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9534.883039236069, "timesteps_since_restore": 792343, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 30.278125000000003, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -595443.5035203539, "episode_len_mean": 990.91, "episodes_this_iter": 3, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -119088.70070407071}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.02268071062946, "mean_processing_ms": 4.4324501678989385, "mean_inference_ms": 0.7842702424672892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2799104, "num_steps_sampled": 796343, "sample_time_ms": 47189.375, "load_time_ms": 5.608, "grad_time_ms": 2248.747, "update_time_ms": 7.942, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 86394328.0, "policy_loss": -0.0010927020339295268, "vf_loss": 86394328.0, "vf_explained_var": 0.0009236906189471483, "kl": 0.0013114805333316326, "entropy": 0.6356678605079651, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 796343, "episodes_total": 792, "training_iteration": 199, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-54-14", "timestamp": 1684536854, "time_this_iter_s": 51.31587815284729, "time_total_s": 9586.198917388916, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9586.198917388916, "timesteps_since_restore": 796343, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 32.33972602739726, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -594607.5781508652, "episode_len_mean": 990.91, "episodes_this_iter": 10, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -118921.51563017302}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.96826168654488, "mean_processing_ms": 4.431034867730135, "mean_inference_ms": 0.7841805323811646}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2808064, "num_steps_sampled": 800343, "sample_time_ms": 47161.26, "load_time_ms": 5.655, "grad_time_ms": 2250.095, "update_time_ms": 7.663, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 99437304.0, "policy_loss": -0.001122098765335977, "vf_loss": 99437304.0, "vf_explained_var": 0.0015567004447802901, "kl": 0.0011317351600155234, "entropy": 0.6672317981719971, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 800343, "episodes_total": 802, "training_iteration": 200, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-55-06", "timestamp": 1684536906, "time_this_iter_s": 51.32914471626282, "time_total_s": 9637.528062105179, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7840>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9637.528062105179, "timesteps_since_restore": 800343, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 33.867123287671234, "ram_util_percent": 17.5931506849315}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -594267.951397613, "episode_len_mean": 990.91, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19682.739878591594}, "policy_reward_mean": {"avProbe": -118853.59027952257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 162.00280903915092, "mean_processing_ms": 4.431964127768112, "mean_inference_ms": 0.7838154364876838}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2822912, "num_steps_sampled": 804343, "sample_time_ms": 47127.966, "load_time_ms": 5.459, "grad_time_ms": 2273.704, "update_time_ms": 7.597, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 42245260.0, "policy_loss": -0.0008841301314532757, "vf_loss": 42245260.0, "vf_explained_var": 0.004342653322964907, "kl": 0.0009742043912410736, "entropy": 0.693145215511322, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 804343, "episodes_total": 804, "training_iteration": 201, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-55-56", "timestamp": 1684536956, "time_this_iter_s": 50.032325744628906, "time_total_s": 9687.560387849808, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9687.560387849808, "timesteps_since_restore": 804343, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 23.93333333333333, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -588411.8682598829, "episode_len_mean": 990.91, "episodes_this_iter": 4, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19681.48861689168}, "policy_reward_mean": {"avProbe": -117682.37365197655}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.98238165946594, "mean_processing_ms": 4.430519182673168, "mean_inference_ms": 0.7835690805520847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2838016, "num_steps_sampled": 808343, "sample_time_ms": 46997.856, "load_time_ms": 5.608, "grad_time_ms": 2288.665, "update_time_ms": 7.765, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 70643224.0, "policy_loss": -0.0007937850314192474, "vf_loss": 70643224.0, "vf_explained_var": 0.0015613633440807462, "kl": 0.0006062175380066037, "entropy": 0.6895949244499207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 808343, "episodes_total": 808, "training_iteration": 202, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-56-46", "timestamp": 1684537006, "time_this_iter_s": 50.04282903671265, "time_total_s": 9737.60321688652, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af79d8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9737.60321688652, "timesteps_since_restore": 808343, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 28.211267605633797, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -586941.7311624824, "episode_len_mean": 990.91, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19681.48861689168}, "policy_reward_mean": {"avProbe": -117388.34623249643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.9359521568091, "mean_processing_ms": 4.42853734746698, "mean_inference_ms": 0.7832623948196769}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2855168, "num_steps_sampled": 812434, "sample_time_ms": 49275.404, "load_time_ms": 5.624, "grad_time_ms": 2274.332, "update_time_ms": 7.648, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 115143224.0, "policy_loss": 9.784325084183365e-05, "vf_loss": 115143224.0, "vf_explained_var": 0.0011279912432655692, "kl": 0.00017202460730914026, "entropy": 0.6997231245040894, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4091, "done": false, "timesteps_total": 812434, "episodes_total": 810, "training_iteration": 203, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-57-53", "timestamp": 1684537073, "time_this_iter_s": 66.74059581756592, "time_total_s": 9804.343812704086, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9804.343812704086, "timesteps_since_restore": 812434, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 22.75157894736842, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1244217.7246356474, "episode_reward_mean": -584455.6603289843, "episode_len_mean": 990.91, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -805842.0055577083}, "policy_reward_max": {"avProbe": 19681.48861689168}, "policy_reward_mean": {"avProbe": -116891.13206579682}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.90018976631657, "mean_processing_ms": 4.427318880468622, "mean_inference_ms": 0.7832987524268866}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2867072, "num_steps_sampled": 816434, "sample_time_ms": 49226.365, "load_time_ms": 5.706, "grad_time_ms": 2287.271, "update_time_ms": 7.738, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 88610640.0, "policy_loss": 0.00014237170398700982, "vf_loss": 88610648.0, "vf_explained_var": 0.0009754018392413855, "kl": 9.961049363482744e-05, "entropy": 0.6902821660041809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 816434, "episodes_total": 812, "training_iteration": 204, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-58-43", "timestamp": 1684537123, "time_this_iter_s": 49.82140040397644, "time_total_s": 9854.165213108063, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9854.165213108063, "timesteps_since_restore": 816434, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 32.943661971830984, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1129565.9443577516, "episode_reward_mean": -578482.6753839804, "episode_len_mean": 990.91, "episodes_this_iter": 10, "policy_reward_min": {"avProbe": -802827.2633981579}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -115696.53507679605}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.8492731161885, "mean_processing_ms": 4.425859364318831, "mean_inference_ms": 0.7832137211129064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2876288, "num_steps_sampled": 820434, "sample_time_ms": 49169.735, "load_time_ms": 5.587, "grad_time_ms": 2287.266, "update_time_ms": 7.498, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 122386984.0, "policy_loss": -0.0014574010856449604, "vf_loss": 122386984.0, "vf_explained_var": 0.0011356589384377003, "kl": 0.00026957024238072336, "entropy": 0.6782652735710144, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 820434, "episodes_total": 822, "training_iteration": 205, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_18-59-33", "timestamp": 1684537173, "time_this_iter_s": 50.479825258255005, "time_total_s": 9904.645038366318, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9904.645038366318, "timesteps_since_restore": 820434, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 34.625, "ram_util_percent": 17.59305555555555}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1129565.9443577516, "episode_reward_mean": -583285.1955278091, "episode_len_mean": 990.91, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -802827.2633981579}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -116657.03910556182}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.8844112704058, "mean_processing_ms": 4.426810787069693, "mean_inference_ms": 0.7828913411227049}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2891392, "num_steps_sampled": 824434, "sample_time_ms": 49134.579, "load_time_ms": 5.785, "grad_time_ms": 2297.159, "update_time_ms": 7.641, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 42418760.0, "policy_loss": -0.0014460345264524221, "vf_loss": 42418768.0, "vf_explained_var": 0.004685346968472004, "kl": 0.0015501981833949685, "entropy": 0.6586378812789917, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 824434, "episodes_total": 824, "training_iteration": 206, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-00-23", "timestamp": 1684537223, "time_this_iter_s": 49.717623233795166, "time_total_s": 9954.362661600113, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af79d8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9954.362661600113, "timesteps_since_restore": 824434, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 24.4112676056338, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1129565.9443577516, "episode_reward_mean": -582382.2370922691, "episode_len_mean": 990.91, "episodes_this_iter": 4, "policy_reward_min": {"avProbe": -802827.2633981579}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -116476.44741845381}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.8634758111089, "mean_processing_ms": 4.42542999058251, "mean_inference_ms": 0.7826223612080709}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2906112, "num_steps_sampled": 828434, "sample_time_ms": 49039.689, "load_time_ms": 5.899, "grad_time_ms": 2282.99, "update_time_ms": 7.691, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 79822480.0, "policy_loss": 9.672057058196515e-05, "vf_loss": 79822480.0, "vf_explained_var": 0.0016358556458726525, "kl": 0.0004716301627922803, "entropy": 0.6626788377761841, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 828434, "episodes_total": 828, "training_iteration": 207, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-01-12", "timestamp": 1684537272, "time_this_iter_s": 49.46329379081726, "time_total_s": 10003.82595539093, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10003.82595539093, "timesteps_since_restore": 828434, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 28.34366197183099, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1129565.9443577516, "episode_reward_mean": -577649.0265246779, "episode_len_mean": 985.15, "episodes_this_iter": 3, "policy_reward_min": {"avProbe": -802827.2633981579}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -115529.80530493555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.78522415495343, "mean_processing_ms": 4.423055810928217, "mean_inference_ms": 0.7823961534281447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2923392, "num_steps_sampled": 832434, "sample_time_ms": 49579.827, "load_time_ms": 5.907, "grad_time_ms": 2253.659, "update_time_ms": 7.798, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 95588936.0, "policy_loss": -0.0008633024990558624, "vf_loss": 95588936.0, "vf_explained_var": 0.0014946663286536932, "kl": 0.002508092438802123, "entropy": 0.6126865744590759, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 832434, "episodes_total": 831, "training_iteration": 208, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-02-02", "timestamp": 1684537322, "time_this_iter_s": 49.7992684841156, "time_total_s": 10053.625223875046, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10053.625223875046, "timesteps_since_restore": 832434, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 28.03239436619718, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1129565.9443577516, "episode_reward_mean": -581438.3182447667, "episode_len_mean": 985.15, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -802827.2633981579}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -116287.66364895331}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.76341642898615, "mean_processing_ms": 4.42247075658559, "mean_inference_ms": 0.7824305288386033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2935168, "num_steps_sampled": 836434, "sample_time_ms": 49480.033, "load_time_ms": 5.795, "grad_time_ms": 2258.574, "update_time_ms": 7.858, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 76957304.0, "policy_loss": 0.0004928081762045622, "vf_loss": 76957304.0, "vf_explained_var": 0.0012562229530885816, "kl": 0.0015264995163306594, "entropy": 0.5761616230010986, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 836434, "episodes_total": 833, "training_iteration": 209, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-02-53", "timestamp": 1684537373, "time_this_iter_s": 50.36748647689819, "time_total_s": 10103.992710351944, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10103.992710351944, "timesteps_since_restore": 836434, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 31.522222222222222, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1129565.9443577516, "episode_reward_mean": -575462.4938331058, "episode_len_mean": 985.15, "episodes_this_iter": 9, "policy_reward_min": {"avProbe": -802827.2633981579}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -115092.49876662111}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.72352446740564, "mean_processing_ms": 4.42136882298751, "mean_inference_ms": 0.7823694121143019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2945280, "num_steps_sampled": 840434, "sample_time_ms": 49397.239, "load_time_ms": 5.644, "grad_time_ms": 2275.221, "update_time_ms": 8.127, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 65148560.0, "policy_loss": -0.0015278802020475268, "vf_loss": 65148560.0, "vf_explained_var": 0.001605298719368875, "kl": 0.0025094980373978615, "entropy": 0.5568621754646301, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 840434, "episodes_total": 842, "training_iteration": 210, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-03-43", "timestamp": 1684537423, "time_this_iter_s": 50.65920114517212, "time_total_s": 10154.651911497116, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af79d8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10154.651911497116, "timesteps_since_restore": 840434, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 34.02916666666667, "ram_util_percent": 17.595833333333328}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -581852.8923068563, "episode_len_mean": 985.15, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -116370.57846137125}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.7584295188021, "mean_processing_ms": 4.422311823082652, "mean_inference_ms": 0.7820505215915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2959872, "num_steps_sampled": 844434, "sample_time_ms": 49602.009, "load_time_ms": 5.681, "grad_time_ms": 2252.689, "update_time_ms": 7.882, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 21280676.0, "policy_loss": -0.0003983205242548138, "vf_loss": 21280676.0, "vf_explained_var": 0.008214014582335949, "kl": 0.0001550389570184052, "entropy": 0.5498164892196655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 844434, "episodes_total": 844, "training_iteration": 211, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-04-35", "timestamp": 1684537475, "time_this_iter_s": 51.8548309803009, "time_total_s": 10206.506742477417, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10206.506742477417, "timesteps_since_restore": 844434, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 24.751351351351353, "ram_util_percent": 17.599999999999994}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -572542.0966532755, "episode_len_mean": 980.97, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -114508.41933065509}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.70982676311408, "mean_processing_ms": 4.420331098890777, "mean_inference_ms": 0.7820768321912409}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2973568, "num_steps_sampled": 848458, "sample_time_ms": 50072.326, "load_time_ms": 5.533, "grad_time_ms": 2224.693, "update_time_ms": 7.781, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 54662808.0, "policy_loss": -0.0007700507994741201, "vf_loss": 54662808.0, "vf_explained_var": 0.0026881794910877943, "kl": 0.0008558249101042747, "entropy": 0.5243633389472961, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4024, "done": false, "timesteps_total": 848458, "episodes_total": 850, "training_iteration": 212, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-05-30", "timestamp": 1684537530, "time_this_iter_s": 54.465524196624756, "time_total_s": 10260.972266674042, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10260.972266674042, "timesteps_since_restore": 848458, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 27.08717948717949, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -569040.2863607599, "episode_len_mean": 980.97, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -113808.05727215197}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.65420631488456, "mean_processing_ms": 4.418673555990698, "mean_inference_ms": 0.7813454573725978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2990592, "num_steps_sampled": 852458, "sample_time_ms": 48391.968, "load_time_ms": 5.417, "grad_time_ms": 2225.855, "update_time_ms": 7.847, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 99317800.0, "policy_loss": -0.000196956709260121, "vf_loss": 99317800.0, "vf_explained_var": 0.001824720879085362, "kl": 0.0008416307391598821, "entropy": 0.5073918700218201, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 852458, "episodes_total": 852, "training_iteration": 213, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-06-20", "timestamp": 1684537580, "time_this_iter_s": 49.94535565376282, "time_total_s": 10310.917622327805, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10310.917622327805, "timesteps_since_restore": 852458, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 27.025352112676053, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -566739.6902244363, "episode_len_mean": 980.97, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -113347.93804488725}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.64737519874566, "mean_processing_ms": 4.418565955969191, "mean_inference_ms": 0.7816560018517894}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3003136, "num_steps_sampled": 856458, "sample_time_ms": 48450.072, "load_time_ms": 5.325, "grad_time_ms": 2250.655, "update_time_ms": 7.728, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 53404928.0, "policy_loss": 0.0015092617832124233, "vf_loss": 53404928.0, "vf_explained_var": 0.0016399037558585405, "kl": 2.4628412575111724e-05, "entropy": 0.5092726945877075, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 856458, "episodes_total": 854, "training_iteration": 214, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-07-10", "timestamp": 1684537630, "time_this_iter_s": 50.64967155456543, "time_total_s": 10361.56729388237, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af79d8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10361.56729388237, "timesteps_since_restore": 856458, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 30.859722222222224, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -550917.578678219, "episode_len_mean": 980.97, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -110183.51573564378}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.6033596991338, "mean_processing_ms": 4.4174875792496815, "mean_inference_ms": 0.781524374829731}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3014144, "num_steps_sampled": 860458, "sample_time_ms": 48553.729, "load_time_ms": 5.342, "grad_time_ms": 2293.812, "update_time_ms": 7.866, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 118354944.0, "policy_loss": -0.00013969115389045328, "vf_loss": 118354944.0, "vf_explained_var": 0.0010773809626698494, "kl": 0.0003514288691803813, "entropy": 0.5078664422035217, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 860458, "episodes_total": 862, "training_iteration": 215, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-08-02", "timestamp": 1684537682, "time_this_iter_s": 51.94733738899231, "time_total_s": 10413.514631271362, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10413.514631271362, "timesteps_since_restore": 860458, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 32.26800000000001, "ram_util_percent": 17.605333333333327}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -543845.0862099798, "episode_len_mean": 980.97, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -108769.01724199599}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.63697000851786, "mean_processing_ms": 4.418376249204787, "mean_inference_ms": 0.7811721823647813}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3027712, "num_steps_sampled": 864458, "sample_time_ms": 48631.28, "load_time_ms": 5.111, "grad_time_ms": 2277.377, "update_time_ms": 7.642, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 22743774.0, "policy_loss": -0.0008919105748645961, "vf_loss": 22743774.0, "vf_explained_var": 0.00762091763317585, "kl": 0.00016394506383221596, "entropy": 0.5144850611686707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 864458, "episodes_total": 864, "training_iteration": 216, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-08-53", "timestamp": 1684537733, "time_this_iter_s": 50.315423250198364, "time_total_s": 10463.83005452156, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10463.83005452156, "timesteps_since_restore": 864458, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 26.66197183098592, "ram_util_percent": 17.59999999999999}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -548900.141296804, "episode_len_mean": 980.97, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -109780.02825936076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.58809183142398, "mean_processing_ms": 4.416480379694105, "mean_inference_ms": 0.7811698599461713}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3040512, "num_steps_sampled": 868458, "sample_time_ms": 48694.763, "load_time_ms": 5.045, "grad_time_ms": 2259.83, "update_time_ms": 7.703, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 56652492.0, "policy_loss": -5.836017589899711e-05, "vf_loss": 56652492.0, "vf_explained_var": 0.00258982484228909, "kl": 0.00041169312316924334, "entropy": 0.5049484372138977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 868458, "episodes_total": 870, "training_iteration": 217, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-09-43", "timestamp": 1684537783, "time_this_iter_s": 49.92047929763794, "time_total_s": 10513.750533819199, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10513.750533819199, "timesteps_since_restore": 868458, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 29.59027777777778, "ram_util_percent": 17.608333333333334}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -545850.9764617947, "episode_len_mean": 980.97, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -109170.19529235894}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.53561122509424, "mean_processing_ms": 4.414860230095289, "mean_inference_ms": 0.7804759599153962}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3057536, "num_steps_sampled": 872458, "sample_time_ms": 48945.834, "load_time_ms": 5.345, "grad_time_ms": 2259.858, "update_time_ms": 7.637, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 110169816.0, "policy_loss": -0.0006868317141197622, "vf_loss": 110169816.0, "vf_explained_var": 0.0018088786164298654, "kl": 0.0024261397775262594, "entropy": 0.49252673983573914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 872458, "episodes_total": 872, "training_iteration": 218, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-10-35", "timestamp": 1684537835, "time_this_iter_s": 52.31252717971802, "time_total_s": 10566.063060998917, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af79d8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10566.063060998917, "timesteps_since_restore": 872458, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 26.13648648648649, "ram_util_percent": 17.599999999999994}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -545435.4875008396, "episode_len_mean": 980.97, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -109087.09750016792}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.52924727999678, "mean_processing_ms": 4.414712662626076, "mean_inference_ms": 0.7807770970082033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3070080, "num_steps_sampled": 876458, "sample_time_ms": 48927.437, "load_time_ms": 5.611, "grad_time_ms": 2270.809, "update_time_ms": 7.343, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 125646736.0, "policy_loss": -4.670388807426207e-05, "vf_loss": 125646736.0, "vf_explained_var": 0.000936898635700345, "kl": 0.0013534179888665676, "entropy": 0.5020729899406433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 876458, "episodes_total": 874, "training_iteration": 219, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-11-25", "timestamp": 1684537885, "time_this_iter_s": 50.28869819641113, "time_total_s": 10616.351759195328, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10616.351759195328, "timesteps_since_restore": 876458, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 30.977777777777778, "ram_util_percent": 17.623611111111114}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -538896.0337713897, "episode_len_mean": 980.97, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -107779.20675427797}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.48375506239853, "mean_processing_ms": 4.413566710492825, "mean_inference_ms": 0.7806510648477409}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3081088, "num_steps_sampled": 880458, "sample_time_ms": 48911.663, "load_time_ms": 5.721, "grad_time_ms": 2291.895, "update_time_ms": 7.23, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 192201056.0, "policy_loss": -0.00016009097453206778, "vf_loss": 192201056.0, "vf_explained_var": 0.0009038933203555644, "kl": 1.651912862143945e-05, "entropy": 0.5004575848579407, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 880458, "episodes_total": 882, "training_iteration": 220, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-12-16", "timestamp": 1684537936, "time_this_iter_s": 50.719908475875854, "time_total_s": 10667.071667671204, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af78c8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10667.071667671204, "timesteps_since_restore": 880458, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 33.52777777777778, "ram_util_percent": 17.608333333333334}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -542240.9608762119, "episode_len_mean": 980.97, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -108448.19217524237}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.51760846977632, "mean_processing_ms": 4.41437140411736, "mean_inference_ms": 0.7803033501492225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3094784, "num_steps_sampled": 884458, "sample_time_ms": 48773.587, "load_time_ms": 5.621, "grad_time_ms": 2278.144, "update_time_ms": 7.525, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 58938188.0, "policy_loss": -0.0013232565252110362, "vf_loss": 58938188.0, "vf_explained_var": 0.0032991047482937574, "kl": 0.0007596499635837972, "entropy": 0.5112125873565674, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 884458, "episodes_total": 884, "training_iteration": 221, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-13-06", "timestamp": 1684537986, "time_this_iter_s": 50.33592176437378, "time_total_s": 10717.407589435577, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10717.407589435577, "timesteps_since_restore": 884458, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 26.424999999999997, "ram_util_percent": 17.599999999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -101501.23751137021, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -560832.6408397753, "episode_len_mean": 980.97, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -112166.52816795507}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.47039410703223, "mean_processing_ms": 4.412578192854975, "mean_inference_ms": 0.780241849175799}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3107840, "num_steps_sampled": 888458, "sample_time_ms": 48518.257, "load_time_ms": 5.71, "grad_time_ms": 2281.438, "update_time_ms": 7.274, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 68323264.0, "policy_loss": 5.320503260008991e-05, "vf_loss": 68323264.0, "vf_explained_var": 0.0018372746417298913, "kl": 8.955296834756155e-06, "entropy": 0.5101437568664551, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 888458, "episodes_total": 890, "training_iteration": 222, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-13-58", "timestamp": 1684538038, "time_this_iter_s": 51.94316482543945, "time_total_s": 10769.350754261017, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7a60>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10769.350754261017, "timesteps_since_restore": 888458, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 29.116216216216216, "ram_util_percent": 17.608108108108105}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -562985.7149889836, "episode_len_mean": 988.06, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -112597.14299779675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.47763393313207, "mean_processing_ms": 4.413065143488446, "mean_inference_ms": 0.7797175899707942}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3124864, "num_steps_sampled": 892458, "sample_time_ms": 48804.147, "load_time_ms": 5.669, "grad_time_ms": 2277.415, "update_time_ms": 7.29, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 57675960.0, "policy_loss": 5.8527057262836024e-05, "vf_loss": 57675960.0, "vf_explained_var": 0.002505098469555378, "kl": 0.0003439706051722169, "entropy": 0.49397990107536316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 892458, "episodes_total": 892, "training_iteration": 223, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-14-51", "timestamp": 1684538091, "time_this_iter_s": 52.777254581451416, "time_total_s": 10822.128008842468, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10822.128008842468, "timesteps_since_restore": 892458, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 25.609210526315792, "ram_util_percent": 17.622368421052627}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -563438.4575564251, "episode_len_mean": 988.06, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -112687.69151128504}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.4571130522251, "mean_processing_ms": 4.412245119752168, "mean_inference_ms": 0.7797401872588984}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3138048, "num_steps_sampled": 896458, "sample_time_ms": 48827.7, "load_time_ms": 5.943, "grad_time_ms": 2274.367, "update_time_ms": 7.351, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 71120704.0, "policy_loss": -0.0011076537193730474, "vf_loss": 71120704.0, "vf_explained_var": 0.0013555606128647923, "kl": 0.0017568584298714995, "entropy": 0.5330520272254944, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 896458, "episodes_total": 894, "training_iteration": 224, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-15-42", "timestamp": 1684538142, "time_this_iter_s": 50.86128234863281, "time_total_s": 10872.989291191101, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10872.989291191101, "timesteps_since_restore": 896458, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 31.03472222222222, "ram_util_percent": 17.662499999999998}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -547797.0721243183, "episode_len_mean": 988.06, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -109559.4144248637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.41851945588357, "mean_processing_ms": 4.4103752012346025, "mean_inference_ms": 0.7794618234329408}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3149056, "num_steps_sampled": 900458, "sample_time_ms": 48951.065, "load_time_ms": 5.832, "grad_time_ms": 2255.107, "update_time_ms": 7.482, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 135205856.0, "policy_loss": -0.0008666985086165369, "vf_loss": 135205856.0, "vf_explained_var": 0.0008761827484704554, "kl": 0.0008544446318410337, "entropy": 0.5156972408294678, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 900458, "episodes_total": 902, "training_iteration": 225, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-16-35", "timestamp": 1684538195, "time_this_iter_s": 52.98592805862427, "time_total_s": 10925.975219249725, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10925.975219249725, "timesteps_since_restore": 900458, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 31.807894736842105, "ram_util_percent": 17.663157894736838}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -545984.623544941, "episode_len_mean": 988.06, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -109196.92470898823}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.41124434348112, "mean_processing_ms": 4.409801184631216, "mean_inference_ms": 0.7793794255992755}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3163264, "num_steps_sampled": 904458, "sample_time_ms": 48877.022, "load_time_ms": 5.816, "grad_time_ms": 2254.512, "update_time_ms": 7.658, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 90361656.0, "policy_loss": -0.0001440095657017082, "vf_loss": 90361656.0, "vf_explained_var": 0.0025314870290458202, "kl": 7.973770698299631e-05, "entropy": 0.5095903873443604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 904458, "episodes_total": 904, "training_iteration": 226, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-17-25", "timestamp": 1684538245, "time_this_iter_s": 49.57080388069153, "time_total_s": 10975.546023130417, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7a60>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10975.546023130417, "timesteps_since_restore": 904458, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 26.809859154929573, "ram_util_percent": 17.632394366197175}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -546837.7994396115, "episode_len_mean": 988.06, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -109367.55988792228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.4199191802418, "mean_processing_ms": 4.410152571550606, "mean_inference_ms": 0.7793551649028957}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3176320, "num_steps_sampled": 908458, "sample_time_ms": 49032.5, "load_time_ms": 5.748, "grad_time_ms": 2244.642, "update_time_ms": 7.9, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 73454560.0, "policy_loss": -0.00014411650772672147, "vf_loss": 73454560.0, "vf_explained_var": 0.0018981484463438392, "kl": 0.0009113566484302282, "entropy": 0.5127589106559753, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 908458, "episodes_total": 910, "training_iteration": 227, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-18-16", "timestamp": 1684538296, "time_this_iter_s": 51.366777658462524, "time_total_s": 11026.91280078888, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11026.91280078888, "timesteps_since_restore": 908458, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 29.310958904109587, "ram_util_percent": 17.627397260273973}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -554146.1634877822, "episode_len_mean": 988.06, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19687.523716257267}, "policy_reward_mean": {"avProbe": -110829.23269755645}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.3716195757428, "mean_processing_ms": 4.408546939080468, "mean_inference_ms": 0.7789061121962305}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3193344, "num_steps_sampled": 912458, "sample_time_ms": 48811.92, "load_time_ms": 5.654, "grad_time_ms": 2242.907, "update_time_ms": 7.842, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 88627288.0, "policy_loss": -0.0009721804526634514, "vf_loss": 88627288.0, "vf_explained_var": 0.0022859631571918726, "kl": 0.0014960886910557747, "entropy": 0.5280604362487793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 912458, "episodes_total": 912, "training_iteration": 228, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-19-06", "timestamp": 1684538346, "time_this_iter_s": 50.08829307556152, "time_total_s": 11077.001093864441, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11077.001093864441, "timesteps_since_restore": 912458, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 27.081690140845073, "ram_util_percent": 17.67323943661972}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -550684.9875123753, "episode_len_mean": 988.06, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -110136.9975024751}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.34945230582372, "mean_processing_ms": 4.407732999862882, "mean_inference_ms": 0.7789009719538856}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3205888, "num_steps_sampled": 916458, "sample_time_ms": 48854.142, "load_time_ms": 5.588, "grad_time_ms": 2247.09, "update_time_ms": 7.904, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 62064724.0, "policy_loss": -0.0005073948996141553, "vf_loss": 62064724.0, "vf_explained_var": 0.0017130229389294982, "kl": 0.0012663058005273342, "entropy": 0.542120635509491, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 916458, "episodes_total": 914, "training_iteration": 229, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-19-57", "timestamp": 1684538397, "time_this_iter_s": 50.75310397148132, "time_total_s": 11127.754197835922, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11127.754197835922, "timesteps_since_restore": 916458, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 30.606849315068494, "ram_util_percent": 17.69178082191781}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -557869.6508447739, "episode_len_mean": 988.06, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -111573.9301689548}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.31294786309584, "mean_processing_ms": 4.405968728551663, "mean_inference_ms": 0.7786134219078166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3217152, "num_steps_sampled": 920458, "sample_time_ms": 48895.553, "load_time_ms": 5.71, "grad_time_ms": 2260.396, "update_time_ms": 8.143, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 81345544.0, "policy_loss": 0.00022165545669849962, "vf_loss": 81345544.0, "vf_explained_var": 0.0014944381546229124, "kl": 8.291594713227823e-05, "entropy": 0.5468534231185913, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 920458, "episodes_total": 922, "training_iteration": 230, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-20-48", "timestamp": 1684538448, "time_this_iter_s": 51.27011585235596, "time_total_s": 11179.024313688278, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7a60>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11179.024313688278, "timesteps_since_restore": 920458, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 33.12328767123287, "ram_util_percent": 17.67945205479452}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -551644.5621574258, "episode_len_mean": 988.06, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -110328.9124314852}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.3053352481913, "mean_processing_ms": 4.405406774597953, "mean_inference_ms": 0.7785178681284174}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3231104, "num_steps_sampled": 924458, "sample_time_ms": 48867.056, "load_time_ms": 6.022, "grad_time_ms": 2291.812, "update_time_ms": 7.959, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 32142174.0, "policy_loss": 0.000521963753271848, "vf_loss": 32142174.0, "vf_explained_var": 0.006048256065696478, "kl": 6.0103677242295817e-05, "entropy": 0.552980899810791, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 924458, "episodes_total": 924, "training_iteration": 231, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-21-39", "timestamp": 1684538499, "time_this_iter_s": 50.36836791038513, "time_total_s": 11229.392681598663, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11229.392681598663, "timesteps_since_restore": 924458, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 26.544444444444444, "ram_util_percent": 17.676388888888887}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -551681.9692696454, "episode_len_mean": 988.06, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -110336.3938539291}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.3158285907841, "mean_processing_ms": 4.405740733598193, "mean_inference_ms": 0.7785715214349369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3243904, "num_steps_sampled": 928458, "sample_time_ms": 48690.236, "load_time_ms": 5.916, "grad_time_ms": 2278.512, "update_time_ms": 7.979, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 59711824.0, "policy_loss": -0.0008760832133702934, "vf_loss": 59711824.0, "vf_explained_var": 0.0027051132638007402, "kl": 0.00010623114212648943, "entropy": 0.5517951250076294, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 928458, "episodes_total": 930, "training_iteration": 232, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-22-29", "timestamp": 1684538549, "time_this_iter_s": 50.048386573791504, "time_total_s": 11279.441068172455, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11279.441068172455, "timesteps_since_restore": 928458, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 30.002816901408462, "ram_util_percent": 17.680281690140834}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -555931.1751236895, "episode_len_mean": 993.82, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -111186.23502473792}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.27388859847883, "mean_processing_ms": 4.403614933159947, "mean_inference_ms": 0.7783882252530175}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3260928, "num_steps_sampled": 932458, "sample_time_ms": 48533.068, "load_time_ms": 6.062, "grad_time_ms": 2277.159, "update_time_ms": 7.677, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 86293448.0, "policy_loss": -0.000849649659357965, "vf_loss": 86293448.0, "vf_explained_var": 0.0023603246081620455, "kl": 9.098028385778889e-05, "entropy": 0.5546573400497437, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 932458, "episodes_total": 932, "training_iteration": 233, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-23-20", "timestamp": 1684538600, "time_this_iter_s": 51.1898238658905, "time_total_s": 11330.630892038345, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11330.630892038345, "timesteps_since_restore": 932458, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 26.372602739726023, "ram_util_percent": 17.694520547945206}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -553959.145118007, "episode_len_mean": 993.82, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -110791.82902360141}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.26352158638014, "mean_processing_ms": 4.402950303722005, "mean_inference_ms": 0.7780368324447581}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3273856, "num_steps_sampled": 936458, "sample_time_ms": 48517.962, "load_time_ms": 5.689, "grad_time_ms": 2275.75, "update_time_ms": 7.422, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 97200800.0, "policy_loss": -0.0003728452429641038, "vf_loss": 97200800.0, "vf_explained_var": 0.0012047385098412633, "kl": 0.0004431120178196579, "entropy": 0.5475173592567444, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 936458, "episodes_total": 934, "training_iteration": 234, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-24-11", "timestamp": 1684538651, "time_this_iter_s": 50.68574357032776, "time_total_s": 11381.316635608673, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7a60>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11381.316635608673, "timesteps_since_restore": 936458, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 30.879452054794523, "ram_util_percent": 17.6986301369863}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1368147.1808910042, "episode_reward_mean": -559514.869118006, "episode_len_mean": 993.82, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -839193.8002581319}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -111902.97382360122}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.22339056116164, "mean_processing_ms": 4.401210160545005, "mean_inference_ms": 0.7778502580467875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3284992, "num_steps_sampled": 940458, "sample_time_ms": 48469.003, "load_time_ms": 5.955, "grad_time_ms": 2285.976, "update_time_ms": 7.086, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 105526440.0, "policy_loss": 0.0001584295678185299, "vf_loss": 105526440.0, "vf_explained_var": 0.0014165660832077265, "kl": 0.0007465440430678427, "entropy": 0.5445559620857239, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 940458, "episodes_total": 942, "training_iteration": 235, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-25-03", "timestamp": 1684538703, "time_this_iter_s": 52.60098433494568, "time_total_s": 11433.917619943619, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11433.917619943619, "timesteps_since_restore": 940458, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 32.44133333333334, "ram_util_percent": 17.688000000000002}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -165635.74129892382, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -552028.007887282, "episode_len_mean": 993.82, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -110405.60157745637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.2173312540083, "mean_processing_ms": 4.400634190870066, "mean_inference_ms": 0.7777782598542919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3298560, "num_steps_sampled": 944458, "sample_time_ms": 48614.01, "load_time_ms": 5.814, "grad_time_ms": 2277.297, "update_time_ms": 7.017, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 64378316.0, "policy_loss": -0.0008778390474617481, "vf_loss": 64378316.0, "vf_explained_var": 0.00337763549759984, "kl": 0.0002858536900021136, "entropy": 0.552339494228363, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 944458, "episodes_total": 944, "training_iteration": 236, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-25-54", "timestamp": 1684538754, "time_this_iter_s": 50.93325877189636, "time_total_s": 11484.850878715515, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11484.850878715515, "timesteps_since_restore": 944458, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 26.408333333333335, "ram_util_percent": 17.694444444444443}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -240347.59467423416, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -565769.5042329498, "episode_len_mean": 1000.0, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -113153.90084658994}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.19295720688135, "mean_processing_ms": 4.398983034023801, "mean_inference_ms": 0.777598259667523}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3311360, "num_steps_sampled": 948458, "sample_time_ms": 48428.991, "load_time_ms": 5.895, "grad_time_ms": 2275.879, "update_time_ms": 6.91, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 74221376.0, "policy_loss": -0.0004505048564169556, "vf_loss": 74221376.0, "vf_explained_var": 0.0016999911749735475, "kl": 0.0009759384556673467, "entropy": 0.5415915846824646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 948458, "episodes_total": 950, "training_iteration": 237, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-26-44", "timestamp": 1684538804, "time_this_iter_s": 49.50471067428589, "time_total_s": 11534.355589389801, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11534.355589389801, "timesteps_since_restore": 948458, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 29.911267605633807, "ram_util_percent": 17.6887323943662}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -240347.59467423416, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -571561.0466274512, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -114312.20932549023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.1902930944887, "mean_processing_ms": 4.398544385936598, "mean_inference_ms": 0.777543665641005}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3328640, "num_steps_sampled": 952458, "sample_time_ms": 48420.362, "load_time_ms": 6.006, "grad_time_ms": 2288.034, "update_time_ms": 7.127, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 94470800.0, "policy_loss": -0.000738464470487088, "vf_loss": 94470800.0, "vf_explained_var": 0.0016127096023410559, "kl": 0.004467673599720001, "entropy": 0.5415529608726501, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 952458, "episodes_total": 952, "training_iteration": 238, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-27-34", "timestamp": 1684538854, "time_this_iter_s": 50.13437557220459, "time_total_s": 11584.489964962006, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7a60>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11584.489964962006, "timesteps_since_restore": 952458, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 26.83888888888889, "ram_util_percent": 17.698611111111106}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -240347.59467423416, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -574540.8901036773, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -114908.17802073545}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.18041418296093, "mean_processing_ms": 4.397787001549832, "mean_inference_ms": 0.7774299607246337}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3341184, "num_steps_sampled": 956458, "sample_time_ms": 48593.585, "load_time_ms": 6.039, "grad_time_ms": 2279.205, "update_time_ms": 7.307, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 34483652.0, "policy_loss": -0.0016095440369099379, "vf_loss": 34483652.0, "vf_explained_var": 0.00202891300432384, "kl": 0.0028570194263011217, "entropy": 0.5074900984764099, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 956458, "episodes_total": 954, "training_iteration": 239, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-28-27", "timestamp": 1684538907, "time_this_iter_s": 52.401299238204956, "time_total_s": 11636.89126420021, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11636.89126420021, "timesteps_since_restore": 956458, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 30.258108108108107, "ram_util_percent": 17.7}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -240347.59467423416, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -571396.8538416612, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -114279.37076833223}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.14038302965054, "mean_processing_ms": 4.395890015705486, "mean_inference_ms": 0.7771365528553722}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3352576, "num_steps_sampled": 960458, "sample_time_ms": 48699.958, "load_time_ms": 5.887, "grad_time_ms": 2267.767, "update_time_ms": 6.757, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 65308668.0, "policy_loss": 0.0006770681357011199, "vf_loss": 65308668.0, "vf_explained_var": 0.001540204742923379, "kl": 0.00024142688198480755, "entropy": 0.5096428990364075, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 960458, "episodes_total": 962, "training_iteration": 240, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-29-19", "timestamp": 1684538959, "time_this_iter_s": 52.214923620224, "time_total_s": 11689.106187820435, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7400>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11689.106187820435, "timesteps_since_restore": 960458, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 32.35333333333333, "ram_util_percent": 17.692}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -571720.9457849282, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -114344.18915698564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.13467943777593, "mean_processing_ms": 4.395358176454646, "mean_inference_ms": 0.7770998905164491}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3366528, "num_steps_sampled": 964458, "sample_time_ms": 48708.801, "load_time_ms": 5.55, "grad_time_ms": 2240.683, "update_time_ms": 7.048, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 32262154.0, "policy_loss": -0.00016146802227012813, "vf_loss": 32262154.0, "vf_explained_var": 0.006058401893824339, "kl": 0.0003154707665089518, "entropy": 0.5067718625068665, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 964458, "episodes_total": 964, "training_iteration": 241, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-30-09", "timestamp": 1684539009, "time_this_iter_s": 50.18203806877136, "time_total_s": 11739.288225889206, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11739.288225889206, "timesteps_since_restore": 964458, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 26.45555555555556, "ram_util_percent": 17.695833333333333}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -563800.5243913159, "episode_len_mean": 1000.0, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -112760.10487826317}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.1119595186217, "mean_processing_ms": 4.393823305267995, "mean_inference_ms": 0.7769276618750783}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3379968, "num_steps_sampled": 968458, "sample_time_ms": 48679.917, "load_time_ms": 5.481, "grad_time_ms": 2251.361, "update_time_ms": 7.069, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 106874656.0, "policy_loss": -0.0029516571667045355, "vf_loss": 106874656.0, "vf_explained_var": 0.001625017379410565, "kl": 0.007275675423443317, "entropy": 0.5014598369598389, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 968458, "episodes_total": 970, "training_iteration": 242, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-30-59", "timestamp": 1684539059, "time_this_iter_s": 49.856744050979614, "time_total_s": 11789.144969940186, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7ae8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11789.144969940186, "timesteps_since_restore": 968458, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 30.169014084507044, "ram_util_percent": 17.69154929577465}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -562071.4763473467, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -112414.29526946931}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.10892173030177, "mean_processing_ms": 4.393398157340921, "mean_inference_ms": 0.7769117087709551}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3396992, "num_steps_sampled": 972458, "sample_time_ms": 48654.557, "load_time_ms": 5.364, "grad_time_ms": 2255.689, "update_time_ms": 7.309, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 119634976.0, "policy_loss": -0.0004916931502521038, "vf_loss": 119634976.0, "vf_explained_var": 0.0018568424275144935, "kl": 0.0012486256891861558, "entropy": 0.5222273468971252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 972458, "episodes_total": 972, "training_iteration": 243, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-31-50", "timestamp": 1684539110, "time_this_iter_s": 50.97748041152954, "time_total_s": 11840.122450351715, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11840.122450351715, "timesteps_since_restore": 972458, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 26.606944444444444, "ram_util_percent": 17.698611111111106}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1169302.9719996739, "episode_reward_mean": -562521.0889016817, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -722500.0668509258}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -112504.2177803363}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.0994855327873, "mean_processing_ms": 4.392687477792495, "mean_inference_ms": 0.7768261129683054}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3409664, "num_steps_sampled": 976458, "sample_time_ms": 48581.778, "load_time_ms": 5.546, "grad_time_ms": 2251.365, "update_time_ms": 7.319, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 80487640.0, "policy_loss": -0.00023899042571429163, "vf_loss": 80487640.0, "vf_explained_var": 0.0015415801899507642, "kl": 0.00016891909763216972, "entropy": 0.5188315510749817, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 976458, "episodes_total": 974, "training_iteration": 244, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-32-40", "timestamp": 1684539160, "time_this_iter_s": 49.92174196243286, "time_total_s": 11890.044192314148, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7268>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11890.044192314148, "timesteps_since_restore": 976458, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 30.940277777777776, "ram_util_percent": 17.69722222222222}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1229005.3580984129, "episode_reward_mean": -573348.7303280478, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -882801.1370719118}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -114669.74606560952}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.06183721109008, "mean_processing_ms": 4.390850176642536, "mean_inference_ms": 0.7765761834441194}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3420800, "num_steps_sampled": 980458, "sample_time_ms": 48417.585, "load_time_ms": 5.684, "grad_time_ms": 2247.008, "update_time_ms": 7.623, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 159104928.0, "policy_loss": -0.002359419595450163, "vf_loss": 159104928.0, "vf_explained_var": 0.0007926657563075423, "kl": 0.0042680357582867146, "entropy": 0.49875447154045105, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 980458, "episodes_total": 982, "training_iteration": 245, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-33-31", "timestamp": 1684539211, "time_this_iter_s": 50.91466188430786, "time_total_s": 11940.958854198456, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11940.958854198456, "timesteps_since_restore": 980458, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 33.475, "ram_util_percent": 17.691666666666663}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1229005.3580984129, "episode_reward_mean": -571696.1644817509, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -882801.1370719118}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -114339.23289635015}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.05596149022534, "mean_processing_ms": 4.39037135897029, "mean_inference_ms": 0.7765597737291648}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3434368, "num_steps_sampled": 984458, "sample_time_ms": 48424.338, "load_time_ms": 5.936, "grad_time_ms": 2249.226, "update_time_ms": 7.847, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 50908112.0, "policy_loss": -0.00021713208116125315, "vf_loss": 50908112.0, "vf_explained_var": 0.004521878436207771, "kl": 0.001820766250602901, "entropy": 0.5154522657394409, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 984458, "episodes_total": 984, "training_iteration": 246, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-34-22", "timestamp": 1684539262, "time_this_iter_s": 51.02597117424011, "time_total_s": 11991.984825372696, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7ae8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11991.984825372696, "timesteps_since_restore": 984458, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 26.146575342465756, "ram_util_percent": 17.7}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1229005.3580984129, "episode_reward_mean": -559432.6330610189, "episode_len_mean": 1000.0, "episodes_this_iter": 6, "policy_reward_min": {"avProbe": -882801.1370719118}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -111886.52661220371}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.03343471688376, "mean_processing_ms": 4.388846103980578, "mean_inference_ms": 0.7763926124797537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3447552, "num_steps_sampled": 988458, "sample_time_ms": 48550.137, "load_time_ms": 5.914, "grad_time_ms": 2259.059, "update_time_ms": 7.809, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 51054260.0, "policy_loss": 0.0004127671418245882, "vf_loss": 51054260.0, "vf_explained_var": 0.003167126327753067, "kl": 0.001309073530137539, "entropy": 0.5365968942642212, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 988458, "episodes_total": 990, "training_iteration": 247, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-35-13", "timestamp": 1684539313, "time_this_iter_s": 50.85661339759827, "time_total_s": 12042.841438770294, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7730>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12042.841438770294, "timesteps_since_restore": 988458, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 29.382191780821927, "ram_util_percent": 17.69178082191781}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1229005.3580984129, "episode_reward_mean": -558990.5201107089, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -882801.1370719118}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -111798.10402214172}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.02940411035752, "mean_processing_ms": 4.3884323876874065, "mean_inference_ms": 0.7764005217616398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3465088, "num_steps_sampled": 992458, "sample_time_ms": 48544.907, "load_time_ms": 6.037, "grad_time_ms": 2274.751, "update_time_ms": 7.811, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 89367728.0, "policy_loss": -0.0011900441022589803, "vf_loss": 89367728.0, "vf_explained_var": 0.0022990182042121887, "kl": 0.004658530931919813, "entropy": 0.5408742427825928, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 992458, "episodes_total": 992, "training_iteration": 248, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-36-03", "timestamp": 1684539363, "time_this_iter_s": 50.2355375289917, "time_total_s": 12093.076976299286, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af79d8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12093.076976299286, "timesteps_since_restore": 992458, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 27.026760563380286, "ram_util_percent": 17.700000000000003}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1229005.3580984129, "episode_reward_mean": -556196.9504290539, "episode_len_mean": 1000.0, "episodes_this_iter": 2, "policy_reward_min": {"avProbe": -882801.1370719118}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -111239.39008581071}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 161.02097844869576, "mean_processing_ms": 4.38779941891076, "mean_inference_ms": 0.7763519525840142}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3477632, "num_steps_sampled": 996458, "sample_time_ms": 48424.569, "load_time_ms": 6.057, "grad_time_ms": 2288.459, "update_time_ms": 7.862, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 47816752.0, "policy_loss": -0.000681630801409483, "vf_loss": 47816752.0, "vf_explained_var": 0.002765725366771221, "kl": 0.0005156891420483589, "entropy": 0.5165303349494934, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 996458, "episodes_total": 994, "training_iteration": 249, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-36-54", "timestamp": 1684539414, "time_this_iter_s": 51.33454632759094, "time_total_s": 12144.411522626877, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af76a8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12144.411522626877, "timesteps_since_restore": 996458, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 30.36351351351352, "ram_util_percent": 17.7}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
{"episode_reward_max": -235964.4274474438, "episode_reward_min": -1229005.3580984129, "episode_reward_mean": -562535.7071971946, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {"avProbe": -882801.1370719118}, "policy_reward_max": {"avProbe": 19683.605756862686}, "policy_reward_mean": {"avProbe": -112507.14143943886}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 160.9840979015037, "mean_processing_ms": 4.3860057382035675, "mean_inference_ms": 0.7760636496046825}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3488640, "num_steps_sampled": 1000458, "sample_time_ms": 48268.127, "load_time_ms": 6.187, "grad_time_ms": 2306.005, "update_time_ms": 8.228, "learner": {"avProbe": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 59173536.0, "policy_loss": -0.0009439230780117214, "vf_loss": 59173536.0, "vf_explained_var": 0.0020673975814133883, "kl": 0.00016913899162318558, "entropy": 0.5062103867530823, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": true, "timesteps_total": 1000458, "episodes_total": 1002, "training_iteration": 250, "experiment_id": "2dcd34d4f71a4f9a8717755113320812", "date": "2023-05-19_19-37-45", "timestamp": 1684539465, "time_this_iter_s": 50.8240122795105, "time_total_s": 12195.235534906387, "pid": 4122, "hostname": "HR1", "node_ip": "10.49.0.104", "config": {"num_workers": 20, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 9.8,\n            \"max_decel\": 9.8,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 75\n    },\n    \"env_name\": \"vmsfinal_env_MARL_FA.MultiAgentHighwayPOEnv\",\n    \"exp_tag\": \"template_ZM\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": {\n            \"net\": \"/home/vms_public/VMS_SUMO/flow/CAV_NewSpeed.net.xml\",\n            \"rou\": \"/home/vms_public/VMS_SUMO/flow/flow.xml\",\n            \"vtype\": \"/home/vms_public/VMS_SUMO/flow/vtype.xml\"\n        }\n    },\n    \"network\": \"flow.networks.base.Network\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1.0,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"avProbe\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentHighwayPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"avProbe": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(5,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.policy_mapping_fn at 0x7ff351af7ae8>", "policies_to_train": ["avProbe"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12195.235534906387, "timesteps_since_restore": 1000458, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 33.50277777777777, "ram_util_percent": 17.694444444444443}, "num_healthy_workers": 20, "trial_id": "b815bb28", "experiment_tag": "0"}
